---
id: ee5c5db9-291c-4b3a-8a3f-16c999681afe
name: Exploitation of Remote Services
type: technique
mitre_id: T1210
mitre_url: null
created_at: '2019-08-28T21:17:40.218213+00:00'
updated_at: '2023-05-29T16:48:53.672970+00:00'
tactics:
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
procedures:
- '[[Account Takeover via Password Reset Feature and IDOR on API Parameters]]'
- '[[Active Directory Integrated DNS Enumeration]]'
- '[[AWS Fargate Container Credentials Theft]]'
- '[[AWS Lambda Function Invocation for Privilege Escalation]]'
- '[[AWS Metadata Credential Theft]]'
- '[[Bypassing filters with IPv6 Server Ports]]'
- '[[Cassandra Login Bypass via SQL Injection]]'
- '[[Custom Metadata PHP Injection]]'
- '[[DB2 Configuration Parameters Retrieval]]'
- '[[DB2 Current Database Selection]]'
- '[[DB2 Enumeration]]'
- '[[DB2 Injection - ASCII Concatenation]]'
- '[[DB2 Injection - ASCII Value Extraction]]'
- '[[DB2 Injection - Bitwise AND Operation]]'
- '[[DB2 Injection - Char to ASCII Conversion]]'
- '[[DB2 Injection - Find Tables From Column Name]]'
- '[[DB2 Injection - List Tables]]'
- '[[DB2 Injection: Retrieval of DB2PATH]]'
- '[[DB2 Injection with Comment Filtering]]'
- '[[DB2 Integer Conversion Injection]]'
- '[[DB2 List DBA Accounts Procedure]]'
- '[[DB2 Version Information Extraction]]'
- '[[DBMS Identification via SQL Injection Commands]]'
- '[[DBMS Magic Functions Injection]]'
- '[[DCOM DCE RPC Relay using RemotePotato0]]'
- '[[DNS Rebinding Protection Bypass via CNAME]]'
- '[[DNS Rebinding Server-Side Request Forgery]]'
- '[[Drop the MIC Relay Attack]]'
- '[[Exploit a Backdoor in UnrealIRCd 3.2.8]]'
- '[[Exploiting IIS Machine Keys to Generate ViewState for RCE]]'
- '[[Exploiting IIS Machine Keys to Generate ViewState for RCE]]'
- '[[Exploiting IIS Machine Keys to Generate ViewState for RCE]]'
- '[[Exploiting PrintNightmare to gain SYSTEM shell on DC]]'
- '[[Exploiting PrintNightmare to gain SYSTEM shell on Domain Controller]]'
- '[[Google BigQuery Error-Based SQL Injection]]'
- '[[Google BigQuery SQL Injection with Comment Syntax]]'
- '[[Gopher Proxy SSRF Exploitation]]'
- '[[Gopher Server-Side Request Forgery via SMTP Spoofing Attack]]'
- '[[GraphQL Injection for NOSQL Exploitation]]'
- '[[Hibernate Query Language Injection - Percentage Input Warning]]'
- '[[Hibernate Query Language Injection - Single Quote Escaping]]'
- '[[Hibernate Query Language Injection (Unicode)]]'
- '[[HTML POST CSRF Attack]]'
- '[[HTML POST CSRF Attack]]'
- '[[IPv6/IPv4 Address Embedding SSRF]]'
- '[[Java Jar Protocol SSRF Bypass]]'
- '[[Java RMI Exploitation for Remote Command Execution using sjet or mjet]]'
- '[[Jinja2 Server Side Template Injection - Dump All Used Classes]]'
- '[[LDAP Field Discovery]]'
- '[[LFI to RCE via /proc/self/environ]]'
- '[[Linked Database Table Enumeration]]'
- '[[Linux - Predictable PRNG SSH Key Privilege Escalation]]'
- '[[Linux RDS Privilege Escalation]]'
- '[[Linux - SSH Key Predictable PRNG Privilege Escalation]]'
- '[[Log4Shell Environment Variables Exfiltration]]'
- '[[Log4Shell Environment Variables Exfiltration]]'
- '[[Log4Shell Environment Variables Exfiltration]]'
- '[[Log4Shell Scanning Procedure]]'
- '[[Log4Shell Scanning Procedure]]'
- '[[Log4Shell Scanning Procedure]]'
- '[[MSSQL Credential Theft]]'
- '[[MSSQL Error Based Injection using Convert SQL Server Version to Integer]]'
- '[[MSSQL Hostname Enumeration]]'
- '[[MSSQL Injection to Grant DBA Access]]'
- '[[MSSQL Stacked Query Injection Prevention]]'
- '[[MSSQL Trusted Links Exploitation]]'
- '[[MSSQL User Information Retrieval]]'
- '[[MYSQL Error Based - Extractvalue function with Blind SQL Injection]]'
- '[[MYSQL Error Based - NAME_CONST Function Injection]]'
- '[[MYSQL Injection - Column Detection via Order By or Group By Attack]]'
- '[[MYSQL Injection - Current Queries]]'
- '[[MYSQL Injection Exploitation]]'
- '[[MYSQL Injection via Error Based - Basic with Select Command]]'
- '[[MYSQL Injection with Blind MAKE_SET]]'
- '[[MYSQL Out of Band UNC Path Hash Stealing]]'
- '[[MYSQL Union Based Column Enumeration]]'
- '[[MYSQL Union-Based Injection to Extract Column Names]]'
- '[[.NET Serialization Tools Exploitation]]'
- '[[NoSQL Injection Authentication Bypass using Not Equal or Greater]]'
- '[[Oracle SQL Column Enumeration]]'
- '[[Oracle SQL Injection Time-Based Attack]]'
- '[[Oracle SQL Injection - User and Version Information Retrieval]]'
- '[[PHP Deserialization - Code Execution]]'
- '[[PHP Filter LFI/RFI]]'
- '[[PHP Juggling Type and Magic Hashes - True Statement Comparison]]'
- '[[PHP Magic Hashes Juggling Attack]]'
- '[[Polyglot Injection Sleep Command Procedure]]'
- '[[PostgreSQL Blind SQL Injection]]'
- '[[PostgreSQL Chain Injection Points Symbols - SQL Command Termination]]'
- '[[PostgreSQL Command Execution via Injection]]'
- '[[PostgreSQL Database Name Enumeration]]'
- '[[PostgreSQL Error Based Injection for Database and Table Information Retrieval]]'
- '[[PostgreSQL List Tables Injection]]'
- '[[PostgreSQL Password Hash Retrieval]]'
- '[[PostgreSQL Privilege Escalation]]'
- '[[PostgreSQL Superuser Privileges Check]]'
- '[[PostgreSQL Time Based Injection for Database Dump]]'
- '[[PostgreSQL User Enumeration]]'
- '[[PostgreSQL Version Retrieval via Injection]]'
- '[[Predictable PRNG SSH Key Escalation]]'
---

# Exploitation of Remote Services

**MITRE ID**: T1210

## Description

Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system.An adversary may need to determine if the remote system is in a vulnerable state, which may be done through Network Service Scanning or other Discovery methods looking for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities,  or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources.There are several well-known vulnerabilities that exist in common services such as SMB [1] and RDP [2] as well as applications that may be used within internal networks such as MySQL [3] and web server services. [4]Depending on the permissions level of the vulnerable remote service an adversary may achieve Exploitation for Privilege Escalation as a result of lateral movement exploitation as well.

# Detection

Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the processes. This could include suspicious files written to disk, evidence of Process Injection for attempts to hide execution, evidence of Discovery, or other unusual network traffic that may indicate additional tools transferred to the system.

# Mitigation

Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods. Minimize available services to only those that are necessary. Regularly scan the internal network for available services to identify new and potentially vulnerable services. Minimize permissions and access for service accounts to limit impact of exploitation.

Update software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of exploitation. The risks of additional exploits and weaknesses in implementation may still exist. [20]

Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. [21] Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. [22] Many of these protections depend on the architecture and target application binary for compatibility and may not work for all software or services targeted.

# Footnotes

[1] CIS. (2017, May 15). Multiple Vulnerabilities in Microsoft Windows SMB Server Could Allow for Remote Code Execution. Retrieved April 3, 2018.

[2] National Vulnerability Database. (2017, June 22). CVE-2017-0176 Detail. Retrieved April 3, 2018.

[3] National Vulnerability Database. (2017, February 2). CVE-2016-6662 Detail. Retrieved April 3, 2018.

[4] National Vulnerability Database. (2017, September 24). CVE-2014-7169 Detail. Retrieved April 3, 2018.

[5] FireEye. (2015). APT28: A WINDOW INTO RUSSIA’S CYBER ESPIONAGE OPERATIONS?. Retrieved August 19, 2015.

[6] Smith, L. and Read, B.. (2017, August 11). APT28 Targets Hospitality Sector, Presents Threat to Travelers. Retrieved August 17, 2017.

[7] Microsoft. (2017, March 14). Microsoft Security Bulletin MS17-010 - Critical. Retrieved August 17, 2017.

[8] US-CERT. (2018, July 20). Alert (TA18-201A) Emotet Malware. Retrieved March 25, 2019.

[9] Mclellan, M.. (2018, November 19). Lazy Passwords Become Rocket Fuel for Emotet SMB Spreader. Retrieved March 25, 2019.

[10] Donohue, B.. (2019, February 13). https://redcanary.com/blog/stopping-emotet-before-it-moves-laterally/. Retrieved March 25, 2019.

[11] Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.

[12] Gostev, A. (2012, May 28). The Flame: Questions and Answers. Retrieved March 1, 2017.

[13] Gostev, A. (2012, May 30). Flame: Bunny, Frog, Munch and BeetleJuice…. Retrieved March 1, 2017.

[14] Chiu, A. (2016, June 27). New Ransomware Variant "Nyetya" Compromises Systems Worldwide. Retrieved March 26, 2019.

[15] US-CERT. (2017, July 1). Alert (TA17-181A): Petya Ransomware. Retrieved March 15, 2019.

[16] Nettitude. (2016, June 8). PoshC2: Powershell C2 Server and Implants. Retrieved April 23, 2019.

[17] Noerenberg, E., Costis, A., and Quist, N. (2017, May 16). A Technical Analysis of WannaCry Ransomware. Retrieved March 25, 2019.

[18] Berry, A., Homan, J., and Eitzman, R. (2017, May 23). WannaCry Malware Profile. Retrieved March 15, 2019.

[19] US-CERT. (2017, May 12). Alert (TA17-132A): Indicators Associated With WannaCry Ransomware. Retrieved March 25, 2019.

[20] Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.

[21] Nunez, N. (2017, August 9). Moving Beyond EMET II – Windows Defender Exploit Guard. Retrieved March 12, 2018.

[22] Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.

## Defense

Segment networks and systems appropriately to reduce access to critical systems and services to controlled methods. Minimize available services to only those that are necessary. Regularly scan the internal network for available services to identify new an

## Tactics

- [[Lateral Movement|TA0008 - Lateral Movement]]

## Related Procedures (100)

- [[Account Takeover via Password Reset Feature and IDOR on API Parameters]]
- [[Active Directory Integrated DNS Enumeration]]
- [[AWS Fargate Container Credentials Theft]]
- [[AWS Lambda Function Invocation for Privilege Escalation]]
- [[AWS Metadata Credential Theft]]
- [[Bypassing filters with IPv6 Server Ports]]
- [[Cassandra Login Bypass via SQL Injection]]
- [[Custom Metadata PHP Injection]]
- [[DB2 Configuration Parameters Retrieval]]
- [[DB2 Current Database Selection]]
- [[DB2 Enumeration]]
- [[DB2 Injection - ASCII Concatenation]]
- [[DB2 Injection - ASCII Value Extraction]]
- [[DB2 Injection - Bitwise AND Operation]]
- [[DB2 Injection - Char to ASCII Conversion]]
- [[DB2 Injection - Find Tables From Column Name]]
- [[DB2 Injection - List Tables]]
- [[DB2 Injection: Retrieval of DB2PATH]]
- [[DB2 Injection with Comment Filtering]]
- [[DB2 Integer Conversion Injection]]

*...and 80 more*
