---
id: c7e9f5e5-7732-4b50-8fac-e6d270fd930c
name: Exploitation for Privilege Escalation
type: technique
mitre_id: T1068
mitre_url: null
created_at: '2019-08-28T21:17:23.917324+00:00'
updated_at: '2023-05-29T16:48:53.672970+00:00'
tactics:
- '[[Privilege Escalation|TA0004 - Privilege Escalation]]'
procedures:
- '[[Abusing Golden Privileges with Juicy Potato]]'
- '[[AWS Lambda Function Invocation for Privilege Escalation]]'
- '[[Azure SSRF for VM Metadata Service]]'
- '[[CORS Misconfiguration Exploitation - Expanding the Origin / Regex Issues]]'
- '[[CORS Misconfiguration Exploitation - Expanding the Origin / Regex Issues]]'
- '[[CORS Misconfiguration Exploitation - Expanding the Origin / Regex Issues]]'
- '[[CORS Misconfiguration Exploitation - Expanding the Origin / Regex Issues]]'
- '[[DC PrintSpooler Service Check and ntlmrelayx with printerbug.py]]'
- '[[DirtyPipe Kernel Exploit Privilege Escalation]]'
- '[[Eternal Blue Exploitation]]'
- '[[Exploiting PrintNightmare to gain SYSTEM shell on DC]]'
- '[[Exploit the ClientCopyImage Vulnerability (MS15-051)]]'
- '[[Exploit the Dirty Cow Vulnerability]]'
- '[[Kernel Exploitation - Useradd.exe Compilation]]'
- '[[KiTrap0D Privilege Escalation]]'
- '[[LFI to RCE via SSH Log File Inclusion]]'
- '[[Linux Kernel Exploit - CVE-2010-4258 (Full Nelson)]]'
- '[[Linux Privilege Escalation via NFS Root Squashing]]'
- '[[Linux - SSH Key Predictable PRNG Privilege Escalation]]'
- '[[Linux - SUDO Privilege Escalation via CVE-2019-14287]]'
- '[[MS08-067 NetAPI Privilege Escalation]]'
- '[[MS11-080 AFD JoinLeaf Privilege Escalation]]'
- '[[MS15-051 Privilege Escalation via Client Copy Image]]'
- '[[MS16-032 Local Privilege Escalation]]'
- '[[MSSQL Trusted Links Exploitation]]'
- '[[MYSQL UDF Command Execution via lib_mysqludf_sys.so]]'
- '[[PostgreSQL Command Execution via Injection]]'
- '[[PrintNightmare - Exploiting CVE to gain SYSTEM shell on DC via Anonymous SMB
  Server]]'
- '[[Read LAPS password from domain (credentials)]]'
- '[[Rogue Potato Impersonation Privileges]]'
- '[[SQL Server Impersonation Privilege Escalation]]'
- '[[UsoSvc Service Account Remote Command Execution]]'
- '[[Windows Elevation of Privilege - Looting WiFi Passwords]]'
- '[[Windows Privilege Escalation - EoP Looting for Passwords using PowerShell Transcript]]'
- '[[Windows Privilege Escalation - Looting LAPS Settings]]'
- '[[Windows Privilege Escalation using PowerUp, PrivescCheck, and WES-NG]]'
- '[[Windows Privilege Escalation via Runas]]'
- '[[Windows Subsystem for Linux (WSL) Privilege Escalation]]'
- '[[Windows XP SP1 - UPnP Host Exploit]]'
- '[[ZeroLogon Exploitation and Post-Exploitation]]'
---

# Exploitation for Privilege Escalation

**MITRE ID**: T1068

## Description

Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. Security constructs such as permission levels will often hinder access to information and use of certain techniques, so adversaries will likely need to perform Privilege Escalation to include use of software exploitation to circumvent those restrictions.When initially gaining access to a system, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and software commonly running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user level permissions to SYSTEM or root permissions depending on the component that is vulnerable. This may be a necessary step for an adversary compromising a endpoint system that has been properly configured and limits other privilege escalation methods.

# Detection

Detecting software exploitation may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash. Also look for behavior on the endpoint system that might indicate successful compromise, such as abnormal behavior of the processes. This could include suspicious files written to disk, evidence of Process Injection for attempts to hide execution or evidence of Discovery.

Higher privileges are often necessary to perform additional actions such as some methods of Credential Dumping. Look for additional activity that may indicate an adversary has gained higher privileges.

# Mitigation

Update software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization. Make it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing, if available. Other types of virtualization and application microsegmentation may also mitigate the impact of some types of client-side exploitation. The risks of additional exploits and weaknesses in implementation may still exist. [19]

Security applications that look for behavior used during exploitation such as Windows Defender Exploit Guard (WDEG) and the Enhanced Mitigation Experience Toolkit (EMET) can be used to mitigate some exploitation behavior. [20] Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring. [21] Many of these protections depend on the architecture and target application binary for compatibility and may not work for software components targeted for privilege escalation.

# Footnotes

[1] Bitdefender. (2015, December). APT28 Under the Scope. Retrieved February 23, 2017.

[2] Anthe, C. et al. (2015, October 19). Microsoft Security Intelligence Report Volume 19. Retrieved December 23, 2015.

[3] Kaspersky Lab's Global Research & Analysis Team. (2018, February 20). A Slice of 2017 Sofacy Activity. Retrieved November 27, 2018.

[4] Carr, N.. (2017, May 14). Cyber Espionage is Alive and Well: APT32 and the Threat to Global Corporations. Retrieved June 18, 2017.

[5] Ackerman, G., et al. (2018, December 21). OVERRULED: Containing a Potentially Destructive Adversary. Retrieved January 17, 2019.

[6] Matveeva, V. (2017, August 15). Secrets of Cobalt. Retrieved October 10, 2018.

[7] Cobalt Strike. (2017, December 8). Tactics, Techniques, and Procedures. Retrieved December 20, 2017.

[8] F-Secure Labs. (2015, September 17). The Dukes: 7 years of Russian cyberespionage. Retrieved December 10, 2015.

[9] Schroeder, W., Warner, J., Nelson, M. (n.d.). Github PowerShellEmpire. Retrieved April 28, 2016.

[10] FireEye Threat Intelligence. (2016, April). Follow the Money: Dissecting the Operations of the Cyber Crime Group FIN6. Retrieved June 1, 2016.

[11] Kizhakkinan, D. et al.. (2016, May 11). Threat Actor Leverages Windows Zero-day Exploit in Payment Card Data Attacks. Retrieved February 12, 2018.

[12] Elovitz, S. & Ahl, I. (2016, August 18). Know Your Enemy:  New Financially-Motivated & Spear-Phishing Group. Retrieved February 26, 2018.

[13] ESET. (2016, October). En Route with Sednit - Part 1: Approaching the Target. Retrieved November 8, 2016.

[14] ESET Research. (2015, July 10). Sednit APT Group Meets Hacking Team. Retrieved March 1, 2017.

[15] Nettitude. (2016, June 8). PoshC2: Powershell C2 Server and Implants. Retrieved April 23, 2019.

[16] Kaspersky Lab's Global Research & Analysis Team. (2016, August 9). The ProjectSauron APT. Technical Analysis. Retrieved August 17, 2016.

[17] Counter Threat Unit Research Team. (2017, June 27). BRONZE UNION Cyberespionage Persists Despite Disclosures. Retrieved July 13, 2017.

[18] Anthe, C. et al. (2016, December 14). Microsoft Security Intelligence Report Volume 21. Retrieved November 27, 2017.

[19] Goodin, D. (2017, March 17). Virtual machine escape fetches $105,000 at Pwn2Own hacking contest - updated. Retrieved March 12, 2018.

[20] Nunez, N. (2017, August 9). Moving Beyond EMET II â€“ Windows Defender Exploit Guard. Retrieved March 12, 2018.

[21] Wikipedia. (2018, January 11). Control-flow integrity. Retrieved March 12, 2018.

## Defense

Update software regularly by employing patch management for internal enterprise endpoints and servers. Develop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a partic

## Tactics

- [[Privilege Escalation|TA0004 - Privilege Escalation]]

## Related Procedures (40)

- [[Abusing Golden Privileges with Juicy Potato]]
- [[AWS Lambda Function Invocation for Privilege Escalation]]
- [[Azure SSRF for VM Metadata Service]]
- [[CORS Misconfiguration Exploitation - Expanding the Origin / Regex Issues]]
- [[CORS Misconfiguration Exploitation - Expanding the Origin / Regex Issues]]
- [[CORS Misconfiguration Exploitation - Expanding the Origin / Regex Issues]]
- [[CORS Misconfiguration Exploitation - Expanding the Origin / Regex Issues]]
- [[DC PrintSpooler Service Check and ntlmrelayx with printerbug.py]]
- [[DirtyPipe Kernel Exploit Privilege Escalation]]
- [[Eternal Blue Exploitation]]
- [[Exploiting PrintNightmare to gain SYSTEM shell on DC]]
- [[Exploit the ClientCopyImage Vulnerability (MS15-051)]]
- [[Exploit the Dirty Cow Vulnerability]]
- [[Kernel Exploitation - Useradd.exe Compilation]]
- [[KiTrap0D Privilege Escalation]]
- [[LFI to RCE via SSH Log File Inclusion]]
- [[Linux Kernel Exploit - CVE-2010-4258 (Full Nelson)]]
- [[Linux Privilege Escalation via NFS Root Squashing]]
- [[Linux - SSH Key Predictable PRNG Privilege Escalation]]
- [[Linux - SUDO Privilege Escalation via CVE-2019-14287]]

*...and 20 more*
