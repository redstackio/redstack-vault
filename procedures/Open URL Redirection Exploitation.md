---
id: 7913e72a-9c61-4aab-9d35-dcfdc8a14427
name: Open URL Redirection Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:31.712151+00:00'
updated_at: '2023-04-10T20:23:06.609313+00:00'
tactics:
- '[[Command and Control|TA0011 - Command and Control]]'
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Phishing|T1566 - Phishing]]'
- '[[Web Service|T1102 - Web Service]]'
sub_techniques:
- '[[Spearphishing Attachment|T1566.001 - Spearphishing Attachment]]'
tags:
- '[[Exploitation]]'
- '[[Open URL Redirection]]'
commands:
- '[[Access Signup Page]]'
- '[[Add Redirect URL]]'
- '[[Directory Brute Force]]'
- '[[Enter Credentials]]'
- '[[Fill in Signup Form]]'
- '[[Get IP Address]]'
- '[[Ping Evil Website]]'
- '[[Port Scan]]'
- '[[Redirect URL]]'
- '[[Scan for Vulnerabilities]]'
- '[[Submit Signup Form]]'
- '[[Web Server Enumeration]]'
---

# Open URL Redirection Exploitation

## Summary

Open URL redirection is a vulnerability that allows an attacker to redirect a user to a malicious website by manipulating the URL. This technique is commonly used in phishing attacks. In order to exploit this vulnerability, an attacker will first identify a website that has an open URL redirection 

## Description

# Description

Open URL redirection is a vulnerability that allows an attacker to redirect a user to a malicious website by manipulating the URL. This technique is commonly used in phishing attacks. In order to exploit this vulnerability, an attacker will first identify a website that has an open URL redirection flaw. They will then craft a URL that redirects the user to a malicious website. The attacker will then trick the victim into clicking on the URL, either by sending them a phishing email or by posting the URL on a website or social media platform.

From a technical perspective, open URL redirection is caused by the lack of input validation on the part of the website developer. When a user clicks on a link that contains a redirect parameter, the website blindly redirects the user to the specified URL. An attacker can take advantage of this by crafting a URL that redirects the user to a malicious website.

The business value of this attack lies in the fact that it can be used to steal sensitive information from the victim, such as login credentials or credit card information. It can also be used to deliver malware to the victim's computer.

## Requirements

1. Access to a website with an open URL redirection flaw

1. Crafting a URL that redirects the user to a malicious website

1. Tricking the victim into clicking on the URL

## Defense

1. Validate all user input before using it in a redirect

1. Use a whitelist of allowed redirect URLs

1. Monitor web traffic for suspicious activity, such as a large number of redirects to a single domain

## Objectives

1. Redirect users to a malicious website

1. Steal sensitive information from the victim

1. Deliver malware to the victim's computer

# Instructions

1. list

**Code**: [[well known]]

> This command is used to display a list of well-known data. The list can be used as a reference for commonly used data or as a starting point for further research.

2. Use this command to redirect users to the signup page of the famous-website.tld and then redirect them to their account page after signup.

**Code**: [[https://famous-website.tld/signup?redirectUrl=http]]

> The command takes a single argument 'redirectUrl' which is the URL of the account page where the user should be redirected after successful signup. The 'redirectUrl' argument should be URL encoded before passing it to the command. This command is useful when you want to provide a seamless experience to the user by redirecting them to the account page after successful signup.

3. To specify the redirection URL after signing up, use the 'redirectUrl' parameter in the sign-up API call.

**Code**: [[redirectUrl]]

> When a user signs up, they are redirected to a default URL. However, if you want to specify a custom URL, you can use the 'redirectUrl' parameter in the sign-up API call. This parameter takes a string value that represents the URL to which the user should be redirected after signing up.

**Command** ([[Redirect URL]]):

```bash
redirectUrl
```

4. To change the account URL, follow these steps:
1. Log in to your account
2. Go to the 'Settings' or 'Account' section
3. Look for the 'Account URL' or 'Username' field
4. Enter the new desired URL or username
5. Save the changes

**Code**: [[famous-website.tld/account]]

> The account URL is the unique identifier for your account on the website. Changing it will affect the URL of your profile, any links to your account, and how others can search for you on the website. It is important to choose a URL that is easy to remember and represents you or your brand accurately.

**Command** ([[Enter Credentials]]):

```bash
username: myusername, password: mypassword
```

5. whois evil-website.tld

**Code**: [[evil-website.tld]]

> This command will perform a WHOIS lookup on the provided domain name 'evil-website.tld' and return information about the domain name registrar, domain name status, creation date, expiration date, and other domain name details. This information can be used to identify suspicious domains and potential threat actors.

**Command** ([[Port Scan]]):

```bash
nmap -p- evil-website.tld
```

**Command** ([[Web Server Enumeration]]):

```bash
nmap -sV -p80,443 evil-website.tld
```

**Command** ([[Directory Brute Force]]):

```bash
gobuster dir -u http://evil-website.tld -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html
```

6. To prevent being redirected to the evil website, use the following command:

**Code**: [[https://famous-website.tld/signup?redirectUrl=http]]

> Add the following line to your hosts file to block access to the evil website:
127.0.0.1 evil-website.tld
This will redirect any requests to the evil website to your local machine, effectively blocking access to it.

**Command** ([[Access Signup Page]]):

```bash
https://famous-website.tld/signup
```

**Command** ([[Fill in Signup Form]]):

```bash
{username: 'myusername', password: 'mypassword', email: 'myemail@example.com'}
```

**Command** ([[Add Redirect URL]]):

```bash
{redirectUrl: 'https://evil-website.tld/account'}
```

**Command** ([[Submit Signup Form]]):

```bash
click submit button
```

7. Use a web browser to visit the provided URL and observe if there are any redirections happening. If there are redirections, take note of the final URL that the page lands on.

**Code**: [[evil-website.tld]]

> This command helps in detecting website redirections. It is useful to identify if a website is redirecting users to malicious pages or phishing sites. By visiting the provided URL and observing any redirections, we can determine if the website is safe or not. If there are redirections, we can note down the final URL that the page lands on, as it may contain valuable information for further investigation.

**Command** ([[Ping Evil Website]]):

```bash
ping evil-website.tld
```

**Command** ([[Get IP Address]]):

```bash
nslookup evil-website.tld
```

**Command** ([[Scan for Vulnerabilities]]):

```bash
nmap -sS -A evil-website.tld
```

## MITRE ATT&CK Mapping

### Tactics

- [[Command and Control|TA0011 - Command and Control]]
- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Phishing|T1566 - Phishing]]
- [[Web Service|T1102 - Web Service]]

### Sub-Techniques

- [[Spearphishing Attachment|T1566.001 - Spearphishing Attachment]]

## Commands Used

- [[Access Signup Page]]
- [[Add Redirect URL]]
- [[Directory Brute Force]]
- [[Enter Credentials]]
- [[Fill in Signup Form]]
- [[Get IP Address]]
- [[Ping Evil Website]]
- [[Port Scan]]
- [[Redirect URL]]
- [[Scan for Vulnerabilities]]
- [[Submit Signup Form]]
- [[Web Server Enumeration]]

## Tags

- [[Exploitation]]
- [[Open URL Redirection]]
