---
id: 0b8c9a57-fa3f-4427-a74b-3f6d4e878ab5
name: LDAP Injection Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:01.582052+00:00'
updated_at: '2023-04-10T20:36:29.063348+00:00'
tags:
- '[[Exploitation]]'
- '[[LDAP Injection]]'
---

# LDAP Injection Exploitation

## Summary

LDAP Injection is a type of injection attack that targets web applications that use LDAP for authentication and authorization. This attack can be used to bypass authentication, escalate privileges, and gain unauthorized access to sensitive data. The attack works by injecting malicious LDAP statemen

## Description

# Description

LDAP Injection is a type of injection attack that targets web applications that use LDAP for authentication and authorization. This attack can be used to bypass authentication, escalate privileges, and gain unauthorized access to sensitive data. The attack works by injecting malicious LDAP statements into user input fields, which are then executed by the LDAP server. The attacker can then use these statements to modify the LDAP query and retrieve sensitive information. The business value of this attack is that it can be used to gain unauthorized access to sensitive information, which can then be used for financial gain or to damage the reputation of the targeted organization.

 

## Requirements

1. Access to a web application that uses LDAP for authentication and authorization.

1. Knowledge of the target system's LDAP schema.

 

## Defense

1. Input validation and sanitization should be implemented to prevent malicious input from being processed by the application.

1. LDAP queries should be executed with the least privilege necessary to perform the required operation.

1. LDAP servers should be configured to log all LDAP queries for auditing and analysis purposes.

 

## Objectives

1. To bypass authentication and gain unauthorized access to sensitive data.

1. To escalate privileges and gain administrative access to the target system.

 

# Instructions

1. This command injects a malicious LDAP statement that retrieves all user IDs and passwords from the target system.

 



**Code**: [[user  = *)(uid=*))(|(uid=*
pass  = password
query ]]



> The user input field is injected with the value *)(uid=*))(|(uid=*, which modifies the LDAP query to retrieve all user IDs. The query is then modified again to retrieve all user passwords that are stored as MD5 hashes.

2. This command injects a malicious LDAP statement that bypasses authentication and grants administrative access to the target system.

 



**Code**: [[user  = admin)(!(&(1=0
pass  = q))
query = (&(uid=]]



> The user input field is injected with the value admin)(!(&(1=0, which modifies the LDAP query to bypass authentication. The query is then modified again to grant administrative access to the target system.

## Tags

- [[Exploitation]]
- [[LDAP Injection]]


