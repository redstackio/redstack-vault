---
id: e7282ff5-3582-493c-b10f-c205d32be897
name: CORS Misconfiguration Exploitation with Proof of Concept
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:55.971816+00:00'
updated_at: '2023-04-10T20:21:23.321029+00:00'
tags:
- '[[CORS Misconfiguration]]'
- '[[Exploitation]]'
- '[[Proof of concept (Example 2)]]'
- '[[Vulnerable Example: Expanding the Origin / Regex Issues]]'
commands:
- '[[Access API]]'
---

# CORS Misconfiguration Exploitation with Proof of Concept

## Summary

CORS (Cross-Origin Resource Sharing) is a security feature implemented by web browsers to restrict web page resources from being accessed by other domains. CORS Misconfiguration allows an attacker to bypass these restrictions and access resources that they should not be able to access. This can lea

## Description

# Description

CORS (Cross-Origin Resource Sharing) is a security feature implemented by web browsers to restrict web page resources from being accessed by other domains. CORS Misconfiguration allows an attacker to bypass these restrictions and access resources that they should not be able to access. This can lead to various attacks such as data theft, session hijacking, and credential theft. In this example, we will demonstrate how an attacker can exploit the CORS Misconfiguration vulnerability using a Proof of Concept (PoC). The PoC requires the respective JS script to be hosted at apiiexample.com. The attacker can then use XMLHttpRequest to send a request to the vulnerable endpoint and retrieve sensitive data. 

## Requirements

1. Access to the vulnerable endpoint

1. The respective JS script to be hosted at apiiexample.com

## Defense

1. Implement proper CORS configuration to restrict access to web page resources from other domains

1. Regularly scan web applications for vulnerabilities such as CORS Misconfiguration

1. Use a web application firewall to detect and prevent CORS Misconfiguration attacks

## Objectives

1. To demonstrate how an attacker can exploit CORS Misconfiguration vulnerability

1. To retrieve sensitive data from the vulnerable endpoint

# Instructions

1. Host the respective JS script at apiiexample.com

**Code**: [[apiiexample.com]]

> In order to exploit the CORS Misconfiguration vulnerability, the respective JS script needs to be hosted at apiiexample.com. This can be done by uploading the script to a web server or using a cloud-based service like AWS S3.

**Command** ([[Access API]]):

```bash
curl apiiexample.com
```

2. Execute the provided JavaScript code to exploit the CORS Misconfiguration vulnerability

**Code**: [[var req = new XMLHttpRequest(); 
req.onload = reqL]]

> The provided JavaScript code sends a request to the vulnerable endpoint and retrieves sensitive data. The withCredentials property is set to true to allow the attacker to access the response data. The retrieved data is then sent to the attacker's server using the location property. This PoC demonstrates how an attacker can exploit the CORS Misconfiguration vulnerability to steal sensitive data.

## Commands Used

- [[Access API]]

## Tags

- [[CORS Misconfiguration]]
- [[Exploitation]]
- [[Proof of concept (Example 2)]]
- [[Vulnerable Example: Expanding the Origin / Regex Issues]]
