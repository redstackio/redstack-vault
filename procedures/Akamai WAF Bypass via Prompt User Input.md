---
id: 8cc02cce-cdc4-4ce8-8162-3621d51d6fdd
name: Akamai WAF Bypass via Prompt User Input
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:43.566296+00:00'
updated_at: '2023-04-10T20:21:39.174042+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Execution|TA0002 - Execution]]'
techniques:
- '[[Command-Line Interface|T1059 - Command-Line Interface]]'
- '[[Indirect Command Execution|T1202 - Indirect Command Execution]]'
- '[[Regsvr32|T1117 - Regsvr32]]'
- '[[Scripting|T1064 - Scripting]]'
tags:
- '[[Akamai WAF Bypass by [@s0md3v](https://twitter.com/s0md3v/status/1056447131362324480)
  - 28th October 2018]]'
- '[[Common WAF Bypass]]'
- '[[Cross Site Scripting]]'
---

# Akamai WAF Bypass via Prompt User Input

## Summary

This procedure involves exploiting a cross-site scripting vulnerability to bypass the Akamai Web Application Firewall (WAF). The attacker prompts the user to enter malicious input, which is then executed on the client side. This input can be used to bypass the WAF and execute commands on the target

## Description

# Description

This procedure involves exploiting a cross-site scripting vulnerability to bypass the Akamai Web Application Firewall (WAF). The attacker prompts the user to enter malicious input, which is then executed on the client side. This input can be used to bypass the WAF and execute commands on the target system. This technique can be used to gain access to sensitive information or to compromise the target system.

From a technical perspective, the attacker injects malicious code into a vulnerable webpage, which is then executed on the client side. The injected code can be used to execute commands on the target system, bypassing the WAF. This technique is effective because the WAF is only able to inspect traffic that is sent to the server, and is unable to inspect traffic that is generated by the client.

The business value of this procedure is that it can be used to gain unauthorized access to sensitive information or to compromise the target system. This can lead to reputational damage, financial losses, and legal liabilities.

 

## Requirements

1. Access to a vulnerable webpage

1. Ability to inject malicious code into the webpage

1. Ability to prompt the user to enter malicious input

 

## Defense

1. Implement input validation and output encoding to prevent cross-site scripting attacks

1. Implement a secure software development lifecycle to identify and address security vulnerabilities

1. Implement security controls to monitor and detect malicious activity on the network

 

## Objectives

1. Bypass the Akamai Web Application Firewall

1. Execute commands on the target system

1. Gain unauthorized access to sensitive information

 

# Instructions

1. To prompt the user for input, use the 'prompt' function in JavaScript. The 'prompt' function takes one argument, which is the message to display to the user in the prompt dialog box. For example, to prompt the user for their name, you could use the following code:

prompt('What is your name?');

 



**Code**: [[<dETAILS%0aopen%0aonToGgle%0a=%0aa=prompt,a() x>]]



> The 'prompt' function displays a dialog box to the user with a message and an input field. The user can enter a value in the input field and click 'OK' to submit the value or 'Cancel' to cancel the prompt. The value entered by the user is returned as the result of the 'prompt' function, so you can store it in a variable for later use.

## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Execution|TA0002 - Execution]]

### Techniques

- [[Command-Line Interface|T1059 - Command-Line Interface]]
- [[Indirect Command Execution|T1202 - Indirect Command Execution]]
- [[Regsvr32|T1117 - Regsvr32]]
- [[Scripting|T1064 - Scripting]]

## Tags

- [[Akamai WAF Bypass by [@s0md3v](https://twitter.com/s0md3v/status/1056447131362324480) - 28th October 2018]]
- [[Common WAF Bypass]]
- [[Cross Site Scripting]]


