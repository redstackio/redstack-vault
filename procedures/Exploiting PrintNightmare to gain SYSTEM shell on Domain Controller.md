---
id: 358c3ff2-4e5c-4493-b0a2-7521aa7a9298
name: Exploiting PrintNightmare to gain SYSTEM shell on Domain Controller
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:02.801568+00:00'
updated_at: '2023-04-10T20:25:42.271361+00:00'
tactics:
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]'
tags:
- '[[Active Directory Attacks]]'
- '[[From CVE to SYSTEM shell on DC]]'
- '[[PrintNightmare]]'
---

# Exploiting PrintNightmare to gain SYSTEM shell on Domain Controller

## Summary

This procedure outlines the steps required to exploit the PrintNightmare vulnerability to gain SYSTEM shell on a Domain Controller. The attacker first identifies a vulnerable system and then uses the DLL search order hijacking technique to execute a malicious DLL on the target system. This DLL then

## Description

# Description

This procedure outlines the steps required to exploit the PrintNightmare vulnerability to gain SYSTEM shell on a Domain Controller. The attacker first identifies a vulnerable system and then uses the DLL search order hijacking technique to execute a malicious DLL on the target system. This DLL then allows the attacker to escalate privileges to SYSTEM level and gain full control over the target system. This type of attack can be devastating for organizations as it allows the attacker to gain complete control over the Active Directory environment.

 

## Requirements

1. Access to a vulnerable system

1. Knowledge of the DLL search order hijacking technique

1. Ability to execute a malicious DLL on the target system

 

## Defense

1. Ensure that all systems are patched and up-to-date to prevent exploitation of known vulnerabilities

1. Implement strict access controls and limit the privileges of users to prevent privilege escalation

1. Monitor network traffic and system logs for suspicious activity

 

## Objectives

1. Gain SYSTEM shell on the Domain Controller

1. Escalate privileges from a low-privileged user to SYSTEM level

 

# Instructions

1. To store the DLL in a different location, modify the path in the command accordingly.

 



**Code**: [[C:\Windows\System32\spool\drivers\x64\3\]]



> This command specifies the location where a DLL (Dynamic Link Library) will be stored. DLLs are files that contain code and data that can be used by multiple programs at the same time. The path provided in the command is the default location where the DLL will be stored. If you want to store the DLL in a different location, you can modify the path in the command. It is important to note that the path specified should be a valid path on the system.

## MITRE ATT&CK Mapping

### Tactics

- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]

## Tags

- [[Active Directory Attacks]]
- [[From CVE to SYSTEM shell on DC]]
- [[PrintNightmare]]


