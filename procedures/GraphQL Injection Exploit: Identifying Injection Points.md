---
id: 95540956-ccfb-4345-a2de-3eaf6625cf50
name: 'GraphQL Injection Exploit: Identifying Injection Points'
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:58.763308+00:00'
updated_at: '2023-04-10T20:22:23.218748+00:00'
tactics:
- '[[Discovery|TA0007 - Discovery]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
- '[[Password Policy Discovery|T1201 - Password Policy Discovery]]'
tags:
- '[[Exploit]]'
- '[[GraphQL Injection]]'
- '[[Identify an injection point]]'
commands:
- '[[Empty Query]]'
- '[[GraphQL Schema Query]]'
- '[[Invalid Query]]'
---

# GraphQL Injection Exploit: Identifying Injection Points

## Summary

GraphQL Injection is a type of attack that exploits vulnerabilities in GraphQL APIs. In this procedure, we will identify injection points in the GraphQL API by sending crafted queries to the /graphql and /graphiql endpoints. By sending different queries, we can determine if the API is vulnerable to

## Description

# Description

GraphQL Injection is a type of attack that exploits vulnerabilities in GraphQL APIs. In this procedure, we will identify injection points in the GraphQL API by sending crafted queries to the /graphql and /graphiql endpoints. By sending different queries, we can determine if the API is vulnerable to injection attacks.

Technical Explanation: An attacker can use GraphQL Injection to modify the original query and gain access to sensitive data or execute unauthorized actions. GraphQL Injection can be used to bypass authentication and authorization mechanisms, as well as to execute Denial of Service (DoS) attacks. 

Business Value: By identifying injection points, organizations can proactively secure their GraphQL APIs and prevent attackers from exploiting vulnerabilities to gain unauthorized access to sensitive data or execute unauthorized actions.

 

## Requirements

1. Access to the GraphQL API

1. Knowledge of GraphQL queries

 

## Defense

1. Implement input validation and sanitization to prevent injection attacks

1. Implement access control mechanisms to restrict unauthorized access

1. Monitor the GraphQL API for suspicious activity and implement logging and alerting mechanisms

 

## Objectives

1. Identify injection points in the GraphQL API

1. Determine if the API is vulnerable to injection attacks

 

# Instructions

1. Send a crafted query to the /graphql endpoint to determine if the API is vulnerable to injection attacks.

 



**Code**: [[/graphql]]



> Craft a query that includes a GraphQL Injection payload and send it to the /graphql endpoint. If the API is vulnerable, it will return a response that includes the injected payload.

2. Send a crafted query to the /graphiql endpoint to determine if the API is vulnerable to injection attacks.

 



**Code**: [[/graphiql]]



> Craft a query that includes a GraphQL Injection payload and send it to the /graphiql endpoint. If the API is vulnerable, it will return a response that includes the injected payload.

3. Send crafted queries to /graphql and /graphiql endpoints to determine if the API is vulnerable to injection attacks.

 



**Code**: [[example.com/graphql?query={__schema{types{name}}}
]]



> Craft queries that include a GraphQL Injection payload and send them to the /graphql and /graphiql endpoints. If the API is vulnerable, it will return a response that includes the injected payload.

4. Check for error messages in the response to determine if the API is vulnerable to injection attacks.

 



**Code**: [[?query={__schema}
?query={}
?query={thisdefinitely]]



> Craft queries that include a GraphQL Injection payload and send them to the /graphql and /graphiql endpoints. If the API is vulnerable, it will return a response that includes the injected payload.



**Command** ([[GraphQL Schema Query]]):

```bash
?query={__schema}
```





**Command** ([[Empty Query]]):

```bash
?query={}
```





**Command** ([[Invalid Query]]):

```bash
?query={thisdefinitelydoesnotexist}
```



## MITRE ATT&CK Mapping

### Tactics

- [[Discovery|TA0007 - Discovery]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]
- [[Password Policy Discovery|T1201 - Password Policy Discovery]]

## Commands Used

- [[Empty Query]]
- [[GraphQL Schema Query]]
- [[Invalid Query]]

## Tags

- [[Exploit]]
- [[GraphQL Injection]]
- [[Identify an injection point]]


