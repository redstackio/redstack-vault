---
id: 5cc6e4ee-2230-492e-b598-0d704a81c02d
name: SSRF Exploiting URL Parser Bypass
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:37.633896+00:00'
updated_at: '2023-04-10T20:24:14.414484+00:00'
tactics:
- '[[Collection|TA0009 - Collection]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Data from Information Repositories|T1213 - Data from Information Repositories]]'
- '[[Drive-by Compromise|T1189 - Drive-by Compromise]]'
tags:
- '[[Bypass against a weak parser]]'
- '[[Bypassing filters]]'
- '[[Server-Side Request Forgery]]'
---

# SSRF Exploiting URL Parser Bypass

## Summary

This procedure involves exploiting a weak URL parser to bypass filters and perform a Server-Side Request Forgery (SSRF) attack. By manipulating the URL parameters, an attacker can force the server to make requests to unintended targets, such as internal systems or external services. This can result

## Description

# Description

This procedure involves exploiting a weak URL parser to bypass filters and perform a Server-Side Request Forgery (SSRF) attack. By manipulating the URL parameters, an attacker can force the server to make requests to unintended targets, such as internal systems or external services. This can result in sensitive data disclosure, unauthorized access, and even complete system compromise. The technical explanation involves crafting a specially crafted URL with malicious payloads, which can be used to bypass filters and exploit the parser. The business value of this attack lies in the ability to gain access to sensitive data and systems, which can be used for financial gain or espionage purposes.

## Requirements

1. Access to the target system

1. Knowledge of the target's URL parser and its weaknesses

1. Tools for crafting and testing malicious URLs

## Defense

1. Implement proper input validation and sanitization techniques to prevent malicious URLs from being processed

1. Use a whitelist approach to restrict access to only necessary resources and services

1. Monitor network traffic for suspicious activity, such as requests to unexpected hosts or services

## Objectives

1. Perform a successful SSRF attack against a target system

1. Bypass filters and other security measures to achieve the attack

1. Gain unauthorized access to sensitive data or systems

# Instructions

1. The SSRF Exploiting URL Parser command allows the user to exploit a Server-Side Request Forgery (SSRF) vulnerability by manipulating the URL parser. The vulnerability can be used to access internal systems, bypass security controls, and exfiltrate data.

The following arguments can be used with this command:
- <url>: The URL to be exploited.
- <payload>: The payload to be injected into the URL to exploit the vulnerability.

Example usage:
ssrf-exploit --url http://example.com --payload "http://attacker.com"

**Code**: [[http://127.1.1.1:80\@127.2.2.2:80/
http://127.1.1.]]

> The data field contains a set of URLs that can be used to test the SSRF Exploiting URL Parser command. The lang field specifies that the command should be executed in PowerShell. The text field provides a reference to the original research paper by Orange Tsai that describes this vulnerability in detail. The instruction field provides a detailed explanation of the command and its arguments. The name field provides a clear and concise name for the command that informs the user of its purpose.

## MITRE ATT&CK Mapping

### Tactics

- [[Collection|TA0009 - Collection]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Data from Information Repositories|T1213 - Data from Information Repositories]]
- [[Drive-by Compromise|T1189 - Drive-by Compromise]]

## Tags

- [[Bypass against a weak parser]]
- [[Bypassing filters]]
- [[Server-Side Request Forgery]]
