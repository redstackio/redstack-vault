---
id: 5964086e-dbca-465b-9b1c-1608dab66b1a
name: Node Deserialization Exploit using Funcster
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:59.282543+00:00'
updated_at: '2023-04-06T03:55:59.295314+00:00'
tactics:
- '[[Exfiltration|TA0010 - Exfiltration]]'
techniques:
- '[[Scheduled Transfer|T1029 - Scheduled Transfer]]'
tags:
- '[[Exploit]]'
- '[[Funcster]]'
- '[[Node Deserialization]]'
---

# Node Deserialization Exploit using Funcster

## Summary

The Node.js deserialization vulnerability allows attackers to execute arbitrary code on the server. Funcster is a tool that can be used to exploit this vulnerability. An attacker can craft a malicious payload that will be deserialized by the server, leading to remote code execution. The attacker ca

## Description

# Description

The Node.js deserialization vulnerability allows attackers to execute arbitrary code on the server. Funcster is a tool that can be used to exploit this vulnerability. An attacker can craft a malicious payload that will be deserialized by the server, leading to remote code execution. The attacker can then take control of the server and perform various malicious activities such as stealing sensitive data, modifying or deleting files, and installing backdoors. 

Technical Explanation: Node.js deserialization vulnerability occurs when an attacker is able to inject a malicious payload into an application that uses the `deserialize` function. The payload is then deserialized by the application, leading to code execution. Funcster is a tool that can be used to craft such payloads. It allows an attacker to create a serialized JavaScript object that contains arbitrary code. When the object is deserialized by the server, the code is executed. 

Business Value: An attacker can use this vulnerability to take control of the server and perform various malicious activities. This can lead to loss of sensitive data, damage to reputation, and financial loss. It is important for organizations to ensure that their Node.js applications are not vulnerable to deserialization attacks.

 

## Requirements

1. Access to a vulnerable Node.js application

 

## Defense

1. Ensure that Node.js applications are updated to the latest version

1. Implement input validation to prevent injection attacks

1. Implement a content security policy to prevent the execution of malicious scripts

 

## Objectives

1. Execute arbitrary code on the server

1. Take control of the server

 

# Instructions

1. Use Funcster to create a serialized JavaScript object that contains arbitrary code.

 



**Code**: [[{"rce":{"__js_function":"function(){CMD=\"cmd /c c]]



> The `__js_function` field in the payload contains the arbitrary code that will be executed when the object is deserialized. In this case, the code will execute the Windows calculator.

## MITRE ATT&CK Mapping

### Tactics

- [[Exfiltration|TA0010 - Exfiltration]]

### Techniques

- [[Scheduled Transfer|T1029 - Scheduled Transfer]]

## Tags

- [[Exploit]]
- [[Funcster]]
- [[Node Deserialization]]


