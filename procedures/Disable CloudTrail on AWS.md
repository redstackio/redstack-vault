---
id: 337285d5-3f6e-46ca-91b5-2ae7cbb29db9
name: Disable CloudTrail on AWS
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:09.757215+00:00'
updated_at: '2023-04-10T20:20:03.051431+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Discovery|TA0007 - Discovery]]'
techniques:
- '[[Cloud Service Dashboard|T1538 - Cloud Service Dashboard]]'
- '[[Revert Cloud Instance|T1536 - Revert Cloud Instance]]'
tags:
- '[[Cloud - AWS]]'
- '[[Disable CloudTrail]]'
commands:
- '[[Delete CloudTrail]]'
- '[[Update CloudTrail]]'
- '[[Update CloudTrail Trail]]'
---

# Disable CloudTrail on AWS

## Summary

Disabling CloudTrail on AWS can be used as a defensive measure to prevent an attacker from gaining visibility into the actions taken on the account. CloudTrail is a logging service that records API calls made on the account, making it a valuable tool for attackers to understand the environment and 

## Description

# Description

Disabling CloudTrail on AWS can be used as a defensive measure to prevent an attacker from gaining visibility into the actions taken on the account. CloudTrail is a logging service that records API calls made on the account, making it a valuable tool for attackers to understand the environment and carry out their attack. By disabling CloudTrail, the attacker will have a harder time understanding the environment and will be limited in their ability to carry out their attack. From a technical perspective, disabling CloudTrail can be done by deleting the CloudTrail trail or disabling it on specific regions. From a business perspective, disabling CloudTrail can help prevent the theft of sensitive data and maintain the integrity of the environment.

 

## Requirements

1. AWS account credentials with sufficient permissions to disable CloudTrail

 

## Defense

1. Regularly review CloudTrail logs to detect any changes made to the environment

1. Implement multi-factor authentication (MFA) to prevent unauthorized access to the AWS account

1. Regularly review IAM policies to ensure that permissions are appropriate and not overly permissive

 

## Objectives

1. Prevent attackers from gaining visibility into the actions taken on the account

1. Limit the attacker's ability to carry out their attack

1. Prevent the theft of sensitive data

1. Maintain the integrity of the environment

 

# Instructions

1. Before running this command, make sure you have the necessary permissions to delete a CloudTrail trail.

 



**Code**: [[$ aws cloudtrail delete-trail --name cloudgoat_tra]]



> - `delete-trail`: This is the command to delete a CloudTrail trail.
- `--name`: This is the name of the trail that you want to delete.
- `--profile`: This is the name of the AWS CLI profile that you want to use to run the command.



**Command** ([[Delete CloudTrail]]):

```bash
$ aws cloudtrail delete-trail --name cloudgoat_trail --profile administrator
```



2. To disable monitoring of events from global services, use the following command:

 



**Code**: [[$ aws cloudtrail update-trail --name cloudgoat_tra]]



> This command updates the CloudTrail trail named 'cloudgoat_trail' and sets the 'no-include-global-service-event' parameter to true, which disables the monitoring of events from global services. By default, CloudTrail monitors events from all AWS services, including global services like IAM and CloudFront. Disabling the monitoring of global services can help reduce the number of events generated by CloudTrail, which can help reduce costs and make it easier to identify relevant events.



**Command** ([[Update CloudTrail Trail]]):

```bash
$ aws cloudtrail update-trail --name cloudgoat_trail --no-include-global-service-event
```



3. To disable Cloud Trail on specific regions, use the following command:

 



**Code**: [[$ aws cloudtrail update-trail --name cloudgoat_tra]]



> This command will update the Cloud Trail named 'cloudgoat_trail' and disable it for the region 'eu-west'. The options '--no-include-global-service-event' and '--no-is-multi-region' ensure that the trail is not enabled for all regions or global service events. This command can be modified to include or exclude other regions as needed.



**Command** ([[Update CloudTrail]]):

```bash
$ aws cloudtrail update-trail --name cloudgoat_trail --no-include-global-service-event --no-is-multi-region --region=eu-west
```



## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Discovery|TA0007 - Discovery]]

### Techniques

- [[Cloud Service Dashboard|T1538 - Cloud Service Dashboard]]
- [[Revert Cloud Instance|T1536 - Revert Cloud Instance]]

## Commands Used

- [[Delete CloudTrail]]
- [[Update CloudTrail]]
- [[Update CloudTrail Trail]]

## Tags

- [[Cloud - AWS]]
- [[Disable CloudTrail]]


