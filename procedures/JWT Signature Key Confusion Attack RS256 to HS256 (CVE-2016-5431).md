---
id: 56e8b009-2dd9-4e15-8b33-2a73dce7f932
name: JWT Signature Key Confusion Attack RS256 to HS256 (CVE-2016-5431)
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:00.671991+00:00'
updated_at: '2023-04-10T20:22:34.899669+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
- '[[Persistence|TA0003 - Persistence]]'
techniques:
- '[[Application Access Token|T1527 - Application Access Token]]'
- '[[Brute Force|T1110 - Brute Force]]'
- '[[Modify Authentication Process|T1556 - Modify Authentication Process]]'
sub_techniques:
- '[[Domain Controller Authentication|T1556.001 - Domain Controller Authentication]]'
- '[[Password Guessing|T1110.001 - Password Guessing]]'
tags:
- '[[JWT - JSON Web Token]]'
- '[[JWT Signature]]'
- '[[JWT Signature - Key Confusion Attack RS256 to HS256 (CVE-2016-5431)]]'
commands:
- '[[JWT decoding with public key]]'
---

# JWT Signature Key Confusion Attack RS256 to HS256 (CVE-2016-5431)

## Summary

The JSON Web Token (JWT) is a popular method for securely transmitting information between parties. The JWT is composed of three parts: the header, the payload, and the signature. The signature is used to verify the integrity of the message and to ensure that the message has not been tampered with.

## Description

# Description

The JSON Web Token (JWT) is a popular method for securely transmitting information between parties. The JWT is composed of three parts: the header, the payload, and the signature. The signature is used to verify the integrity of the message and to ensure that the message has not been tampered with. This procedure describes how an attacker can exploit a vulnerability in the JWT signature algorithm to perform a key confusion attack. Specifically, an attacker can use a public key for one algorithm (RS256) to sign a JWT and then change the algorithm to a weaker one (HS256), allowing the attacker to forge a signature that will be accepted by the server. This vulnerability is tracked as CVE-2016-5431.

## Requirements

1. Access to a JWT that is signed using the RS256 algorithm.

## Defense

1. Use strong encryption algorithms for JWT signatures, such as RS512 or ES512.

1. Implement proper input validation and sanitization to prevent attackers from injecting malicious payloads into the JWT.

1. Monitor for anomalous authentication attempts, such as multiple failed attempts from the same IP address or user account.

## Objectives

1. Forge a JWT signature to bypass authentication and gain access to a system.

# Instructions

1. The -X k option specifies that we want to perform a key confusion attack. The -pk option specifies the path to the public key that will be used to sign the JWT. The JWT_HERE field should be replaced with the actual JWT that we want to exploit.

**Code**: [[python3 jwt_tool.py JWT_HERE -X k -pk my_public.pe]]

> This command will exploit the CVE-2016-5431 vulnerability to forge a JWT signature that will be accepted by the server. The -X k option specifies that we want to perform a key confusion attack. The -pk option specifies the path to the public key that will be used to sign the JWT. The JWT_HERE field should be replaced with the actual JWT that we want to exploit.

**Command** ([[JWT decoding with public key]]):

```bash
python3 jwt_tool.py JWT_HERE -X k -pk my_public.pem
```

## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]
- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Lateral Movement|TA0008 - Lateral Movement]]
- [[Persistence|TA0003 - Persistence]]

### Techniques

- [[Application Access Token|T1527 - Application Access Token]]
- [[Brute Force|T1110 - Brute Force]]
- [[Modify Authentication Process|T1556 - Modify Authentication Process]]

### Sub-Techniques

- [[Domain Controller Authentication|T1556.001 - Domain Controller Authentication]]
- [[Password Guessing|T1110.001 - Password Guessing]]

## Commands Used

- [[JWT decoding with public key]]

## Tags

- [[JWT - JSON Web Token]]
- [[JWT Signature]]
- [[JWT Signature - Key Confusion Attack RS256 to HS256 (CVE-2016-5431)]]
