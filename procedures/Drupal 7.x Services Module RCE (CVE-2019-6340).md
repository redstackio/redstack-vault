---
id: 2e2dd227-1e6f-4a48-823f-6d927372dcf4
name: Drupal 7.x Services Module RCE (CVE-2019-6340)
type: procedure
verified: false
submitted: false
created_at: '2019-12-05T19:42:17.208295+00:00'
updated_at: '2023-05-29T16:48:53.253841+00:00'
tactics:
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
platforms:
- Linux
tags:
- '[[RCE]]'
- '[[Web Applications]]'
---

# Drupal 7.x Services Module RCE (CVE-2019-6340)

## Summary

Improper sanitation of input from non-form sources allows attackers to execute arbitrary code if either: the site uses a RESTful API the site has a module like JSON.API enabled. 

## Description

# Description

Improper sanitation of input from non-form sources allows attackers to execute arbitrary code if either:

- the site uses a RESTful API

- the site has a module like JSON.API enabled.

# Instructions

Download the exploit code from exploit-db: [https://www.exploit-db.com/exploits/41564](https://www.exploit-db.com/exploits/41564)

A number of fields will need to be updated:

- $url: change to the target IP address

- $endpoint_path: change to the path of the REST api. eg (/rest)

- $filename: change to a memorable name unless stealth is necessary

- $data: modify to contain a more useful PHP payload, such as a cmdshell

- The exploit script also has erroneous text on lines 16 and 71. Comment each out each line with a hash symbol.

Excerpt of modified code:

**Code**: [[$url = 'http://10.10.10.9';
$endpoint_path = '/res]]

Execute the script to add the payload to the site.

After the script runs, the payload will have been written into a file in the base directory of the web server.

For example: [ http://10.10.10.9/cmdshell.php](http://10.10.10.9/cmdshell.php)

If using the cmdshell, append "?cmd=<COMMAND>' to execute commands. Eg:

[http://10.10.10.9/cmdshell.php?cmd=whoami](http://10.10.10.9/cmdshell.php?cmd=whoami)

## Platforms

- Linux

## MITRE ATT&CK Mapping

### Tactics

- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]

## Tags

- [[RCE]]
- [[Web Applications]]
