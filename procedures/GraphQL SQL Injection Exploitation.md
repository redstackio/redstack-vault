---
id: 11fc81d2-7fc9-4c87-a2a5-b676eb198a1d
name: GraphQL SQL Injection Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:58.960156+00:00'
updated_at: '2023-04-10T20:22:21.469265+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Discovery|TA0007 - Discovery]]'
techniques:
- '[[Password Policy Discovery|T1201 - Password Policy Discovery]]'
- '[[Template Injection|T1221 - Template Injection]]'
- '[[Two-Factor Authentication Interception|T1111 - Two-Factor Authentication Interception]]'
tags:
- '[[Exploit]]'
- '[[GraphQL Injection]]'
- '[[SQL injection]]'
commands:
- '[[Query bacon by id]]'
---

# GraphQL SQL Injection Exploitation

## Summary

GraphQL is a query language for APIs that allows clients to request only the data they need, and nothing more. It provides a more efficient, powerful and flexible alternative to REST. However, it can be vulnerable to SQL injection attacks. An attacker can exploit this vulnerability by injecting mal

## Description

# Description

GraphQL is a query language for APIs that allows clients to request only the data they need, and nothing more. It provides a more efficient, powerful and flexible alternative to REST. However, it can be vulnerable to SQL injection attacks. An attacker can exploit this vulnerability by injecting malicious SQL code into a GraphQL query, which can lead to data theft or data manipulation. This attack can be executed by sending a specially crafted GraphQL query to the server. The server will then execute the query, including the injected SQL code, resulting in the attacker gaining unauthorized access to the database.

## Requirements

1. Access to the GraphQL endpoint.

1. Knowledge of SQL injection techniques.

1. A tool to send the crafted GraphQL query, such as curl or Postman.

## Defense

1. Use parameterized queries to prevent SQL injection attacks.

1. Implement input validation and sanitization to prevent malicious input.

1. Limit the privileges of the database user to prevent unauthorized access to sensitive data.

## Objectives

1. To exploit the GraphQL injection vulnerability to gain unauthorized access to the database.

1. To extract sensitive data from the database.

1. To manipulate data in the database.

# Instructions

1. Send the single quote as a parameter to a GraphQL query field.

**Code**: [[']]

> If the server returns an error message or behaves unexpectedly, it may indicate that the application is vulnerable to SQL injection.

2. Send a GraphQL query with a specially crafted parameter that contains SQL code.

**Code**: [[{ 
    bacon(id: "1'") { 
        id, 
        typ]]

> The SQL code will be executed by the server, and the result will be returned to the attacker. The attacker can use this to extract sensitive data or manipulate the database.

**Command** ([[Query bacon by id]]):

```bash
{ 
    bacon(id: "1'") { 
        id, 
        type, 
        price
    }
}
```

3. Send a GraphQL query with a complex SQL injection attack.

**Code**: [[curl -X POST http://localhost:8080/graphql\?embedd]]

> This attack includes a sleep function, which can be used to slow down the server and evade detection. The double dash at the end of the query is used to comment out the rest of the query, which can help to evade detection.

## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]
- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Discovery|TA0007 - Discovery]]

### Techniques

- [[Password Policy Discovery|T1201 - Password Policy Discovery]]
- [[Template Injection|T1221 - Template Injection]]
- [[Two-Factor Authentication Interception|T1111 - Two-Factor Authentication Interception]]

## Commands Used

- [[Query bacon by id]]

## Tags

- [[Exploit]]
- [[GraphQL Injection]]
- [[SQL injection]]
