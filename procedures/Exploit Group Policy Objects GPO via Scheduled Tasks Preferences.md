---
id: 83f112b2-62e0-4419-b468-84f535e0a8a8
name: Exploit Group Policy Objects GPO via Scheduled Tasks Preferences
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:03.599849+00:00'
updated_at: '2023-04-10T20:25:52.715037+00:00'
tags:
- '[[Active Directory Attacks]]'
- '[[Exploit Group Policy Objects GPO]]'
commands:
- '[[Access GPO folder]]'
- '[[Update Group Policy]]'
---

# Exploit Group Policy Objects GPO via Scheduled Tasks Preferences

## Summary

This procedure involves exploiting Group Policy Objects (GPO) in order to gain access to sensitive information or execute malicious code. By utilizing Scheduled Tasks Preferences, an attacker can create a new scheduled task on a target machine that will execute their code or script. This technique 

## Description

# Description

This procedure involves exploiting Group Policy Objects (GPO) in order to gain access to sensitive information or execute malicious code. By utilizing Scheduled Tasks Preferences, an attacker can create a new scheduled task on a target machine that will execute their code or script. This technique can be used to escalate privileges or to persist on a network. The business value of this attack is that an attacker can gain access to sensitive information or execute malicious code, which can lead to financial loss, reputational damage, and legal consequences.

 

## Requirements

1. Access to a target machine

1. Knowledge of Group Policy Objects (GPO)

1. Knowledge of Scheduled Tasks Preferences

1. Credentials with sufficient privileges

 

## Defense

1. Ensure that all Group Policy Objects (GPO) are properly configured and do not contain any malicious code or scripts

1. Monitor for any new scheduled tasks being created on the network

1. Implement least privilege access control to limit the damage that an attacker can do if they gain access to a machine

 

## Objectives

1. Gain access to sensitive information

1. Execute malicious code

1. Escalate privileges

1. Persist on a network

 

# Instructions

1. To access the Group Policy Object (GPO) storage location, follow the path mentioned in the 'data' field. Replace &lt;domain.dns&gt; with the actual domain name and &lt;GPOName&gt; with the name of the specific GPO you want to access.

 



**Code**: [[\\&lt;domain.dns&gt;\SYSVOL\&lt;domain.dns&gt;\Pol]]



> Group Policy Objects (GPOs) are used to configure settings for users and computers in an Active Directory environment. These settings can be related to security, software installation, network configuration, and more. The GPOs are stored in a central location on the domain controller (DC) and are replicated to all other DCs in the domain. The path mentioned in the 'data' field is the location where the GPOs are stored on the DC. It includes the domain name and the name of the specific GPO. To access a GPO, you can navigate to this location and find the folder with the name of the GPO you want to access.



**Command** ([[Access GPO folder]]):

```bash
\\&lt;domain.dns&gt;\SYSVOL\&lt;domain.dns&gt;\Policies\&lt;GPOName&gt;\
```



2. To modify Scheduled Tasks Preferences, you can edit the GPO or connect to the DC and replace the files. To create a new scheduled task, use the 'schtasks' command with appropriate arguments.

 



**Code**: [[Machine\Preferences\ScheduledTasks]]



> Scheduled Tasks Preferences are used to configure and manage scheduled tasks on Windows machines. By modifying this preference, you can create, modify, or delete scheduled tasks. The 'schtasks' command is used to create and manage scheduled tasks. The command can be used with various arguments to specify the task name, trigger, action, and other settings. For example, 'schtasks /create /tn TaskName /tr TaskPath /sc ScheduleType /st StartTime /sd StartDate /ed EndDate /ru RunAsUser /rp RunAsPassword' can be used to create a new scheduled task with the specified settings.

3. To force an immediate update of the group policy settings on a Windows computer, run the following command in an elevated command prompt:

 



**Code**: [[gpupdate /force]]



> The 'gpupdate' command is used to refresh the local and Active Directory-based Group Policy settings, including security settings, computer and user settings, and scripts. The '/force' parameter is used to force a reapplication of all settings, even if they have not changed since the last update. This command is useful in situations where you have made changes to Group Policy settings and want to ensure they are applied immediately, rather than waiting for the next scheduled update.



**Command** ([[Update Group Policy]]):

```bash
gpupdate /force
```



## Commands Used

- [[Access GPO folder]]
- [[Update Group Policy]]

## Tags

- [[Active Directory Attacks]]
- [[Exploit Group Policy Objects GPO]]


