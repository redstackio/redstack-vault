---
id: 575884b1-cab3-4fce-83df-6f05a3665354
name: 'LDAP Injection: Exploiting userPassword attribute'
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:01.686372+00:00'
updated_at: '2023-04-10T20:36:27.302535+00:00'
tags:
- '[[Exploiting userPassword attribute]]'
- '[[LDAP Injection]]'
commands:
- '[[Set user password]]'
- '[[User Password Encoding]]'
---

# LDAP Injection: Exploiting userPassword attribute

## Summary

LDAP Injection is a technique used to exploit vulnerabilities in applications that use LDAP (Lightweight Directory Access Protocol) for authentication and authorization. By injecting malicious code into user input fields, an attacker can manipulate the LDAP queries and gain unauthorized access to s

## Description

# Description

LDAP Injection is a technique used to exploit vulnerabilities in applications that use LDAP (Lightweight Directory Access Protocol) for authentication and authorization. By injecting malicious code into user input fields, an attacker can manipulate the LDAP queries and gain unauthorized access to sensitive information. Exploiting the userPassword attribute is a common method of performing LDAP Injection attacks, as this attribute is used to store user passwords in LDAP directories.

Technical Explanation: An attacker can manipulate the userPassword attribute by injecting LDAP filter escape sequences, which modify the behavior of the LDAP query. These escape sequences can be used to bypass authentication checks, retrieve sensitive information or perform other malicious actions.

Business Value: An attacker can use LDAP Injection to gain unauthorized access to sensitive information, such as user credentials, customer data, or other confidential information. This can result in financial losses, reputational damage, and legal liabilities for the targeted organization.

 

## Requirements

1. Access to an application that uses LDAP for authentication and authorization.

1. Knowledge of LDAP Injection techniques.

1. Access to a tool or script that can automate the injection process.

 

## Defense

1. Validate user input and sanitize any input that will be used in LDAP queries.

1. Implement access controls and limit privileges to reduce the impact of a successful LDAP Injection attack.

1. Monitor LDAP queries for suspicious activity and implement intrusion detection and prevention systems to detect and block malicious traffic.

 

## Objectives

1. Gain unauthorized access to sensitive information stored in an LDAP directory.

1. Bypass authentication checks and gain elevated privileges.

1. Perform other malicious actions, such as modifying or deleting data.

 

# Instructions

1. 

 



**Code**: [[userPassword]]



> This attribute can be manipulated by an attacker to perform LDAP Injection attacks.



**Command** ([[Set user password]]):

```bash
userPassword: ************
```



2. 

 



**Code**: [[cn]]



> This attribute is not a string like the userPassword attribute, so it cannot be directly manipulated for LDAP Injection attacks.

3. 

 



**Code**: [[userPassword:2.5.13.18:=\xx (\xx is a byte)
userPa]]



> The escape sequence \xx represents a byte value in hexadecimal notation. An attacker can use these sequences to modify the behavior of the LDAP query and perform LDAP Injection attacks.



**Command** ([[User Password Encoding]]):

```bash
userPassword:2.5.13.18:=\xx (\xx is a byte)
userPassword:2.5.13.18:=\xx\xx
userPassword:2.5.13.18:=\xx\xx\xx
```



## Commands Used

- [[Set user password]]
- [[User Password Encoding]]

## Tags

- [[Exploiting userPassword attribute]]
- [[LDAP Injection]]


