---
id: bf72de32-668a-424c-8fd6-5e0e6e1f268e
name: CORS Misconfiguration Exploitation with XSS on Trusted Origin
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:55.804658+00:00'
updated_at: '2023-04-10T20:21:19.881924+00:00'
tactics:
- '[[Persistence|TA0003 - Persistence]]'
techniques:
- '[[Create Account|T1136 - Create Account]]'
tags:
- '[[CORS Misconfiguration]]'
- '[[Exploitation]]'
- '[[Vulnerable Example: XSS on Trusted Origin]]'
---

# CORS Misconfiguration Exploitation with XSS on Trusted Origin

## Summary

CORS (Cross-Origin Resource Sharing) is a security feature implemented in modern browsers that restricts web pages from making requests to a different domain than the one that served the web page. When CORS is misconfigured, an attacker can make requests to the victim's domain from a different doma

## Description

# Description

CORS (Cross-Origin Resource Sharing) is a security feature implemented in modern browsers that restricts web pages from making requests to a different domain than the one that served the web page. When CORS is misconfigured, an attacker can make requests to the victim's domain from a different domain, leading to data theft or manipulation. In this scenario, the attacker exploits an XSS vulnerability on a trusted origin to inject malicious code and bypass CORS restrictions. This way, the attacker can exfiltrate sensitive data or manipulate the victim's web credentials.

 

## Requirements

1. Access to an XSS vulnerability on a trusted origin.

 

## Defense

1. Implement strict CORS policies to only allow requests from trusted domains.

1. Regularly scan for XSS vulnerabilities and patch them as soon as possible.

1. Monitor network traffic for any suspicious requests or data exfiltration attempts.

 

## Objectives

1. Exploit the CORS misconfiguration vulnerability to exfiltrate sensitive data or manipulate victim's web credentials.

 

# Instructions

1. Replace the `CORS-ATTACK-PAYLOAD` with the payload that will be executed on the victim's browser.

 

This command exploits the XSS vulnerability on a trusted origin by injecting the exploit code into the victim's browser. The exploit code then sends a request to the victim's domain, bypassing the CORS restrictions and allowing the attacker to exfiltrate sensitive data or manipulate the victim's web credentials.

## MITRE ATT&CK Mapping

### Tactics

- [[Persistence|TA0003 - Persistence]]

### Techniques

- [[Create Account|T1136 - Create Account]]

## Tags

- [[CORS Misconfiguration]]
- [[Exploitation]]
- [[Vulnerable Example: XSS on Trusted Origin]]


