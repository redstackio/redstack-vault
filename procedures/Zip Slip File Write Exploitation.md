---
id: 7601d510-f2d1-45b7-9a50-66a7fee5cfb2
name: Zip Slip File Write Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:41.178968+00:00'
updated_at: '2023-04-10T20:24:36.045393+00:00'
tactics:
- '[[Execution|TA0002 - Execution]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
- '[[System Services|T1569 - System Services]]'
tags:
- '[[Exploits]]'
- '[[Upload Insecure Files]]'
- '[[ZIP archive]]'
---

# Zip Slip File Write Exploitation

## Summary

Zip Slip File Write Exploitation is a technique that can be used by attackers to write files to arbitrary locations on the file system by exploiting the Zip Slip vulnerability. This vulnerability occurs when an application does not properly validate the paths of files contained within a ZIP archive

## Description

# Description

Zip Slip File Write Exploitation is a technique that can be used by attackers to write files to arbitrary locations on the file system by exploiting the Zip Slip vulnerability. This vulnerability occurs when an application does not properly validate the paths of files contained within a ZIP archive, and allows an attacker to write files to arbitrary locations on the file system. This technique can be used to achieve initial access to a target system, as well as to execute arbitrary code on the system.

Technical Explanation: An attacker can create a specially crafted ZIP archive that contains files with path traversal sequences in their filenames. When the application extracts the files from the archive, it does not properly validate the paths and writes the files to arbitrary locations on the file system, allowing the attacker to write files to sensitive locations on the system. 

Business Value: An attacker can use this technique to achieve initial access to a target system, or to execute arbitrary code on the system, potentially leading to data theft, system compromise, or disruption of business operations.

## Requirements

1. Access to a vulnerable application that processes ZIP archives

1. Knowledge of the path traversal sequences to use in the filenames of the files to be written

## Defense

1. Ensure that all applications that process ZIP archives properly validate the paths of files contained within them

1. Implement file system permissions that restrict write access to sensitive locations on the file system

1. Implement network segmentation to restrict access to vulnerable applications

## Objectives

1. Write files to arbitrary locations on the target system

1. Achieve initial access to the target system

1. Execute arbitrary code on the target system

# Instructions

1. This command is used to exploit the Zip Slip vulnerability to write a file in a directory other than the intended one. The command takes the following arguments:
1. shell.php: The name of the file to be written
2. unix: The operating system of the target machine
3. shell.zip: The name of the zip file to be created
4. var/www/html/: The path to the directory where the file is to be written
5. 15: The depth of the directory traversal

The command then creates a symbolic link to the index.php file and zips it along with the symlink. This results in the creation of a zip file that contains a symlink to the index.php file. When the zip file is extracted, the symlink is resolved and the index.php file is written in the specified directory.

**Code**: [[python evilarc.py shell.php -o unix -f shell.zip -]]

> This command is used by attackers to exploit the Zip Slip vulnerability, which is a directory traversal vulnerability in archive extraction libraries. The vulnerability allows an attacker to write files to arbitrary locations on the target machine by including directory traversal sequences in the file paths in the archive. This command is used to create a zip file that contains a symlink to the index.php file, which is then extracted to a directory other than the intended one. This allows the attacker to write the index.php file to a directory where they have write access, which can then be used to execute arbitrary code on the target machine.

## MITRE ATT&CK Mapping

### Tactics

- [[Execution|TA0002 - Execution]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]
- [[System Services|T1569 - System Services]]

## Tags

- [[Exploits]]
- [[Upload Insecure Files]]
- [[ZIP archive]]
