---
id: 2ec03b69-a558-444c-b4c6-4c8daef5142a
name: MYSQL Injection via Error Based - Basic with Select Command
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:34.448549+00:00'
updated_at: '2023-04-10T20:22:54.189219+00:00'
tactics:
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]'
tags:
- '[[MYSQL Error Based]]'
- '[[MYSQL Error Based - Basic]]'
- '[[MYSQL Injection]]'
commands:
- '[[Check MySQL version]]'
---

# MYSQL Injection via Error Based - Basic with Select Command

## Summary

MYSQL Injection is a technique used to exploit vulnerabilities in MYSQL databases. This specific procedure utilizes Error Based injection, which is a type of SQL injection that relies on error messages generated by the database. By sending specially crafted SQL statements, an attacker can cause the

## Description

# Description

MYSQL Injection is a technique used to exploit vulnerabilities in MYSQL databases. This specific procedure utilizes Error Based injection, which is a type of SQL injection that relies on error messages generated by the database. By sending specially crafted SQL statements, an attacker can cause the database to reveal sensitive information. In this case, the attacker is using the select command to extract data from the database. This technique can be used to bypass authentication, access sensitive data, and execute arbitrary code.

Technical Explanation: The attacker sends a malicious SQL statement that includes a select command to the database. The statement is designed to cause an error in the database, which will then return an error message that contains sensitive information. The attacker can then extract this information from the error message. The attacker can also modify the SQL statement to execute arbitrary code on the database.

Business Value: This procedure can be used by attackers to gain unauthorized access to sensitive information stored in MYSQL databases. This information can then be used for various purposes, such as identity theft, financial fraud, and corporate espionage.

 

## Requirements

1. Access to a vulnerable MYSQL database

1. Knowledge of SQL injection techniques

1. Tools to craft and send malicious SQL statements

 

## Defense

1. Use parameterized queries to prevent SQL injection attacks

1. Limit database privileges to the minimum necessary for each user

1. Monitor database logs for suspicious activity

 

## Objectives

1. Extract sensitive information from MYSQL databases

1. Bypass authentication mechanisms

1. Execute arbitrary code on the database

 

# Instructions

1. To check the compatibility of MySQL with version 4.1 or higher, use the following command:

 



**Code**: [[MySQL &gt;= 4.1]]



> mysql --version

This command will display the version of MySQL installed on your system. If the version is 4.1 or higher, then your system is compatible with MySQL &gt;= 4.1.



**Command** ([[Check MySQL version]]):

```bash
mysql --version
```



2. The 'select' command is used to retrieve data from a database. In this case, the command is being used to inject malicious code into the database. The injected code will execute when the query is run, allowing an attacker to take control of the database.

 



**Code**: [[(select 1 and row(1,1)>(select count(*),concat(CON]]



> The injected code in this example uses the 'concat' function to concatenate the database version with a random number. The 'floor' function is used to round down the random number. This is then used in a 'count' function to determine the number of rows in the result set. The 'row' function is used to check if there is at least one row in the result set. If there is, the injected code will execute.

## MITRE ATT&CK Mapping

### Tactics

- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]

## Commands Used

- [[Check MySQL version]]

## Tags

- [[MYSQL Error Based]]
- [[MYSQL Error Based - Basic]]
- [[MYSQL Injection]]


