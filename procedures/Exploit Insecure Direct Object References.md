---
id: e90a8579-5c1e-49cb-b0fe-8ed1d9eeaad3
name: Exploit Insecure Direct Object References
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:59.571918+00:00'
updated_at: '2023-04-06T03:55:59.587265+00:00'
tags:
- '[[Exploit]]'
- '[[Insecure Direct Object References]]'
commands:
- '[[Accessing URL]]'
- '[[Change Password]]'
---

# Exploit Insecure Direct Object References

## Summary

Exploiting Insecure Direct Object References (IDOR) is a technique used by attackers to access sensitive data or functionality by manipulating references to resources in a system. IDOR occurs when an application uses an identifier to retrieve an object and the identifier can be easily manipulated b

## Description

# Description

Exploiting Insecure Direct Object References (IDOR) is a technique used by attackers to access sensitive data or functionality by manipulating references to resources in a system. IDOR occurs when an application uses an identifier to retrieve an object and the identifier can be easily manipulated by an attacker. By changing the identifier, the attacker can access objects that they should not have access to. This technique can be used to access sensitive data, modify data or functionality, and escalate privileges.

From a technical perspective, IDOR occurs when an application relies on client-side input to identify an object, such as a user ID or a file name. The application then uses this input to retrieve the object from the server. An attacker can manipulate the input to access other objects in the system that they should not have access to.

The business value of exploiting IDOR lies in the ability to access sensitive data or functionality that is normally restricted. This can lead to data theft, data modification, and privilege escalation, which can have a significant impact on an organization's operations and reputation.

## Requirements

1. Access to the vulnerable application

1. Knowledge of the object references used by the application

## Defense

1. Implement proper access controls and authorization checks to ensure that users can only access the resources that they are authorized to access

1. Use unique identifiers that cannot be easily manipulated by attackers

1. Implement server-side validation of client-side input to prevent manipulation of object references

## Objectives

1. Access sensitive data or functionality

1. Modify data or functionality

1. Escalate privileges

# Instructions

1. To access sensitive data, an attacker can manipulate the invoice parameter in the URL to access invoices that they should not have access to.

**Code**: [[http://foo.bar/somepage?invoice=12345]]

> The vulnerable application uses the invoice parameter to retrieve an invoice from the server. By manipulating the invoice parameter, an attacker can access invoices that they should not have access to.

**Command** ([[Accessing URL]]):

```bash
http://foo.bar/somepage?invoice=12345
```

2. To modify data, an attacker can manipulate the user parameter in the URL to change the password of another user.

**Code**: [[http://foo.bar/changepassword?user=someuser]]

> The vulnerable application uses the user parameter to identify the user whose password is being changed. By manipulating the user parameter, an attacker can change the password of another user.

**Command** ([[Change Password]]):

```bash
user=someuser
```

3. To access file system resources, an attacker can manipulate the img parameter in the URL to access files that they should not have access to.

**Code**: [[http://foo.bar/showImage?img=img00011]]

> The vulnerable application uses the img parameter to retrieve an image from the server. By manipulating the img parameter, an attacker can access files that they should not have access to.

4. To access application functionality, an attacker can manipulate the menuitem parameter in the URL to access functionality that they should not have access to.

**Code**: [[http://foo.bar/accessPage?menuitem=12]]

> The vulnerable application uses the menuitem parameter to identify the functionality that the user is trying to access. By manipulating the menuitem parameter, an attacker can access functionality that they should not have access to.

## Commands Used

- [[Accessing URL]]
- [[Change Password]]

## Tags

- [[Exploit]]
- [[Insecure Direct Object References]]
