---
id: aa754c91-78f8-4bff-b8dc-9cb045061613
name: XSLT Injection - External Entity Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:41.478304+00:00'
updated_at: '2023-04-10T20:24:49.642741+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
techniques:
- '[[Brute Force|T1110 - Brute Force]]'
tags:
- '[[Exploit]]'
- '[[External Entity]]'
- '[[XSLT Injection]]'
---

# XSLT Injection - External Entity Exploitation

## Summary

XSLT Injection is a type of injection attack that targets XSLT (eXtensible Stylesheet Language Transformations) processors. This particular procedure focuses on exploiting external entities in XSLT. An external entity is a way of referencing content from an external source, which can be used to ret

## Description

# Description

XSLT Injection is a type of injection attack that targets XSLT (eXtensible Stylesheet Language Transformations) processors. This particular procedure focuses on exploiting external entities in XSLT. An external entity is a way of referencing content from an external source, which can be used to retrieve sensitive data or execute arbitrary code. By injecting malicious code into an external entity, an attacker can potentially gain access to sensitive data, or even take control of the target system.

Technical Explanation: An attacker can inject malicious code into an external entity and send it to the XSLT processor. The processor will then retrieve the content from the external source and process it as part of the transformation. This can allow the attacker to read files, execute code, or perform other malicious actions on the target system.

Business Value: An attacker can use XSLT Injection to gain access to sensitive data, such as customer information, financial data, or intellectual property. This can result in financial loss, reputational damage, or legal consequences for the targeted organization.

## Requirements

1. Access to an XSLT processor on the target system

1. Knowledge of the target system's file structure and configuration

## Defense

1. Use input validation and sanitization to prevent injection attacks

1. Disable external entity processing in the XSLT processor

1. Implement access controls to limit the exposure of sensitive data

## Objectives

1. Retrieve sensitive data from the target system

1. Execute arbitrary code on the target system

# Instructions

1. This command is used to inject an external entity in XML. It is done by adding a reference to an external file in the DOCTYPE declaration. In this example, the external file is located at C:\secretfruit.txt. This can be used to read sensitive information from the file system.

**Code**: [[<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE d]]

> The 'ext_file' entity is defined in the DOCTYPE declaration and its value is set to the content of the external file. When the XML is parsed, the entity reference is replaced with the content of the file. The content of the file is then displayed in the output. The 'xsl:for-each' loop is used to iterate over each 'fruit' element in the XML and display its 'name' and 'description' attributes.

## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]

### Techniques

- [[Brute Force|T1110 - Brute Force]]

## Tags

- [[Exploit]]
- [[External Entity]]
- [[XSLT Injection]]
