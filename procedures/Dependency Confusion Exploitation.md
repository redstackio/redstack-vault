---
id: 1d28ab7b-433c-47fd-9a2e-aab3629e54af
name: Dependency Confusion Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:57.701710+00:00'
updated_at: '2023-04-06T03:55:57.732135+00:00'
tags:
- '[[Dependency Confusion]]'
- '[[Exploit]]'
commands:
- '[[Install a gem]]'
- '[[Install a package]]'
- '[[Install package]]'
- '[[List installed gems]]'
- '[[Remove a package]]'
- '[[Uninstall a gem]]'
- '[[Update a package]]'
---

# Dependency Confusion Exploitation

## Summary

Dependency confusion is a type of software supply chain attack that exploits the naming conventions used in public and private package repositories. Attackers can create a package with the same name as a legitimate package, but with a higher version number, and upload it to a public repository. Whe

## Description

# Description

Dependency confusion is a type of software supply chain attack that exploits the naming conventions used in public and private package repositories. Attackers can create a package with the same name as a legitimate package, but with a higher version number, and upload it to a public repository. When a developer uses a package manager to install the package, it will unknowingly download the malicious package instead of the legitimate one. This can result in the attacker gaining access to sensitive information, executing remote code, or gaining a foothold in the target network.

This procedure details how to exploit dependency confusion by creating a malicious package and uploading it to a public repository. The attacker can then wait for a developer to unknowingly download and install the malicious package, giving the attacker access to the target system.

## Requirements

1. Access to a public package repository

1. Knowledge of the naming conventions used in the target's package manager

1. Ability to create a malicious package

## Defense

1. Developers should use package managers that verify package integrity and authenticity, such as those that use cryptographic hashes or digital signatures.

1. Organizations should implement policies and procedures for managing software dependencies, including regularly reviewing and updating dependencies, and monitoring for unusual package activity.

1. Developers should only install packages from trusted sources, and should verify the package name, version number, and checksum before installing.

## Objectives

1. To gain access to sensitive information

1. To execute remote code

1. To gain a foothold in the target network

# Instructions

1. 

**Code**: [[npm]]

> 

**Command** ([[Install a package]]):

```bash
npm install package-name
```

**Command** ([[Update a package]]):

```bash
npm update package-name
```

**Command** ([[Remove a package]]):

```bash
npm uninstall package-name
```

2. 

**Code**: [[pip]]

> 

**Command** ([[Install package]]):

```bash
pip install package_name
```

3. 

**Code**: [[gem]]

> 

**Command** ([[Install a gem]]):

```bash
gem install <gem-name>
```

**Command** ([[List installed gems]]):

```bash
gem list
```

**Command** ([[Uninstall a gem]]):

```bash
gem uninstall <gem-name>
```

## Commands Used

- [[Install a gem]]
- [[Install a package]]
- [[Install package]]
- [[List installed gems]]
- [[Remove a package]]
- [[Uninstall a gem]]
- [[Update a package]]

## Tags

- [[Dependency Confusion]]
- [[Exploit]]
