---
id: 6a88abdf-b012-4f08-82da-e34970325748
name: Zip Slip Basic Exploit - Unix Server Shell Upload
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:41.239967+00:00'
updated_at: '2023-04-06T03:56:41.255962+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Execution|TA0002 - Execution]]'
techniques:
- '[[Hide Artifacts|T1564 - Hide Artifacts]]'
- '[[XSL Script Processing|T1220 - XSL Script Processing]]'
sub_techniques:
- '[[Hidden File System|T1564.005 - Hidden File System]]'
- '[[Hidden Users|T1564.002 - Hidden Users]]'
- '[[Run Virtual Instance|T1564.006 - Run Virtual Instance]]'
tags:
- '[[Basic Exploit]]'
- '[[Exploits]]'
- '[[Zip Slip]]'
commands:
- '[[Create a PHP shell using evilarc.py]]'
---

# Zip Slip Basic Exploit - Unix Server Shell Upload

## Summary

Zip Slip is a form of directory traversal that can be exploited by attackers to write arbitrary files to the file system. This particular exploit involves creating a malicious shell payload and uploading it to a Unix server. Once the payload is uploaded, the attacker can execute arbitrary commands 

## Description

# Description

Zip Slip is a form of directory traversal that can be exploited by attackers to write arbitrary files to the file system. This particular exploit involves creating a malicious shell payload and uploading it to a Unix server. Once the payload is uploaded, the attacker can execute arbitrary commands on the target system, potentially gaining access to sensitive information or causing damage to the system. This exploit is commonly used in targeted attacks and can be difficult to detect once executed.

Technical Explanation: The attacker creates a specially crafted zip file containing a malicious payload. By exploiting a vulnerability in the unzip function, the attacker is able to write the payload to an arbitrary location on the file system. Once the payload is written, the attacker can execute it to gain access to the target system.

Business Value: This exploit can be used to gain access to sensitive information or cause damage to a target system, potentially resulting in financial loss or reputational damage for the victim organization.

## Requirements

1. Access to the target system

1. Ability to create a malicious shell payload

1. Knowledge of the target system's file system structure

## Defense

1. Implement input validation to prevent directory traversal attacks

1. Implement file system permissions to limit the ability of attackers to write to sensitive locations

1. Regularly monitor system logs for suspicious activity

## Objectives

1. Gain unauthorized access to a Unix server

1. Execute arbitrary commands on the target system

# Instructions

1. To create a malicious shell payload and upload it to a Unix server, use the evilarc tool with the following arguments:
- shell.php: the name of the shell payload file
- -o unix: the operating system of the target server
- -f shell.zip: the name of the archive file to create
- -p var/www/html/: the path to the directory on the server where the payload should be uploaded
- -d 15: the depth of the directory traversal when creating the payload

**Code**: [[python evilarc.py shell.php -o unix -f shell.zip -]]

> This command creates a malicious shell payload using the evilarc tool, which is a utility for creating archive files containing malicious payloads. The payload is created in the form of a PHP file named shell.php. The -o unix argument specifies that the payload should be compatible with Unix-based systems. The -f shell.zip argument specifies that the payload should be compressed into a ZIP archive file named shell.zip. The -p var/www/html/ argument specifies the path to the directory on the target server where the payload should be uploaded. Finally, the -d 15 argument specifies the depth of the directory traversal when creating the payload, which determines how many parent directories the payload should traverse before reaching the target directory.

**Command** ([[Create a PHP shell using evilarc.py]]):

```bash
python evilarc.py shell.php -o unix -f shell.zip -p var/www/html/ -d 15
```

## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Execution|TA0002 - Execution]]

### Techniques

- [[Hide Artifacts|T1564 - Hide Artifacts]]
- [[XSL Script Processing|T1220 - XSL Script Processing]]

### Sub-Techniques

- [[Hidden File System|T1564.005 - Hidden File System]]
- [[Hidden Users|T1564.002 - Hidden Users]]
- [[Run Virtual Instance|T1564.006 - Run Virtual Instance]]

## Commands Used

- [[Create a PHP shell using evilarc.py]]

## Tags

- [[Basic Exploit]]
- [[Exploits]]
- [[Zip Slip]]
