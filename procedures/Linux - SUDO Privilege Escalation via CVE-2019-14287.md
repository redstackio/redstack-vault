---
id: 79318886-21d6-4dc7-b4b6-eff0c1598a0f
name: Linux - SUDO Privilege Escalation via CVE-2019-14287
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:19.109587+00:00'
updated_at: '2023-04-10T20:34:24.040016+00:00'
tactics:
- '[[Privilege Escalation|TA0004 - Privilege Escalation]]'
techniques:
- '[[Exploitation for Privilege Escalation|T1068 - Exploitation for Privilege Escalation]]'
tags:
- '[[CVE-2019-14287]]'
- '[[Linux - Privilege Escalation]]'
- '[[SUDO]]'
---

# Linux - SUDO Privilege Escalation via CVE-2019-14287

## Summary

This procedure leverages CVE-2019-14287 to escalate privileges on a Linux system. This vulnerability allows an attacker to bypass sudo authentication and execute arbitrary commands as the root user. By specifying a user ID of -1 or 4294967295 in the sudo command, the system will allow the user to r

## Description

# Description

This procedure leverages CVE-2019-14287 to escalate privileges on a Linux system. This vulnerability allows an attacker to bypass sudo authentication and execute arbitrary commands as the root user. By specifying a user ID of -1 or 4294967295 in the sudo command, the system will allow the user to run commands as the root user without a password. This can be used to gain complete control of the system.

Technical Explanation: The sudo command is used to execute commands with the privileges of another user, typically the root user. However, this vulnerability allows an attacker to specify a user ID of -1 or 4294967295, which is interpreted as an unsigned integer and results in the system allowing the user to execute commands as the root user without a password.

Business Value: This procedure can be used by an attacker to gain complete control of a Linux system, allowing them to steal sensitive data, install malware, or use the system as a pivot point for further attacks.

## Requirements

1. Access to a vulnerable Linux system

1. Ability to execute commands as a non-root user

## Defense

1. Ensure that all sudo commands are properly configured and do not allow user IDs of -1 or 4294967295

1. Regularly update and patch Linux systems to prevent known vulnerabilities

1. Implement least privilege access controls to limit the impact of privilege escalation attacks

## Objectives

1. Escalate privileges on a Linux system

1. Execute arbitrary commands as the root user

# Instructions

1. This exploit can be used when a user has the following permissions: (sudo -l)
(ALL, !root) ALL. If you have a full TTY, you can exploit it like this: sudo -u#-1 /bin/bash and then sudo -u#4294967295 id.

**Code**: [[# Exploitable when a user have the following permi]]

> The exploit takes advantage of a vulnerability in the sudo command that allows users with certain permissions to execute arbitrary commands as other users. The exploit works by impersonating the UID of the target user, which can be achieved by using the sudo -u#-1 command. Once the impersonation is successful, the attacker can execute any command as the target user by specifying their UID with the sudo -u#<UID> command. In this case, the attacker is executing the id command as the target user with UID 4294967295.

## MITRE ATT&CK Mapping

### Tactics

- [[Privilege Escalation|TA0004 - Privilege Escalation]]

### Techniques

- [[Exploitation for Privilege Escalation|T1068 - Exploitation for Privilege Escalation]]

## Tags

- [[CVE-2019-14287]]
- [[Linux - Privilege Escalation]]
- [[SUDO]]
