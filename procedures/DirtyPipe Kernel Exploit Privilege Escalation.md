---
id: 20bbcd45-e293-430f-bbc8-c11de48d821b
name: DirtyPipe Kernel Exploit Privilege Escalation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:19.633818+00:00'
updated_at: '2023-04-10T20:34:21.639131+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Privilege Escalation|TA0004 - Privilege Escalation]]'
techniques:
- '[[Exploitation for Privilege Escalation|T1068 - Exploitation for Privilege Escalation]]'
- '[[Process Injection|T1055 - Process Injection]]'
tags:
- '[[CVE-2022-0847 (DirtyPipe)]]'
- '[[Kernel Exploits]]'
- '[[Linux - Privilege Escalation]]'
commands:
- '[[Run exploit.py]]'
---

# DirtyPipe Kernel Exploit Privilege Escalation

## Summary

DirtyPipe is a Linux kernel exploit that can be used to escalate privileges from a local user to root. The exploit takes advantage of a vulnerability in the kernel's implementation of the Dirty COW race condition. This exploit allows an attacker to write to read-only memory and gain root privileges

## Description

# Description

DirtyPipe is a Linux kernel exploit that can be used to escalate privileges from a local user to root. The exploit takes advantage of a vulnerability in the kernel's implementation of the Dirty COW race condition. This exploit allows an attacker to write to read-only memory and gain root privileges. The technical explanation involves the exploitation of a race condition in the copy-on-write mechanism of the Linux kernel. This vulnerability can be used to modify read-only memory mappings and execute arbitrary code with root privileges. The business value of this exploit is that it allows an attacker to gain full control over the compromised system, potentially leading to the theft of sensitive data or the installation of additional malware.

 

## Requirements

1. Local access to the targeted system

1. Ability to execute the DirtyPipe exploit

 

## Defense

1. Apply kernel patches and updates to mitigate the vulnerability

1. Implement strict access controls and privilege separation to limit the impact of a successful exploit

1. Monitor system logs and network traffic for signs of compromise

 

## Objectives

1. Escalate privileges from a local user to root

1. Gain full control over the compromised system

 

# Instructions

1. This exploit is used to escalate privileges on a Linux operating system running kernel version 5.8 through 5.16.11. It takes advantage of a vulnerability in the kernel to gain root privileges. To use this exploit, the attacker must have access to the target system and be able to execute the exploit code. Once executed, the exploit will elevate the attacker's privileges to root, giving them complete control over the system.

 



**Code**: [[https://www.exploit-db.com/exploits/50808]]



> The exploit works by exploiting a vulnerability in the Linux kernel that allows an attacker to gain elevated privileges. Specifically, the exploit targets a flaw in the kernel's handling of user namespaces. By creating a new user namespace and setting the ID mapping to include the root user, the exploit is able to gain root privileges. The exploit code is typically written in C and compiled into an executable file. Once the exploit is executed, the attacker will have full control over the target system and can perform any action that a root user can perform.



**Command** ([[Run exploit.py]]):

```bash
python3 exploit.py
```



## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Privilege Escalation|TA0004 - Privilege Escalation]]

### Techniques

- [[Exploitation for Privilege Escalation|T1068 - Exploitation for Privilege Escalation]]
- [[Process Injection|T1055 - Process Injection]]

## Commands Used

- [[Run exploit.py]]

## Tags

- [[CVE-2022-0847 (DirtyPipe)]]
- [[Kernel Exploits]]
- [[Linux - Privilege Escalation]]


