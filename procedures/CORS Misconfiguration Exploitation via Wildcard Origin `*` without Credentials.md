---
id: 5fea919f-a5ce-4772-9f22-0bdb765b01f9
name: CORS Misconfiguration Exploitation via Wildcard Origin `*` without Credentials
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:55.844982+00:00'
updated_at: '2023-04-10T20:21:22.621250+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
- '[[Execution|TA0002 - Execution]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Command-Line Interface|T1059 - Command-Line Interface]]'
- '[[Exploitation for Credential Access|T1212 - Exploitation for Credential Access]]'
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
sub_techniques:
- '[[Windows Command Shell|T1059.003 - Windows Command Shell]]'
tags:
- '[[CORS Misconfiguration]]'
- '[[Exploitation]]'
- '[[Vulnerable Example: Wildcard Origin `*` without Credentials]]'
- '[[Vulnerable Implementation]]'
commands:
- '[[HTTP GET to /endpoint]]'
---

# CORS Misconfiguration Exploitation via Wildcard Origin `*` without Credentials

## Summary

A Cross-Origin Resource Sharing (CORS) misconfiguration vulnerability can occur when a server improperly allows cross-origin requests. Attackers can exploit this vulnerability to bypass the same-origin policy and access sensitive data from the victim's web application. In this specific example, the

## Description

# Description

A Cross-Origin Resource Sharing (CORS) misconfiguration vulnerability can occur when a server improperly allows cross-origin requests. Attackers can exploit this vulnerability to bypass the same-origin policy and access sensitive data from the victim's web application. In this specific example, the server allows requests from any origin without requiring credentials, using a wildcard `*` value. This means that attackers can craft malicious requests from any domain and access sensitive data from the victim's web application. This vulnerability can be used to steal sensitive data such as API keys, session tokens, and other confidential information.

## Requirements

1. Access to the vulnerable web application

1. Ability to craft and send HTTP requests

## Defense

1. Configure the `Access-Control-Allow-Origin` header to only allow requests from trusted domains.

1. Require credentials for cross-origin requests to prevent unauthorized access.

1. Regularly scan web applications for CORS misconfigurations and vulnerabilities.

## Objectives

1. Steal sensitive data such as API keys, session tokens, and other confidential information.

# Instructions

1. Craft a malicious HTTP request with the victim's web application endpoint and a wildcard `*` value for the `Access-Control-Allow-Origin` header.,Include the `Origin` header in the request with a malicious domain controlled by the attacker.,Send the request to the victim's web application.,The server will respond with sensitive data, including API keys or session tokens, in the response body, which can be collected by the attacker.

**Code**: [[GET /endpoint HTTP/1.1
Host: api.internal.example.]]

> ['The `Access-Control-Allow-Origin` header specifies which domains are allowed to make cross-origin requests to the server. By using a wildcard `*` value, the server allows requests from any domain.', 'The `Origin` header specifies the domain from which the request originated. By including a malicious domain controlled by the attacker, the server will allow the request and respond with sensitive data.', "The attacker can then collect the sensitive data from the response body and use it to gain further access to the victim's web application."]

**Command** ([[HTTP GET to /endpoint]]):

```bash
GET /endpoint HTTP/1.1
Host: api.internal.example.com
Origin: https://evil.com

```

## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]
- [[Execution|TA0002 - Execution]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Command-Line Interface|T1059 - Command-Line Interface]]
- [[Exploitation for Credential Access|T1212 - Exploitation for Credential Access]]
- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]

### Sub-Techniques

- [[Windows Command Shell|T1059.003 - Windows Command Shell]]

## Commands Used

- [[HTTP GET to /endpoint]]

## Tags

- [[CORS Misconfiguration]]
- [[Exploitation]]
- [[Vulnerable Example: Wildcard Origin `*` without Credentials]]
- [[Vulnerable Implementation]]
