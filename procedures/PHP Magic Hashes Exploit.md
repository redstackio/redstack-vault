---
id: 2893814a-ab00-4138-844a-8c31bd64a09d
name: PHP Magic Hashes Exploit
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:40.756437+00:00'
updated_at: '2023-04-06T03:56:40.769258+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
techniques:
- '[[Exploitation for Credential Access|T1212 - Exploitation for Credential Access]]'
- '[[Exploitation for Defense Evasion|T1211 - Exploitation for Defense Evasion]]'
tags:
- '[[Magic Hashes - Exploit]]'
- '[[PHP Juggling type and magic hashes]]'
---

# PHP Magic Hashes Exploit

## Summary

The PHP Magic Hashes Exploit is a technique that takes advantage of the PHP type juggling vulnerability to bypass hash comparison checks. This attack is often used to gain unauthorized access to a system or application by exploiting weak password hashes. The attacker creates a specially crafted has

## Description

# Description

The PHP Magic Hashes Exploit is a technique that takes advantage of the PHP type juggling vulnerability to bypass hash comparison checks. This attack is often used to gain unauthorized access to a system or application by exploiting weak password hashes. The attacker creates a specially crafted hash that matches the target hash, but with a different value. By using this technique, the attacker can bypass authentication and gain access to the system or application. This technique is particularly effective against systems that use PHP for password hashing and comparison.

## Requirements

1. Access to the target system or application

1. Knowledge of the target system or application's password hashing methods

## Defense

1. Use strong password policies and hashing methods to make it harder to create matching hashes

1. Implement multi-factor authentication to reduce the impact of compromised passwords

1. Regularly monitor system logs for suspicious activity

## Objectives

1. Gain unauthorized access to a system or application

1. Bypass authentication

1. Obtain sensitive information

# Instructions

1. The code above demonstrates the Hash Comparison Vulnerability in PHP. This vulnerability occurs when PHP treats hashes starting with "0e" as a float. It is exploited by attackers to bypass security measures that rely on hash comparison. To avoid this vulnerability, avoid using weak hashing algorithms and use a strong salt when hashing passwords.

**Code**: [[<?php
var_dump(md5('240610708') == md5('QNKCDZO'))]]

> The code above contains PHP code that demonstrates the Hash Comparison Vulnerability. The code compares two hashes using the == operator, which can lead to unexpected results. In the case of the first comparison, the hashes are different but PHP treats them as equal because they both start with "0e" followed by numbers. This vulnerability can be exploited by attackers to bypass security measures that rely on hash comparison, such as password verification. To avoid this vulnerability, it is important to use strong hashing algorithms and a strong salt when hashing passwords.

## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]
- [[Defense Evasion|TA0005 - Defense Evasion]]

### Techniques

- [[Exploitation for Credential Access|T1212 - Exploitation for Credential Access]]
- [[Exploitation for Defense Evasion|T1211 - Exploitation for Defense Evasion]]

## Tags

- [[Magic Hashes - Exploit]]
- [[PHP Juggling type and magic hashes]]
