---
id: 765490cb-c2ea-48da-af1f-c50f79d8b332
name: GraphQL Injection for NOSQL Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:58.930871+00:00'
updated_at: '2023-04-10T20:22:23.998933+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Execution|TA0002 - Execution]]'
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]'
- '[[XSL Script Processing|T1220 - XSL Script Processing]]'
tags:
- '[[Exploit]]'
- '[[GraphQL Injection]]'
- '[[NOSQL injection]]'
commands:
- '[[Search for term ''apple'' in fruits.txt]]'
---

# GraphQL Injection for NOSQL Exploitation

## Summary

GraphQL Injection is an attack technique that exploits vulnerabilities in GraphQL endpoints to perform unauthorized operations. In this scenario, the attacker uses a NOSQL injection technique to exploit the GraphQL endpoint. The attacker sends a malicious query to the GraphQL endpoint that includes

## Description

# Description

GraphQL Injection is an attack technique that exploits vulnerabilities in GraphQL endpoints to perform unauthorized operations. In this scenario, the attacker uses a NOSQL injection technique to exploit the GraphQL endpoint. The attacker sends a malicious query to the GraphQL endpoint that includes a crafted search parameter with a regular expression ($regex) and not equal ($ne) operator. The query returns data that should not be accessible, including patient SSNs. This technique can lead to the disclosure of sensitive information and unauthorized access to the system.

Technical Explanation: The attacker sends a malicious query to the GraphQL endpoint that includes a crafted search parameter with a regular expression ($regex) and not equal ($ne) operator. The query returns data that should not be accessible, including patient SSNs. This technique can lead to the disclosure of sensitive information and unauthorized access to the system.

Business Value: This technique can lead to the disclosure of sensitive information, including patient SSNs, which can be used for identity theft, fraud, and other malicious purposes. It can also lead to unauthorized access to the system, which can result in data breaches and legal liabilities.

 

## Requirements

1. Access to a vulnerable GraphQL endpoint

1. Knowledge of NOSQL injection techniques

 

## Defense

1. Implement input validation and sanitization to prevent injection attacks

1. Use parameterized queries to prevent injection attacks

1. Implement access control mechanisms to restrict access to sensitive data

 

## Objectives

1. To exploit the GraphQL endpoint using NOSQL injection technique

1. To gain unauthorized access to sensitive data including patient SSNs

 

# Instructions

1. 

 



**Code**: [[$regex]]



> The $regex operator is used to search for a regular expression in the data. In this scenario, the attacker crafts a search parameter that includes a regular expression that matches any character and returns all data that should not be accessible.

2. 

 



**Code**: [[$ne]]



> The $ne operator is used to exclude specific data from the search results. In this scenario, the attacker crafts a search parameter that excludes the data that should be accessible and returns only the data that should not be accessible.

3. 

 



**Code**: [[search]]



> The attacker crafts a search parameter that includes a regular expression and not equal operator to search for data that should not be accessible. The search parameter is sent to the GraphQL endpoint to retrieve the data.



**Command** ([[Search for term 'apple' in fruits.txt]]):

```bash
search 'apple' fruits.txt
```



4. 

 



**Code**: [[{
  doctors(
    options: "{\"limit\": 1, \"patien]]



> The attacker sends a GraphQL query to the endpoint that includes the crafted search parameter. The query returns data that should not be accessible, including patient SSNs.

## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Execution|TA0002 - Execution]]
- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]
- [[XSL Script Processing|T1220 - XSL Script Processing]]

## Commands Used

- [[Search for term 'apple' in fruits.txt]]

## Tags

- [[Exploit]]
- [[GraphQL Injection]]
- [[NOSQL injection]]


