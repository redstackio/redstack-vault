---
id: bbce42f7-0ae2-428b-ba07-e57333c8454b
name: Identifying and Exploiting XSS Vulnerabilities
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:41.767881+00:00'
updated_at: '2023-04-10T20:21:31.214064+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Execution|TA0002 - Execution]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
- '[[Scripting|T1064 - Scripting]]'
tags:
- '[[Cross Site Scripting]]'
- '[[Identify an XSS endpoint]]'
commands:
- '[[Display alert message]]'
- '[[Display Window Origin]]'
- '[[Print to console]]'
---

# Identifying and Exploiting XSS Vulnerabilities

## Summary

Cross-Site Scripting (XSS) is a type of security vulnerability that allows an attacker to inject malicious code into a web page viewed by other users. This can be used to steal sensitive information, such as login credentials or personal data. By identifying an XSS endpoint, an attacker can inject 

## Description

# Description

Cross-Site Scripting (XSS) is a type of security vulnerability that allows an attacker to inject malicious code into a web page viewed by other users. This can be used to steal sensitive information, such as login credentials or personal data. By identifying an XSS endpoint, an attacker can inject their own code into the vulnerable page and execute it in the context of the victim's browser. This can be used to perform actions on behalf of the victim, such as sending requests or stealing cookies.

To identify an XSS endpoint, an attacker can use various payloads and techniques to inject code into the page and observe the response. Once an endpoint is identified, the attacker can then use it to inject their own payloads and execute code in the victim's browser.

 

## Requirements

1. Access to the target website

1. Knowledge of XSS payloads and techniques

 

## Defense

1. Ensure that all user input is properly sanitized and validated to prevent XSS vulnerabilities

1. Implement Content Security Policy (CSP) to restrict the sources of content that can be loaded on a web page

1. Regularly scan web applications for vulnerabilities and apply security patches as needed

 

## Objectives

1. Identify an XSS endpoint on the target website

1. Inject and execute malicious code in the victim's browser

1. Steal sensitive information or perform actions on behalf of the victim

 

# Instructions

1. Use the payloads listed in the provided link to test for XSS vulnerabilities in web applications.

 



**Code**: [[<script>debugger;</script>]]



> This command provides a list of XSS payloads that can be used to test web applications for vulnerabilities. The payloads can be used to test input fields, URL parameters, and other areas where user input is accepted. The provided link contains a variety of payloads that can be used to test different types of XSS vulnerabilities. It is important to note that testing for vulnerabilities should only be done on applications that you have permission to test on.

2. Use the Domain Alert command to display the domain of the current web page in an alert box.

 



**Code**: [[alert(document.domain)]]



> This command is useful for quickly identifying the domain of the current web page. The alert box will display the domain name in plain text. No arguments are required for this command.

3. To execute this command, simply copy and paste the provided code into your browser console and press enter.

 



**Code**: [[alert(window.origin)]]



> This command will display an alert message with the origin of the current window. The origin is the combination of the protocol, hostname, and port number of the current URL. This can be useful for debugging purposes or for verifying that the current window is communicating with the expected origin.



**Command** ([[Display Window Origin]]):

```bash
alert(window.origin)
```



4. Use this command to display a pop-up alert box with the message '1' when the code is executed.

 



**Code**: [[alert(1)]]



> The 'alert()' method is a built-in JavaScript function that displays a pop-up alert box with the specified message. The message can be a string, a number, or any other valid JavaScript expression. In this case, the message is the number '1'. This command can be used for debugging purposes or to display important information to the user.

5. To perform an XSS attack, an attacker injects malicious code into a web page viewed by other users. The code can be in the form of a script, HTML or other types of code that can be executed by the browser. This can be done by inputting the code into a form field or query parameter that is not properly sanitized by the server.

 



**Code**: [[&lt;script&gt;alert(1)&lt;/script&gt;]]



> The 'data' field contains the malicious code that will be injected into the web page. It is important to replace this payload with a more sophisticated one that can bypass filters and evade detection. The 'text' field can be used to provide a description of the payload or to suggest alternative payloads. The 'instruction' field provides guidance on how to perform an XSS attack, while the 'explain' field provides additional information on the attack and its impact.

6. The 'data' field contains a malicious script that can be injected into a vulnerable web page. When the page is loaded, the script executes and can steal sensitive information or perform other malicious actions.

 



**Code**: [[<script>alert(document.domain.concat("\n").concat(]]



> This type of attack exploits a vulnerability in a web page that allows an attacker to inject malicious code, such as JavaScript, into the page. This code is then executed by the victim's browser, allowing the attacker to steal sensitive information or perform other malicious actions. To prevent XSS attacks, web developers should sanitize all user input and encode output to prevent malicious scripts from being executed.

7. To display an alert box with a message, use the following syntax: alert('message');

 



**Code**: [[alert()]]



> The 'alert()' method is used to display an alert box with a message to the user. The message can be any text or variable value. This method is often used for debugging purposes or to display important information to the user. The alert box contains an OK button and the user can dismiss it by clicking on the OK button.



**Command** ([[Display alert message]]):

```bash
alert()
```



8. To use console.log() for reflected XSS, simply insert the payload into the input field and check the console for the output.

 



**Code**: [[console.log()]]



> The console.log() function is used to output data to the browser console. It can be used to test for reflected XSS vulnerabilities by inserting a payload into an input field and checking the console for the output. However, for stored XSS, console.log() can become a burden as it requires the user to close the popup for each execution.



**Command** ([[Print to console]]):

```bash
console.log()
```



9. Inject the provided script into the search bar of page XYZ.

 



**Code**: [[<script>console.log("Test XSS from the search bar ]]



> This command demonstrates how an attacker can inject malicious code into a website's search bar, potentially gaining access to sensitive information or executing unauthorized actions on behalf of the user. The script provided logs information about the current domain and origin to the console, but an attacker could modify it to perform more harmful actions.

## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Execution|TA0002 - Execution]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]
- [[Scripting|T1064 - Scripting]]

## Commands Used

- [[Display alert message]]
- [[Display Window Origin]]
- [[Print to console]]

## Tags

- [[Cross Site Scripting]]
- [[Identify an XSS endpoint]]


