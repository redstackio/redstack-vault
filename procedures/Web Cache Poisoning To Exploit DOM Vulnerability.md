---
id: 07fc8a9f-faba-41af-bbe7-977006d30d78
name: Web Cache Poisoning To Exploit DOM Vulnerability
type: procedure
verified: true
submitted: true
created_at: '2020-08-20T07:17:21.938637+00:00'
updated_at: '2023-05-26T01:13:43.409372+00:00'
platforms:
- Web
tags:
- '[[DOM XSS]]'
- '[[Web Applications]]'
- '[[web cache posioning]]'
---

# Web Cache Poisoning To Exploit DOM Vulnerability

**Status**: âœ“ Verified

## Summary

Web cache posioning can be exploited by an attacker to perform DOM XSS that can be used to steal victim's sensitive information. 

## Description

# Description

Web cache posioning can be exploited by an attacker to perform DOM XSS that can be used to steal victim's sensitive information.

# Instructions

1.With Burp running , browse the application . Under *site map* , all requests and responses can be seen. With Param miner installed from BApp tab, identify the secret/hidden parameter . In this case it is *x-forwarded-host. *

2.Identify the GET request of the home page of the application and send the request to *repeater* tab 

3. Add a cache buster to the url from step 2 and also add* x-forarded-host *to the request.

4.Send the modified request to the server and observe that value of x-forwarded-host is reflected in the response. Also it can be observed that the host variable in the response body is vulnerable to DOM XSS.

5. Craft a exploit with JSON object that matches the data object in the response from step 4

{
"country": "<img src=1 onerror=alert(document.cookie) />"
}

Also add the header *Access-Control-Allow-Origin: ** to enable CORS 

6.Modify the request from step 4 to change the *x-forwarded-host :* value to the exploit url generated in step5. Keep sending the request to the server until* x-cache:hit* and the exploit url is observed in the response body.

7. Copy the url from step 6 and open the url in the browser . Replay this request until the cache is poisoned and the victim visits the site.

## Platforms

- Web

## Tags

- [[DOM XSS]]
- [[Web Applications]]
- [[web cache posioning]]
