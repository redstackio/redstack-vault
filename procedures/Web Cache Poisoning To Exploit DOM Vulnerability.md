---
id: 07fc8a9f-faba-41af-bbe7-977006d30d78
name: Web Cache Poisoning To Exploit DOM Vulnerability
type: procedure
verified: true
submitted: true
created_at: '2020-08-20T07:17:21.938637+00:00'
updated_at: '2023-05-26T01:13:43.409372+00:00'
platforms:
- Web
tags:
- '[[DOM XSS]]'
- '[[Web Applications]]'
- '[[web cache posioning]]'
---

# Web Cache Poisoning To Exploit DOM Vulnerability

**Status**: âœ“ Verified

## Summary

Web cache posioning can be exploited by an attacker to perform DOM XSS that can be used to steal victim's sensitive information. 

## Description

# Description

Web cache posioning can be exploited by an attacker to perform DOM XSS that can be used to steal victim's sensitive information.

# Instructions



1.With Burp running , browse the application . Under *site map* , all requests and responses can be seen. With Param miner installed from BApp tab, identify the secret/hidden parameter . In this case it is *x-forwarded-host. *





![504dda07-5f46-4b42-bd83-c2ecce971386.png](_assets/images/Mash/504dda07-5f46-4b42-bd83-c2ecce971386.png)







2.Identify the GET request of the home page of the application and send the request to *repeater* tab 







![30e26ff8-c3ee-41fc-af06-e5922349a9e5.png](_assets/images/Mash/30e26ff8-c3ee-41fc-af06-e5922349a9e5.png)





3. Add a cache buster to the url from step 2 and also add* x-forarded-host *to the request.





![8e01096e-fb65-4fa0-99c3-0c74cecf97df.png](_assets/images/Mash/8e01096e-fb65-4fa0-99c3-0c74cecf97df.png)





4.Send the modified request to the server and observe that value of x-forwarded-host is reflected in the response. Also it can be observed that the host variable in the response body is vulnerable to DOM XSS.







![2ad36d48-c836-4d15-9ba7-55dedfff743d.png](_assets/images/Mash/2ad36d48-c836-4d15-9ba7-55dedfff743d.png)





5. Craft a exploit with JSON object that matches the data object in the response from step 4

{
"country": "<img src=1 onerror=alert(document.cookie) />"
}



Also add the header *Access-Control-Allow-Origin: ** to enable CORS 



![e8894a4e-0755-4d33-9d9f-b36857535563.png](_assets/images/Mash/e8894a4e-0755-4d33-9d9f-b36857535563.png)







6.Modify the request from step 4 to change the *x-forwarded-host :* value to the exploit url generated in step5. Keep sending the request to the server until* x-cache:hit* and the exploit url is observed in the response body.







![b9f2203f-50c0-4b59-9187-e2ff53c36a82.png](_assets/images/Mash/b9f2203f-50c0-4b59-9187-e2ff53c36a82.png)







7. Copy the url from step 6 and open the url in the browser . Replay this request until the cache is poisoned and the victim visits the site.





![ca8874be-30f2-4594-9a3f-bb5f4f8f1e41.png]()









## Platforms

- Web

## Tags

- [[DOM XSS]]
- [[Web Applications]]
- [[web cache posioning]]


