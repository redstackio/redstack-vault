---
id: 050c1647-2da7-45bb-b8b0-8e3d01c1daca
name: LFI to RCE via Apache and Nginx Log Files
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:58.551110+00:00'
updated_at: '2023-04-10T20:22:19.406206+00:00'
tactics:
- '[[Command and Control|TA0011 - Command and Control]]'
- '[[Execution|TA0002 - Execution]]'
- '[[Initial Access|TA0001 - Initial Access]]'
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Command-Line Interface|T1059 - Command-Line Interface]]'
- '[[Connection Proxy|T1090 - Connection Proxy]]'
- '[[Exploitation for Client Execution|T1203 - Exploitation for Client Execution]]'
- '[[Replication Through Removable Media|T1091 - Replication Through Removable Media]]'
tags:
- '[[File Inclusion]]'
- '[[LFI to RCE via controlled log file]]'
---

# LFI to RCE via Apache and Nginx Log Files

## Summary

LFI (Local File Inclusion) is a vulnerability that allows an attacker to read files on a server. In this attack scenario, the attacker uses LFI to read log files generated by Apache and Nginx web servers. The attacker then injects PHP code into the log files, which is executed when the log files ar

## Description

# Description

LFI (Local File Inclusion) is a vulnerability that allows an attacker to read files on a server. In this attack scenario, the attacker uses LFI to read log files generated by Apache and Nginx web servers. The attacker then injects PHP code into the log files, which is executed when the log files are read by the web server. This allows the attacker to execute arbitrary code on the server, which can be used to gain further access to the system.

This technique can be used to bypass server-side input validation mechanisms and execute arbitrary code on the target system. This attack can be used to gain access to sensitive information or to gain a foothold on the target system. This technique is commonly used by attackers to escalate their privileges and gain access to sensitive information.

## Requirements

1. Access to a vulnerable web application

## Defense

1. Ensure that web applications are properly configured and do not allow for LFI vulnerabilities

1. Monitor log files for unexpected PHP code or other suspicious activity

1. Implement access controls to limit the ability of attackers to execute arbitrary code on the target system

## Objectives

1. Read log files on the target system

1. Execute arbitrary code on the target system

# Instructions

1. 

**Code**: [[http://example.com/index.php?page=/var/log/apache/]]

> The attacker can use the LFI vulnerability to read log files on the target system. Once the attacker has access to the log files, they can inject PHP code into the log files. When the log files are read by the web server, the injected PHP code is executed, allowing the attacker to execute arbitrary code on the target system. The attacker can then use this access to escalate their privileges and gain further access to the system.

## MITRE ATT&CK Mapping

### Tactics

- [[Command and Control|TA0011 - Command and Control]]
- [[Execution|TA0002 - Execution]]
- [[Initial Access|TA0001 - Initial Access]]
- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Command-Line Interface|T1059 - Command-Line Interface]]
- [[Connection Proxy|T1090 - Connection Proxy]]
- [[Exploitation for Client Execution|T1203 - Exploitation for Client Execution]]
- [[Replication Through Removable Media|T1091 - Replication Through Removable Media]]

## Tags

- [[File Inclusion]]
- [[LFI to RCE via controlled log file]]
