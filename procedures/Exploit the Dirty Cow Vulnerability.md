---
id: c61c6388-7116-4002-9e3e-cb82dd044219
name: Exploit the Dirty Cow Vulnerability
type: procedure
verified: false
submitted: false
created_at: '2019-10-11T01:04:39.812550+00:00'
updated_at: '2023-05-29T16:48:53.253841+00:00'
tactics:
- '[[Privilege Escalation|TA0004 - Privilege Escalation]]'
techniques:
- '[[Exploitation for Privilege Escalation|T1068 - Exploitation for Privilege Escalation]]'
platforms:
- Linux
tags:
- '[[Kernel Exploit]]'
- '[[known vulnerability]]'
commands:
- '[[gcc Build a Program with pthread and libcrypt]]'
---

# Exploit the Dirty Cow Vulnerability

## Summary

Dirty Cow is a copy-on-write (COW) vulnerability for the Linux kernel, affecting versions 2.6.22 to 4.83, 4.7.9, and 4.4.26,. This ranges from September 2007 to November 2017, making it extremely common in systems that haven't been patched. 

## Description

# Description

Dirty Cow is a copy-on-write (COW) vulnerability for the Linux kernel, affecting versions 2.6.22 to 4.83, 4.7.9, and 4.4.26,. This ranges from September 2007 to November 2017, making it extremely common in systems that haven't been patched.



# Instructions

1. Install gcc and build tools using a package manager. On Debian/Ubuntu:





**Code**: [[apt update
apt install build-essentials -y]]





Download the source: [Dirty Cow POC](https://raw.githubusercontent.com/FireFart/dirtycow/master/dirty.c)



2. Build the Dirty Cow exploit using pthread and lcrypt, as specified in the source





**Command** ([[gcc Build a Program with pthread and libcrypt]]):

```bash
gcc $_INPUT.c -pthread -lcrypt -o $_OUTPUT
```





Note: If building on a separate machine, be sure to match the architecture of the target. This means if building on a x64 machine for a x32 target, the exploit must be compiled with the `-m32` flag.



## Run the Exploit

Once built, run the exploit on the target, enter a password, then wait for the program to finish. On completion, the root user will be replaced with firefart, whose password you set when initially running the exploit. Follow the post installation instructions to replace the modified `/etc/passwd` file, or else the system may crash after a short period.



![fc933144-e86c-4b35-a6f2-d65ac0bb2035.png](_assets/images/Mark/fc933144-e86c-4b35-a6f2-d65ac0bb2035.png)



## Platforms

- Linux

## MITRE ATT&CK Mapping

### Tactics

- [[Privilege Escalation|TA0004 - Privilege Escalation]]

### Techniques

- [[Exploitation for Privilege Escalation|T1068 - Exploitation for Privilege Escalation]]

## Commands Used

- [[gcc Build a Program with pthread and libcrypt]]

## Tags

- [[Kernel Exploit]]
- [[known vulnerability]]


