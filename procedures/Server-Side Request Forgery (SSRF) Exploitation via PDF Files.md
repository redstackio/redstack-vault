---
id: 2c2beb97-87c1-448a-9e8a-72bda5051538
name: Server-Side Request Forgery (SSRF) Exploitation via PDF Files
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:38.082785+00:00'
updated_at: '2023-04-10T20:24:10.890757+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Execution|TA0002 - Execution]]'
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Credentials in Registry|T1214 - Credentials in Registry]]'
- '[[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]'
- '[[Scripting|T1064 - Scripting]]'
tags:
- '[[Server-Side Request Forgery]]'
- '[[SSRF Exploiting PDF File]]'
---

# Server-Side Request Forgery (SSRF) Exploitation via PDF Files

## Summary

Server-Side Request Forgery (SSRF) is a vulnerability that allows an attacker to send crafted requests from a vulnerable web application. This vulnerability can be exploited to access internal systems or services that are not intended to be exposed to the public. In this procedure, an attacker can 

## Description

# Description

Server-Side Request Forgery (SSRF) is a vulnerability that allows an attacker to send crafted requests from a vulnerable web application. This vulnerability can be exploited to access internal systems or services that are not intended to be exposed to the public. In this procedure, an attacker can exploit an SSRF vulnerability via a PDF file to retrieve a secret or password file from the server. The attacker can use PhantomJS to execute JavaScript code in the PDF file and make requests to internal services or systems that are not intended to be exposed to the public. 

This procedure can be used by an attacker to gain access to sensitive information that can be used for further attacks or to gain unauthorized access to internal systems or services. The technical explanation of this procedure involves exploiting an SSRF vulnerability via a PDF file by executing JavaScript code that sends HTTP requests to internal systems or services. The business value of this procedure is that it can be used to gain access to sensitive information that can be used to compromise the integrity of the organization or to gain unauthorized access to internal systems or services.

 

## Requirements

1. Access to a web application with an SSRF vulnerability

1. Ability to upload a PDF file to the web application

1. Ability to execute JavaScript code in a PDF file

1. Knowledge of internal systems or services that are not intended to be exposed to the public

 

## Defense

1. Implement input validation and sanitization to prevent SSRF vulnerabilities

1. Use a Web Application Firewall (WAF) to block requests to internal systems or services

1. Limit access to sensitive information and systems to authorized personnel only

 

## Objectives

1. Retrieve secret file from the server

1. Retrieve password file using PhantomJS

 

# Instructions

1. Use SSRF to retrieve the secret file from the server

 



**Code**: [[<link rel=attachment href="file:///root/secret.txt]]



> This command uses SSRF (Server Side Request Forgery) vulnerability to retrieve a secret file from the server. The 'data' field contains the link to the file that needs to be retrieved. The 'lang' field specifies the programming language to be used, which in this case is PowerShell. The 'text' field contains the image that is displayed when the command is executed. The 'instruction' field provides a brief instruction on how to use the command. The 'explain' field provides a detailed explanation of how the command works and what arguments it takes.

2. To retrieve the password file using PhantomJS, run the following script in the console:

 



**Code**: [[<script>
    exfil = new XMLHttpRequest();
    exf]]



> This script creates a new XMLHttpRequest object and uses it to send a GET request to the file located at /etc/passwd. If the request is successful, the response text (which should contain the contents of the password file) is written to the document. If the request fails, the text 'failed!' is written to the document instead.

## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]
- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Execution|TA0002 - Execution]]
- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Credentials in Registry|T1214 - Credentials in Registry]]
- [[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]
- [[Scripting|T1064 - Scripting]]

## Tags

- [[Server-Side Request Forgery]]
- [[SSRF Exploiting PDF File]]


