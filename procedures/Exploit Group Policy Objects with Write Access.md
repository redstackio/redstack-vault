---
id: 2c75c799-a75b-4c81-a74e-000589988d59
name: Exploit Group Policy Objects with Write Access
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:03.627070+00:00'
updated_at: '2023-04-10T20:25:53.400284+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Privilege Escalation|TA0004 - Privilege Escalation]]'
techniques:
- '[[Group Policy Modification|T1484 - Group Policy Modification]]'
tags:
- '[[Active Directory Attacks]]'
- '[[Exploit Group Policy Objects GPO]]'
- '[[Find vulnerable GPO]]'
commands:
- '[[Filtering the ACL entries]]'
---

# Exploit Group Policy Objects with Write Access

## Summary

This procedure involves finding Group Policy Objects (GPOs) in an Active Directory environment that have write access. Once a vulnerable GPO is identified, an attacker can modify it to execute malicious commands on targeted machines. By exploiting GPOs, attackers can gain persistence, escalate priv

## Description

# Description

This procedure involves finding Group Policy Objects (GPOs) in an Active Directory environment that have write access. Once a vulnerable GPO is identified, an attacker can modify it to execute malicious commands on targeted machines. By exploiting GPOs, attackers can gain persistence, escalate privileges, and move laterally within the network. This technique is often used in post-exploitation activities to maintain access to a network.

 

## Requirements

1. Authenticated access to the Active Directory environment

1. Tools such as PowerView or BloodHound to enumerate GPOs

 

## Defense

1. Limit write access to GPOs to only authorized users or groups

1. Monitor GPO changes for unexpected modifications

1. Regularly review and remove unnecessary GPOs

 

## Objectives

1. Identify GPOs with write access

1. Exploit a vulnerable GPO to execute commands on targeted machines

1. Maintain persistence and escalate privileges within the network

 

# Instructions

1. This command retrieves the ACLs for the specified Active Directory object and filters out only those that have write access. The command can be modified by changing the Identity parameter to target different objects.

 



**Code**: [[Get-DomainObjectAcl -Identity "SuperSecureGPO" -Re]]



> The Get-DomainObjectAcl cmdlet retrieves the access control list (ACL) for an Active Directory object specified by the Identity parameter. The -ResolveGUIDs parameter is used to resolve GUIDs to their friendly names, making the output easier to read. The Where-Object cmdlet filters the results to only show ACLs that have one or more of the specified write access rights. The list of write access rights can be modified by changing the string passed to the -match parameter. This command can be useful for identifying GPOs that have write access granted to a particular user or group.



**Command** ([[Filtering the ACL entries]]):

```bash
Get-DomainObjectAcl -Identity "SuperSecureGPO" -ResolveGUIDs |  Where-Object {($_.ActiveDirectoryRights.ToString() -match "GenericWrite|AllExtendedWrite|WriteDacl|WriteProperty|WriteMember|GenericAll|WriteOwner")}
```



## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Privilege Escalation|TA0004 - Privilege Escalation]]

### Techniques

- [[Group Policy Modification|T1484 - Group Policy Modification]]

## Commands Used

- [[Filtering the ACL entries]]

## Tags

- [[Active Directory Attacks]]
- [[Exploit Group Policy Objects GPO]]
- [[Find vulnerable GPO]]


