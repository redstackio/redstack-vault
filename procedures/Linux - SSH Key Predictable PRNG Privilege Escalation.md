---
id: c1af2c04-4833-4949-bb63-52370e78c736
name: Linux - SSH Key Predictable PRNG Privilege Escalation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:18.711146+00:00'
updated_at: '2023-04-10T20:34:26.087349+00:00'
tactics:
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]'
tags:
- '[[Linux - Privilege Escalation]]'
- '[[SSH Key]]'
- '[[SSH Key Predictable PRNG (Authorized_Keys) Process]]'
commands:
- '[[SSH to target as victim]]'
- '[[Verbose Mode]]'
---

# Linux - SSH Key Predictable PRNG Privilege Escalation

## Summary

This procedure involves exploiting a predictable Pseudo-Random Number Generator (PRNG) used by SSH on Linux systems to generate SSH keys. This vulnerability can allow an attacker to generate a valid SSH key and authenticate to a remote system with escalated privileges. The technical explanation inv

## Description

# Description

This procedure involves exploiting a predictable Pseudo-Random Number Generator (PRNG) used by SSH on Linux systems to generate SSH keys. This vulnerability can allow an attacker to generate a valid SSH key and authenticate to a remote system with escalated privileges. The technical explanation involves identifying the PRNG seed value, calculating the next PRNG value, and using that value to generate a valid SSH key. The business value of this attack is that an attacker can gain unauthorized access to sensitive systems and data.

 

## Requirements

1. Access to a Linux system with SSH keys generated by a predictable PRNG

1. Knowledge of the PRNG seed value

1. Ability to calculate the next PRNG value

 

## Defense

1. Use a strong PRNG algorithm to generate SSH keys

1. Regularly rotate SSH keys to prevent long-term exploitation

1. Monitor for unusual SSH authentication activity

 

## Objectives

1. Gain escalated privileges on a Linux system

1. Authenticate to a remote system with escalated privileges

 

# Instructions

1. To establish a verbose SSH connection to a target machine using a specific private key.

 

The 'ssh' command is used to establish a secure shell connection to a remote machine. The '-vvv' option sets the verbosity level to maximum, providing detailed information about the connection process. The 'victim@target' argument specifies the username and IP address or hostname of the target machine. The '-i' option is used to specify the private key file to use for authentication. The argument '68b329da9893e34099c7d8ad5cb9c940-17934' is the path to the private key file. This command is useful for troubleshooting SSH connection issues and debugging connection problems.



**Command** ([[SSH to target as victim]]):

```bash
ssh -vvv victim@target -i 68b329da9893e34099c7d8ad5cb9c940-17934
```



2. ssh -vvv <username>@<hostname>

 



**Code**: [[-vvv]]



> This command establishes a secure shell (SSH) connection to a remote host with verbose output. The -vvv flag increases the verbosity level of the output, providing more detailed information about the connection process. The <username> and <hostname> arguments specify the user and host to connect to, respectively. This command can be used to troubleshoot SSH connection issues.



**Command** ([[Verbose Mode]]):

```bash
-vvv
```



## MITRE ATT&CK Mapping

### Tactics

- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]

## Commands Used

- [[SSH to target as victim]]
- [[Verbose Mode]]

## Tags

- [[Linux - Privilege Escalation]]
- [[SSH Key]]
- [[SSH Key Predictable PRNG (Authorized_Keys) Process]]


