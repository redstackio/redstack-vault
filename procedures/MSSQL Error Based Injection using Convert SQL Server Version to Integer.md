---
id: 95515cf0-3b0c-46f4-a884-ae832c53f9ee
name: MSSQL Error Based Injection using Convert SQL Server Version to Integer
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:33.823684+00:00'
updated_at: '2023-04-10T20:22:41.288868+00:00'
tactics:
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]'
tags:
- '[[MSSQL Error based]]'
- '[[MSSQL Injection]]'
commands:
- '[[Cast @@version to integer]]'
- '[[Cast @@version to string]]'
- '[[Convert @@version to integer]]'
- '[[Convert @@version to string]]'
---

# MSSQL Error Based Injection using Convert SQL Server Version to Integer

## Summary

MSSQL Error Based Injection is a type of SQL Injection attack that exploits the error messages generated by the database server to extract information. This technique involves injecting malicious SQL code into a vulnerable parameter that causes the database server to generate an error message that 

## Description

# Description

MSSQL Error Based Injection is a type of SQL Injection attack that exploits the error messages generated by the database server to extract information. This technique involves injecting malicious SQL code into a vulnerable parameter that causes the database server to generate an error message that contains sensitive information. In this case, the Convert SQL Server Version to Integer command is used to extract the version of the SQL Server running on the target system. This information can be used to identify vulnerabilities and plan further attacks.

Technical Explanation: The Convert SQL Server Version to Integer command converts the version of the SQL Server to an integer value. If the version is not valid, the server generates an error message that can be used to extract information.

Business Value: An attacker can use this technique to extract sensitive information from a database server, such as usernames, passwords, and other confidential data. This can lead to data theft, financial loss, and reputational damage.

 

## Requirements

1. Access to a vulnerable parameter in the SQL Server

1. Knowledge of SQL Injection techniques

1. The Convert SQL Server Version to Integer command

 

## Defense

1. Implement input validation to prevent SQL Injection attacks

1. Limit the privileges of database users to reduce the impact of a successful attack

1. Regularly update and patch the SQL Server to address known vulnerabilities

 

## Objectives

1. Extract the version of the SQL Server running on the target system

1. Identify vulnerabilities in the SQL Server

1. Plan further attacks based on the version of the SQL Server

 

# Instructions

1. To convert the SQL Server version to an integer, use the following commands:

 



**Code**: [[For integer inputs : convert(int,@@version)
For in]]



> The 'convert' and 'cast' functions are used to convert the SQL Server version to an integer. The 'convert' function takes the SQL Server version as an argument and converts it to an integer. The 'cast' function also takes the SQL Server version as an argument and converts it to an integer. Both functions return the same result. If the input is a string, you need to concatenate it with the conversion function. 



**Command** ([[Convert @@version to integer]]):

```bash
convert(int,@@version)
```





**Command** ([[Cast @@version to integer]]):

```bash
cast((SELECT @@version) as int)
```





**Command** ([[Convert @@version to string]]):

```bash
' + convert(int,@@version) + '
```





**Command** ([[Cast @@version to string]]):

```bash
' + cast((SELECT @@version) as int) + '
```



## MITRE ATT&CK Mapping

### Tactics

- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Exploitation of Remote Services|T1210 - Exploitation of Remote Services]]

## Commands Used

- [[Cast @@version to integer]]
- [[Cast @@version to string]]
- [[Convert @@version to integer]]
- [[Convert @@version to string]]

## Tags

- [[MSSQL Error based]]
- [[MSSQL Injection]]


