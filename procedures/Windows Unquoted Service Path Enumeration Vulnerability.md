---
id: 2784dfcb-ff7c-4587-b07d-6d357e51ecdf
name: Windows Unquoted Service Path Enumeration Vulnerability
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:29.663592+00:00'
updated_at: '2023-04-10T20:37:45.989296+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Persistence|TA0003 - Persistence]]'
- '[[Privilege Escalation|TA0004 - Privilege Escalation]]'
techniques:
- '[[DLL Search Order Hijacking|T1038 - DLL Search Order Hijacking]]'
- '[[Masquerading|T1036 - Masquerading]]'
tags:
- '[[EoP - Unquoted Service Paths]]'
- '[[Windows - Privilege Escalation]]'
---

# Windows Unquoted Service Path Enumeration Vulnerability

## Summary

The Windows Unquoted Service Path Enumeration Vulnerability is a privilege escalation attack that allows an attacker to elevate their privileges on a compromised system by exploiting a vulnerability in the Windows service manager. This vulnerability is caused by a service that is installed with an 

## Description

# Description

The Windows Unquoted Service Path Enumeration Vulnerability is a privilege escalation attack that allows an attacker to elevate their privileges on a compromised system by exploiting a vulnerability in the Windows service manager. This vulnerability is caused by a service that is installed with an unquoted service path, which can be manipulated by an attacker to execute arbitrary code with elevated privileges. An attacker can exploit this vulnerability by placing a malicious executable in a directory that has a space in its name, which will be executed instead of the intended executable. This attack can be used to gain access to sensitive information or to execute malicious code on a system.

## Requirements

1. Access to a compromised system

## Defense

1. Ensure that all services are installed with quoted service paths

1. Implement proper user permissions to prevent unauthorized access

1. Regularly update and patch systems to prevent vulnerabilities

## Objectives

1. Gain elevated privileges on a compromised system

# Instructions

1. This command will enumerate all Windows services with unquoted service paths. It will help to identify vulnerable services that can be exploited by attackers. The command will return the Path to the executable, Display Name, and Name of the service.

**Code**: [[wmic service get name,displayname,pathname,startmo]]

> The command uses WMI and PowerShell to get the details of all Windows services that have unquoted service paths. It filters the output to only show services with a Start Mode of 'Auto' and whose Path does not start with 'C:\Windows'. It then selects only the Path to the executable, Display Name, and Name of the service. This information can be used to identify vulnerable services that can be exploited by attackers.

## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Persistence|TA0003 - Persistence]]
- [[Privilege Escalation|TA0004 - Privilege Escalation]]

### Techniques

- [[DLL Search Order Hijacking|T1038 - DLL Search Order Hijacking]]
- [[Masquerading|T1036 - Masquerading]]

## Tags

- [[EoP - Unquoted Service Paths]]
- [[Windows - Privilege Escalation]]
