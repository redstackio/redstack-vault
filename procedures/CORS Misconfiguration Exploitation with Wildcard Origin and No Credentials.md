---
id: 4d356d49-c421-4009-a4b8-31be544a8f3a
name: CORS Misconfiguration Exploitation with Wildcard Origin and No Credentials
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:55.135654+00:00'
updated_at: '2023-04-06T03:55:55.146914+00:00'
tactics:
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
tags:
- '[[CORS Misconfiguration]]'
- '[[Exploitation]]'
- '[[Proof of concept]]'
- '[[Vulnerable Example: Wildcard Origin `*` without Credentials]]'
---

# CORS Misconfiguration Exploitation with Wildcard Origin and No Credentials

## Summary

CORS (Cross-Origin Resource Sharing) is a security feature implemented by web browsers that restricts web pages from making requests to a different domain than the one that served the web page. A misconfigured CORS policy can allow an attacker to access sensitive data or perform actions on behalf o

## Description

# Description

CORS (Cross-Origin Resource Sharing) is a security feature implemented by web browsers that restricts web pages from making requests to a different domain than the one that served the web page. A misconfigured CORS policy can allow an attacker to access sensitive data or perform actions on behalf of the victim. One such misconfiguration is allowing a wildcard origin (`*`) without requiring credentials. This allows any website to make requests to the vulnerable domain, allowing an attacker to steal sensitive data or perform actions on behalf of the user. This attack can be used as an initial access vector in a larger attack campaign.

## Requirements

1. Access to a web browser

1. Knowledge of the vulnerable domain

1. Ability to send requests to the vulnerable domain

## Defense

1. Implement a strict CORS policy that only allows trusted origins to access resources

1. Require credentials (such as cookies or tokens) for cross-origin requests

1. Monitor network traffic for suspicious requests or responses

## Objectives

1. Exploit the misconfigured CORS policy to gain access to sensitive data or perform actions on behalf of the victim

1. Use the stolen data or access to perform further attacks

# Instructions

1. Send a GET request to the vulnerable domain's API endpoint using an XMLHttpRequest object. If the CORS policy is misconfigured, the response will be accessible to the attacker. In this example, the response is sent to a logging server controlled by the attacker.

**Code**: [[var req = new XMLHttpRequest(); 
req.onload = reqL]]

> The `XMLHttpRequest()` object is used to send HTTP requests to a server. In this case, a GET request is sent to the vulnerable domain's API endpoint. If the CORS policy is misconfigured, the response will be accessible to the attacker. The `onload` event listener is used to handle the response, and the `reqListener()` function extracts the response text and sends it to a logging server controlled by the attacker. This allows the attacker to steal sensitive data or perform actions on behalf of the user.

## MITRE ATT&CK Mapping

### Tactics

- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]

## Tags

- [[CORS Misconfiguration]]
- [[Exploitation]]
- [[Proof of concept]]
- [[Vulnerable Example: Wildcard Origin `*` without Credentials]]
