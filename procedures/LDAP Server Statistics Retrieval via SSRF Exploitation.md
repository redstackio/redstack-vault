---
id: f5154b83-a4a5-474f-b636-b9dd27887cd3
name: LDAP Server Statistics Retrieval via SSRF Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:37.882889+00:00'
updated_at: '2023-04-10T20:24:16.292989+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Lateral Movement|TA0008 - Lateral Movement]]'
techniques:
- '[[Application Access Token|T1527 - Application Access Token]]'
- '[[Exploitation for Credential Access|T1212 - Exploitation for Credential Access]]'
tags:
- '[[LDAP]]'
- '[[Server-Side Request Forgery]]'
- '[[SSRF exploitation via URL Scheme]]'
---

# LDAP Server Statistics Retrieval via SSRF Exploitation

## Summary

This procedure involves exploiting a Server-Side Request Forgery (SSRF) vulnerability via a URL scheme to retrieve LDAP server statistics. An attacker can craft a malicious request that forces the server to make an LDAP query to a specified server and port. The attacker can then extract the server 

## Description

# Description

This procedure involves exploiting a Server-Side Request Forgery (SSRF) vulnerability via a URL scheme to retrieve LDAP server statistics. An attacker can craft a malicious request that forces the server to make an LDAP query to a specified server and port. The attacker can then extract the server statistics from the response to the query. This technique can be used to gather information about the target network and identify potential targets for further exploitation.

Technical Explanation: The attacker sends a specially crafted request to the vulnerable application that includes a URL with an LDAP query. The application blindly follows the URL and makes the LDAP query on behalf of the attacker. The attacker can then extract the server statistics from the response to the query. This technique is effective because the attacker can bypass network restrictions and access internal resources that are not directly accessible from the internet.

Business Value: An attacker can use this technique to gather valuable information about the target network, including the number and types of LDAP servers and their configurations. This information can be used to plan further attacks and increase the chances of success.

 

## Requirements

1. Access to a vulnerable application with SSRF vulnerability

1. Knowledge of the target LDAP server and port

 

## Defense

1. Implement input validation and sanitization to prevent SSRF vulnerabilities

1. Use a whitelist approach to restrict the URLs that the application can access

1. Implement network segmentation to limit the exposure of internal resources

 

## Objectives

1. Retrieve LDAP server statistics

1. Gather information about the target network

 

# Instructions

1. To retrieve statistics from an LDAP server, use the following command: ssrf.php?url=ldap://<server>:<port>/%0astats%0aquit

 



**Code**: [[ssrf.php?url=ldap://localhost:11211/%0astats%0aqui]]



> This command sends a request to the specified LDAP server to retrieve statistics about the server. The 'stats' command is used to retrieve the statistics and the 'quit' command is used to close the connection. The URL should be in the format 'ldap://<server>:<port>/'. Replace '<server>' with the IP address or hostname of the LDAP server and '<port>' with the port number on which the LDAP server is running.

## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]
- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Lateral Movement|TA0008 - Lateral Movement]]

### Techniques

- [[Application Access Token|T1527 - Application Access Token]]
- [[Exploitation for Credential Access|T1212 - Exploitation for Credential Access]]

## Tags

- [[LDAP]]
- [[Server-Side Request Forgery]]
- [[SSRF exploitation via URL Scheme]]


