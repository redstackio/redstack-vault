---
id: e7b6536b-fa8c-462f-aee0-90a435e0d166
name: Insecure File Upload Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:41.029398+00:00'
updated_at: '2023-04-10T20:24:33.711791+00:00'
tags:
- '[[Defaults extensions]]'
- '[[Exploits]]'
- '[[Upload Insecure Files]]'
commands:
- '[[Less known PHP extensions]]'
- '[[List of PHP extensions]]'
---

# Insecure File Upload Exploitation

## Summary

Insecure file upload is a vulnerability that allows an attacker to upload and execute malicious files on a web server. The attacker can use this vulnerability to gain access to sensitive data, execute arbitrary code, or take control of the server. This technique is commonly used in initial access a

## Description

# Description

Insecure file upload is a vulnerability that allows an attacker to upload and execute malicious files on a web server. The attacker can use this vulnerability to gain access to sensitive data, execute arbitrary code, or take control of the server. This technique is commonly used in initial access and defense evasion phases of an attack. Attackers can exploit default file extensions to bypass security measures and upload malicious files. This procedure will help identify and exploit insecure file upload vulnerabilities and execute code on the server.

## Requirements

1. Access to the target web application

1. Knowledge of insecure file upload vulnerabilities

1. Ability to upload files to the web server

## Defense

1. Implement input validation checks to prevent upload of malicious files

1. Use secure file upload libraries and frameworks

1. Restrict file upload permissions to trusted users only

## Objectives

1. Exploit insecure file upload vulnerabilities

1. Upload and execute malicious code on the web server

1. Gain access to sensitive data

# Instructions

1. To use PHP Server, navigate to the directory containing your PHP files and run the command 'php -S localhost:8000'. You can then access your PHP files by navigating to 'http://localhost:8000' in your web browser.

**Code**: [[.php
.php3
.php4
.php5
.php7

# Less known PHP ext]]

> This command lists the file extensions commonly used for PHP files, as well as some lesser-known extensions. The 'php -S' command is used to start a PHP server on your local machine, allowing you to run PHP files locally without the need for a web server like Apache or Nginx.

**Command** ([[List of PHP extensions]]):

```bash
.php
.php3
.php4
.php5
.php7
```

**Command** ([[Less known PHP extensions]]):

```bash
.pht
.phps
.phar
.phpt
.pgif
.phtml
.phtm
.inc
```

2. To configure the ASP server, use the following file extensions:

**Code**: [[.asp
.aspx
.config
.cer and .asa # (IIS <= 7.5)
sh]]

> The ASP server can be configured to recognize certain file extensions. This JSON object provides a list of recommended file extensions to use for the ASP server. These file extensions include .asp, .aspx, .config, .cer, and .asa for IIS versions up to 7.5. For IIS versions below 7.0, the recommended file extensions include shell.aspx;1.jpg and shell.soap. By using these file extensions, the ASP server will be able to properly recognize and execute the associated files.

## Commands Used

- [[Less known PHP extensions]]
- [[List of PHP extensions]]

## Tags

- [[Defaults extensions]]
- [[Exploits]]
- [[Upload Insecure Files]]
