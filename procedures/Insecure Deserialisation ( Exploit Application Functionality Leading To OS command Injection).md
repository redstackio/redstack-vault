---
id: b4323286-9186-4d0b-a3e8-46d3d05cdf0f
name: Insecure Deserialisation ( Exploit Application Functionality Leading To OS command
  Injection)
type: procedure
verified: true
submitted: true
created_at: '2020-08-17T17:04:58.536657+00:00'
updated_at: '2023-05-26T18:46:56.634594+00:00'
platforms:
- Web
tags:
- '[[Insecure Deserialisation]]'
- '[[os command injection]]'
- '[[Web Applications]]'
---

# Insecure Deserialisation ( Exploit Application Functionality Leading To OS command Injection)

**Status**: âœ“ Verified

## Summary

An attacker will craft a malicious JSON file whcih will be executed during deserailaisation by the application. It will further lead to OS command execution. 

## Description

# Description

An attacker will craft a malicious JSON file whcih will be executed during deserailaisation by the application. It will further lead to OS command execution.

# Instructions

1.  Login to the application and observe that session cookie contains a serialised PHP object .

2. Access the site map(Step 1), notice  the website references  file :  /libs/CustomTemplate.php. Right-click on the file and select "Send to Repeater".

3. In the response from step 2 , notice that the customTemplate class contains destruct() magic method . This will invoke the u*nlink()* method on the *lock_file_path *attribute which will delete the file on this path.

4. In Burp Decoder, use the correct syntax for serialized PHP data to create a CustomTemplate object with the lock_file_path attribute set to /home/carlos/morale.txt. 

Make sure to use the correct data type labels and length indicators. 

The final object looks like this:
* O:14:"CustomTemplate":1:{s:14:"lock_file_path";s:23:"/home/carlos/morale.txt";}*

Base64 and URL encode this object and save it to your clipboard.

5. Send a request containing the session cookie to Burp Repeater.

        In Burp Repeater, replace the session cookie with the modified one in your clipboard.

        Send the request. The __destruct()magic method is automatically invoked and will delete Carlos's file.

6. Send the modified request to the server and observe the response . 

## Platforms

- Web

## Tags

- [[Insecure Deserialisation]]
- [[os command injection]]
- [[Web Applications]]
