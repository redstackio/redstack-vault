---
id: 664bb4c8-4632-4a0e-a94d-80bca0869350
name: Log4Shell Exploitation via Docker
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:56.836621+00:00'
updated_at: '2023-04-06T03:55:56.846747+00:00'
tactics:
- '[[Execution|TA0002 - Execution]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Command-Line Interface|T1059 - Command-Line Interface]]'
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
tags:
- '[[CVE-2021-44228 Log4Shell]]'
- '[[Vulnerable code]]'
commands:
- '[[Run Docker Container]]'
---

# Log4Shell Exploitation via Docker

## Summary

This procedure outlines how to exploit the Log4j vulnerability, CVE-2021-44228, via Docker. The vulnerability allows an attacker to execute arbitrary code on a Log4j server using a maliciously crafted request. By running a vulnerable Docker container, an attacker can simulate the vulnerable server 

## Description

# Description

This procedure outlines how to exploit the Log4j vulnerability, CVE-2021-44228, via Docker. The vulnerability allows an attacker to execute arbitrary code on a Log4j server using a maliciously crafted request. By running a vulnerable Docker container, an attacker can simulate the vulnerable server and exploit the vulnerability locally. This can be used as a proof of concept or to test for the presence of the vulnerability in a targeted environment. The business value of this procedure is to identify and remediate the Log4j vulnerability before it can be exploited by an attacker.

## Requirements

1. Docker installed on the local machine

## Defense

1. Apply the latest patches and updates for Log4j to mitigate against this vulnerability

1. Implement network segmentation to limit the impact of a successful exploitation

1. Monitor network traffic for signs of exploitation, such as suspicious HTTP requests

## Objectives

1. To exploit the Log4j vulnerability locally via Docker

1. To test for the presence of the vulnerability in a targeted environment

# Instructions

1. To run the vulnerable Docker container locally, execute the following command:

**Code**: [[docker run --name vulnerable-app -p 8080:8080 ghcr]]

> This command will pull the vulnerable Docker container from the specified repository and run it locally. The -p flag maps port 8080 on the container to port 8080 on the host machine, allowing the vulnerable application to be accessed via a web browser at http://localhost:8080.

**Command** ([[Run Docker Container]]):

```bash
docker run --name vulnerable-app -p 8080:8080 ghcr.io/christophetd/log4shell-vulnerable-app
```

2. To send a malicious request to the vulnerable application, use the following code:

**Code**: [[public String index(@RequestHeader("X-Api-Version"]]

> This code can be used to craft a malicious request that triggers the Log4j vulnerability in the vulnerable application. By including a specially crafted header in the request, an attacker can execute arbitrary code on the server. This code is written in Java and can be used as a proof of concept or to test for the presence of the vulnerability in a targeted environment.

## MITRE ATT&CK Mapping

### Tactics

- [[Execution|TA0002 - Execution]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Command-Line Interface|T1059 - Command-Line Interface]]
- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]

## Commands Used

- [[Run Docker Container]]

## Tags

- [[CVE-2021-44228 Log4Shell]]
- [[Vulnerable code]]
