---
id: 6deff73d-f9b5-4ffe-855a-f0b84f06ef73
name: Cobalt Strike Malleable C2 Profile Checking
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:56:16.418146+00:00'
updated_at: '2023-04-10T20:36:22.507917+00:00'
tactics:
- '[[Command and Control|TA0011 - Command and Control]]'
techniques:
- '[[Connection Proxy|T1090 - Connection Proxy]]'
- '[[Custom Command and Control Protocol|T1094 - Custom Command and Control Protocol]]'
sub_techniques:
- '[[Domain Fronting|T1090.004 - Domain Fronting]]'
tags:
- '[[Cobalt Strike]]'
- '[[Malleable C2]]'
---

# Cobalt Strike Malleable C2 Profile Checking

## Summary

Cobalt Strike's Malleable C2 allows attackers to customize the network traffic generated by the Beacon payload, making it more difficult to detect and block. Profile checking is a feature that allows the attacker to verify that the Beacon is still communicating with the correct C2 server. To do thi

## Description

# Description

Cobalt Strike's Malleable C2 allows attackers to customize the network traffic generated by the Beacon payload, making it more difficult to detect and block. Profile checking is a feature that allows the attacker to verify that the Beacon is still communicating with the correct C2 server. To do this, the attacker can configure the Beacon to send a specific HTTP request to the C2 server, and check the response. If the response matches the expected value, the Beacon continues to communicate with the server. If not, the Beacon terminates the communication and attempts to connect to a new C2 server.

From an offensive perspective, profile checking helps the attacker maintain persistence by ensuring that the Beacon is still communicating with a valid C2 server. From a technical standpoint, profile checking is a simple HTTP request/response exchange that can be easily customized to evade detection. From a business perspective, Cobalt Strike's Malleable C2 allows attackers to bypass traditional security controls and maintain access to the target environment.

## Requirements

1. Access to a Beacon payload that is configured to use Malleable C2

1. Knowledge of the expected HTTP request/response for profile checking

## Defense

1. Monitor network traffic for suspicious HTTP requests

1. Implement network segmentation to limit lateral movement

1. Use endpoint detection and response (EDR) tools to detect and respond to malicious activity

## Objectives

1. Verify that the Beacon is still communicating with a valid C2 server

1. Maintain persistence within the target environment

# Instructions

1. To check a profile, run the following command: ./c2lint <profile_name>

**Code**: [[./c2lint]]

> The <profile_name> argument is the name of the profile you want to check. This command will analyze the profile for any potential issues or errors and provide a report of the findings.

## MITRE ATT&CK Mapping

### Tactics

- [[Command and Control|TA0011 - Command and Control]]

### Techniques

- [[Connection Proxy|T1090 - Connection Proxy]]
- [[Custom Command and Control Protocol|T1094 - Custom Command and Control Protocol]]

### Sub-Techniques

- [[Domain Fronting|T1090.004 - Domain Fronting]]

## Tags

- [[Cobalt Strike]]
- [[Malleable C2]]
