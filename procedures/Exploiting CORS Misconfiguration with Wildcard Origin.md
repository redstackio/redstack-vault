---
id: 5a2f75a1-5f59-4c08-b403-5410f883c759
name: Exploiting CORS Misconfiguration with Wildcard Origin
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:55.085656+00:00'
updated_at: '2023-04-06T03:55:55.096617+00:00'
tags:
- '[[CORS Misconfiguration]]'
- '[[Exploitation]]'
- '[[Vulnerable Example: Wildcard Origin `*` without Credentials]]'
---

# Exploiting CORS Misconfiguration with Wildcard Origin

## Summary

Cross-Origin Resource Sharing (CORS) is a security feature implemented by web browsers to restrict web page resources from being requested from another domain outside the domain from which the first resource was served. A misconfigured CORS policy can allow an attacker to bypass the Same Origin Pol

## Description

# Description

Cross-Origin Resource Sharing (CORS) is a security feature implemented by web browsers to restrict web page resources from being requested from another domain outside the domain from which the first resource was served. A misconfigured CORS policy can allow an attacker to bypass the Same Origin Policy (SOP) and access sensitive data or perform actions on behalf of the victim. One of the common misconfigurations is to allow any origin by using a wildcard `*` in the Access-Control-Allow-Origin header. This vulnerability can be exploited by an attacker to conduct attacks such as stealing sensitive data, performing unauthorized actions, or executing client-side code.

To exploit this vulnerability, the attacker sends a specially crafted request to the vulnerable server with the Origin header set to a malicious domain. If the server responds with a wildcard origin `*`, the attacker can access the sensitive data or perform unauthorized actions. The attacker can also use the vulnerability to execute client-side code by injecting malicious scripts into the victim's browser.

The business value of exploiting CORS misconfiguration is that it allows an attacker to access sensitive data or perform unauthorized actions, which can lead to financial loss, reputational damage, or legal liabilities for the victim organization.

## Requirements

1. Access to a vulnerable web application with a misconfigured CORS policy.

1. A web browser to send the specially crafted requests.

1. Knowledge of the vulnerable server's domain and the malicious domain to set in the Origin header.

## Defense

1. Configure the CORS policy to only allow specific domains and methods that are required for the web application to function properly.

1. Implement additional security measures such as input validation, output encoding, and access control to prevent unauthorized access or actions.

1. Monitor the web application for CORS misconfiguration vulnerabilities and apply security patches or updates as soon as they become available.

## Objectives

1. Exploit the CORS misconfiguration vulnerability to gain unauthorized access to sensitive data or perform unauthorized actions on the victim server.

1. Execute client-side code on the victim's browser by injecting malicious scripts.

# Instructions

1. Send a GET or POST request to the vulnerable server with the Origin header set to a malicious domain.

**Code**: [[*]]

> The attacker crafts a GET or POST request to the vulnerable server with the Origin header set to a malicious domain that they control. If the server responds with a wildcard origin `*`, the attacker can access the sensitive data or perform unauthorized actions.

2. Inject a malicious script into the victim's browser by setting the src attribute of a script tag to the attacker's domain.

**Code**: [[* is the only wildcard origin
https://*.example.co]]

> The attacker injects a malicious script into the victim's browser by setting the src attribute of a script tag to the attacker's domain. The attacker can use the wildcard `*` to inject the script into any website that doesn't have a strict CORS policy. However, some modern browsers block wildcard origins, and some websites use a strict CORS policy that only allows specific domains.

## Tags

- [[CORS Misconfiguration]]
- [[Exploitation]]
- [[Vulnerable Example: Wildcard Origin `*` without Credentials]]
