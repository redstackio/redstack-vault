---
id: b013345e-71e8-41b7-80a6-f734e9ad35fc
name: HTTP Request Smuggling Detection and Exploitation
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:53.887135+00:00'
updated_at: '2023-04-06T03:55:53.906650+00:00'
tactics:
- '[[Credential Access|TA0006 - Credential Access]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Credentials from Password Stores|T1555 - Credentials from Password Stores]]'
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
sub_techniques:
- '[[Credentials from Web Browsers|T1555.003 - Credentials from Web Browsers]]'
- '[[Keychain|T1555.001 - Keychain]]'
tags:
- '[[Account Takeover]]'
- '[[Account Takeover Via HTTP Request Smuggling]]'
commands:
- '[[Clone smuggler repository]]'
- '[[Display help for smuggler.py]]'
- '[[Navigate to smuggler directory]]'
---

# HTTP Request Smuggling Detection and Exploitation

## Summary

HTTP Request Smuggling (HRS) is a technique used to exploit vulnerabilities in web applications that parse HTTP requests. Attackers use HRS to bypass security controls and gain unauthorized access to sensitive data. The technique involves sending a malformed HTTP request that is interpreted differe

## Description

# Description

HTTP Request Smuggling (HRS) is a technique used to exploit vulnerabilities in web applications that parse HTTP requests. Attackers use HRS to bypass security controls and gain unauthorized access to sensitive data. The technique involves sending a malformed HTTP request that is interpreted differently by different components of a web application. This results in the request being processed in an unexpected way, allowing the attacker to bypass security controls and gain access to sensitive data. The Smuggler tool can be used to detect the type of HRS being used and craft requests to exploit it. This procedure can be used to gain access to user credentials and session cookies, leading to a full account takeover.

 

## Requirements

1. Access to the target web application

1. Smuggler tool installed

 

## Defense

1. Implement strict input validation and sanitization to prevent HTTP Request Smuggling attacks

1. Implement strict access controls to prevent unauthorized access to sensitive data

1. Regularly monitor web application logs for signs of HTTP Request Smuggling attacks

 

## Objectives

1. Detect and exploit HTTP Request Smuggling vulnerabilities in web applications

1. Gain unauthorized access to sensitive data

1. Perform account takeover

 

# Instructions

1. To detect the type of HTTP Request Smuggling being used, run the following commands:

 



**Code**: [[git clone https://github.com/defparam/smuggler.git]]



> This command clones the smuggler tool from Github, changes the current directory to smuggler, and runs the smuggler.py script with the -h flag to display the available options.



**Command** ([[Clone smuggler repository]]):

```bash
git clone https://github.com/defparam/smuggler.git
```





**Command** ([[Navigate to smuggler directory]]):

```bash
cd smuggler
```





**Command** ([[Display help for smuggler.py]]):

```bash
python3 smuggler.py -h
```



2. To craft a request which will overwrite the `POST / HTTP/1.1` with the specified data, run the following command:

 



**Code**: [[GET http://something.burpcollaborator.net  HTTP/1.]]



> This command crafts a GET request with a header that will overwrite the `POST / HTTP/1.1` with the specified data.

3. To exploit the HTTP Request Smuggling vulnerability, run the following command:

 



**Code**: [[GET /  HTTP/1.1
Transfer-Encoding: chunked
Host: s]]



> This command sends a crafted request which exploits the HTTP Request Smuggling vulnerability and allows the attacker to gain unauthorized access to sensitive data.

## MITRE ATT&CK Mapping

### Tactics

- [[Credential Access|TA0006 - Credential Access]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Credentials from Password Stores|T1555 - Credentials from Password Stores]]
- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]

### Sub-Techniques

- [[Credentials from Web Browsers|T1555.003 - Credentials from Web Browsers]]
- [[Keychain|T1555.001 - Keychain]]

## Commands Used

- [[Clone smuggler repository]]
- [[Display help for smuggler.py]]
- [[Navigate to smuggler directory]]

## Tags

- [[Account Takeover]]
- [[Account Takeover Via HTTP Request Smuggling]]


