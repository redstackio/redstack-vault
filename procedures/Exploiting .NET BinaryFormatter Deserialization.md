---
id: 1e716e62-5bb7-414a-9ad5-7626a62c1661
name: Exploiting .NET BinaryFormatter Deserialization
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:59.205284+00:00'
updated_at: '2023-04-06T03:55:59.218151+00:00'
tactics:
- '[[Impact|TA0040 - Impact]]'
techniques:
- '[[System Shutdown/Reboot|T1529 - System Shutdown/Reboot]]'
tags:
- '[[BinaryFormatter]]'
- '[[Formatters]]'
- '[[.NET Serialization]]'
---

# Exploiting .NET BinaryFormatter Deserialization

## Summary

Exploiting .NET BinaryFormatter Deserialization is a technique that allows an attacker to execute arbitrary code on a target system. BinaryFormatter is a class in the .NET framework that is used to serialize and deserialize objects. However, it is vulnerable to deserialization attacks, where an att

## Description

# Description

Exploiting .NET BinaryFormatter Deserialization is a technique that allows an attacker to execute arbitrary code on a target system. BinaryFormatter is a class in the .NET framework that is used to serialize and deserialize objects. However, it is vulnerable to deserialization attacks, where an attacker can inject malicious code into the serialized data. This technique can be used to gain remote code execution on a target system, allowing the attacker to perform various actions, such as stealing sensitive data or pivoting to other systems.

 

## Requirements

1. Access to a vulnerable .NET application

1. Ability to send serialized data to the application

 

## Defense

1. Implement input validation and data sanitization in the application to prevent untrusted data from being deserialized

1. Use a secure serialization library, such as JSON or XML, instead of BinaryFormatter

1. Monitor the network for suspicious traffic and anomalous behavior

 

## Objectives

1. Gain remote code execution on a target system

1. Steal sensitive data

1. Pivot to other systems

 

# Instructions

1. Run the following command to generate the payload:

 



**Code**: [[./ysoserial.exe -f BinaryFormatter -g PSObject -o ]]



> ysoserial.exe -f BinaryFormatter -g PSObject -o base64 -c "calc" -t

-f: specifies the formatter to use (BinaryFormatter)
-g: specifies the gadget chain to use (PSObject)
-o: specifies the output format (base64)
-c: specifies the command to execute (calc)
-t: specifies the type of payload to generate

## MITRE ATT&CK Mapping

### Tactics

- [[Impact|TA0040 - Impact]]

### Techniques

- [[System Shutdown/Reboot|T1529 - System Shutdown/Reboot]]

## Tags

- [[BinaryFormatter]]
- [[Formatters]]
- [[.NET Serialization]]


