---
id: 57ebdd19-5830-4b32-8377-6f4cde947d2d
name: Node Deserialization Exploitation using node-serialize
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:59.260914+00:00'
updated_at: '2023-04-06T03:55:59.274399+00:00'
tactics:
- '[[Execution|TA0002 - Execution]]'
techniques:
- '[[Inter-Process Communication|T1559 - Inter-Process Communication]]'
tags:
- '[[Exploit]]'
- '[[Node Deserialization]]'
- '[[node-serialize]]'
---

# Node Deserialization Exploitation using node-serialize

## Summary

Node.js deserialization is a process of converting a string representation of an object into an actual object. This process can be exploited by attackers to execute arbitrary code on the server-side. The node-serialize is a popular module in Node.js that can be used to serialize and deserialize Jav

## Description

# Description

Node.js deserialization is a process of converting a string representation of an object into an actual object. This process can be exploited by attackers to execute arbitrary code on the server-side. The node-serialize is a popular module in Node.js that can be used to serialize and deserialize JavaScript objects. An attacker can craft a malicious payload and serialize it using node-serialize. When the server deserializes the payload, the malicious code gets executed. This technique can be used by attackers to gain remote code execution (RCE) on the target system.

Technical Explanation: The first command generates a serialized payload that contains a function that executes a command on the target system. The second command modifies the serialized payload to force the execution of the function. When the server deserializes this payload, the function gets executed, and the command is executed on the target system.

Business Value: An attacker can use this technique to gain unauthorized access to the target system and steal sensitive data. This can result in reputational damage, financial loss, and legal consequences for the target organization.

## Requirements

1. Access to the target system

1. Node.js environment

1. node-serialize module

## Defense

1. Avoid using `node-serialize` module in production environments

1. Implement input validation to prevent untrusted data from being deserialized

1. Use a web application firewall (WAF) to detect and block malicious payloads

## Objectives

1. To gain remote code execution on the target system

# Instructions

1. Execute the following commands in a Node.js environment:

**Code**: [[var y = {
    rce : function(){
        require('c]]

> This command generates a serialized payload that contains a function called `rce`. This function executes a command on the target system using the `child_process.exec` method. The payload is serialized using the `node-serialize` module.

2. Modify the serialized payload generated in the previous command as follows:

**Code**: [[{"rce":"_$$ND_FUNC$$_function(){require('child_pro]]

> This command modifies the serialized payload to add brackets `()` after the `rce` function. This forces the execution of the function when the payload is deserialized on the target system.

## MITRE ATT&CK Mapping

### Tactics

- [[Execution|TA0002 - Execution]]

### Techniques

- [[Inter-Process Communication|T1559 - Inter-Process Communication]]

## Tags

- [[Exploit]]
- [[Node Deserialization]]
- [[node-serialize]]
