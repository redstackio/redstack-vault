---
id: 850ef80a-84e3-4d58-9d9f-7321ae445876
name: CORS Misconfiguration Exploitation - Null Origin
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:54.582902+00:00'
updated_at: '2023-04-06T03:55:54.601384+00:00'
tags:
- '[[CORS Misconfiguration]]'
- '[[Exploitation]]'
- '[[Vulnerable Example: Null Origin]]'
- '[[Vulnerable Implementation]]'
commands:
- '[[HTTP GET request to /endpoint]]'
- '[[Set Access-Control-Allow-Origin to null]]'
---

# CORS Misconfiguration Exploitation - Null Origin

## Summary

Cross-Origin Resource Sharing (CORS) is a security feature that restricts web pages from making requests to a different domain than the one that served the web page. A misconfigured CORS policy can allow attackers to bypass the Same-Origin Policy (SOP) and perform unauthorized actions on behalf of 

## Description

# Description

Cross-Origin Resource Sharing (CORS) is a security feature that restricts web pages from making requests to a different domain than the one that served the web page. A misconfigured CORS policy can allow attackers to bypass the Same-Origin Policy (SOP) and perform unauthorized actions on behalf of the victim. This specific procedure exploits a vulnerability where the server reflects the Origin header with a null value. An attacker can leverage this vulnerability to bypass the SOP and exfiltrate sensitive data, such as session cookies or API keys, from the victim's web application.

To exploit this vulnerability, the attacker sends a GET request to the victim's web application with the Origin header set to null. If the server reflects the Origin header with a null value in the Access-Control-Allow-Origin header, the attacker can bypass the SOP and access sensitive data from the victim's web application. This vulnerability can lead to further attacks, such as Cross-Site Scripting (XSS) or credential theft.

The business value of this procedure is that an attacker can gain unauthorized access to sensitive data, such as session cookies or API keys, from the victim's web application. This can lead to further attacks, such as credential theft, data exfiltration, or unauthorized actions on behalf of the victim.

## Requirements

1. Access to the victim's web application

1. Knowledge of the victim's CORS policy

## Defense

1. Implement a strict CORS policy that only allows trusted domains to make requests to the victim's web application.

1. Implement proper input validation and sanitization to prevent Cross-Site Scripting (XSS) attacks.

1. Implement proper session management and use HttpOnly and Secure flags for session cookies to prevent session hijacking.

## Objectives

1. Bypass the Same-Origin Policy (SOP)

1. Exfiltrate sensitive data, such as session cookies or API keys, from the victim's web application

# Instructions

1. 

**Code**: [[Origin: null]]

> The attacker sets the Origin header to null in the GET request to the victim's web application to trigger the vulnerable CORS policy.

2. 

**Code**: [[GET /endpoint HTTP/1.1
Host: victim.example.com
Or]]

> The attacker sends a GET request to the victim's web application with the Origin header set to null to trigger the vulnerable CORS policy.

**Command** ([[HTTP GET request to /endpoint]]):

```bash
GET /endpoint HTTP/1.1
Host: victim.example.com
Origin: null
Cookie: sessionid=...

```

3. 

**Code**: [[Access-Control-Allow-Origin: null]]

> If the Access-Control-Allow-Origin header reflects the Origin header with a null value, the attacker can bypass the SOP and access sensitive data from the victim's web application.

**Command** ([[Set Access-Control-Allow-Origin to null]]):

```bash
Access-Control-Allow-Origin: null
```

## Commands Used

- [[HTTP GET request to /endpoint]]
- [[Set Access-Control-Allow-Origin to null]]

## Tags

- [[CORS Misconfiguration]]
- [[Exploitation]]
- [[Vulnerable Example: Null Origin]]
- [[Vulnerable Implementation]]
