---
id: 031cc6c3-4ea1-4771-8197-246f76348802
name: Web app exploit ImageMagick + Shellshock w/ reverse shell & docker priv esc
type: attack_chain
description: ' web app, linux, shellshock, image magick, docker, privilege escalation,
  CTF'
verified: false
submitted: false
step_count: 8
created_at: '2019-10-24T21:30:06.468426+00:00'
updated_at: '2023-05-29T16:48:53.162677+00:00'
procedures:
- '[[Find Linux Files with Elevated Privileges]]'
- '[[Exploit Shellshock on a Vulnerable Web App]]'
- '[[Basic Port Scan with Service Enumeration]]'
- '[[Enumerate and Analyze an SSL/TLS Certificate]]'
- '[[Docker Privilege Escalation Using Docker Group]]'
- '[[Exploit ImageMagick (ImageTragick) for Code Execution]]'
- '[[Directory Brute Force a Web App (GoBuster)]]'
- '[[Directory Brute Force a Web App with Extensions (GoBuster)]]'
tags:
- web app
- linux
- shellshock
- image magick
- docker
- privilege escalation
- CTF
---

# ğŸ¯ Web app exploit ImageMagick + Shellshock w/ reverse shell & docker priv esc

> **Enhanced Attack Chain Dashboard** â€” Privilege Escalation Chain

---

## ğŸ“Š Chain Metrics Dashboard

| Metric | Value |
|--------|-------|
| **Chain Status** | âš ï¸ **UNVERIFIED** |
| **Total Steps** | `8` |
| **Execution Time** | ~2-4 hours |
| **Skill Level** | ğŸŸ¡ Intermediate-Advanced |
| **Complexity** | High |
| **Impact Level** | ğŸ”´ **CRITICAL** |

---

## ğŸ­ Attack Flow Visualization

```mermaid
graph TD
    A[ğŸŒ Reconnaissance]
    B[ğŸ¯ Initial Access]
    C[ğŸ”“ Exploitation]
    D[ğŸ“Š Enumeration]
    E[âš™ï¸ Privilege Escalation]
    F[ğŸ‘‘ Objective Complete]
    A --> B
    B --> C
    C --> D
    D --> E
    E --> F
    
    style A fill:#4a90e2,stroke:#2e5c8a,stroke-width:3px,color:#fff
    style C fill:#e25555,stroke:#8a2e2e,stroke-width:3px,color:#fff
    style D fill:#9b59b6,stroke:#6c3483,stroke-width:3px,color:#fff
    style F fill:#27ae60,stroke:#1e8449,stroke-width:3px,color:#fff
```

---

## ğŸ› ï¸ Prerequisites & Requirements

### Required Tools
```bash path=null start=null
# Tools will be listed here based on procedures
```

### Target Environment
- âœ… Linux target system
- âœ… Web application target
- âœ… Network connectivity to target

### Initial Access Requirements
- ğŸ”“ Requirements based on first step of chain
- ğŸ”“ See detailed procedures below

---

## ğŸ”¬ Detailed Attack Procedures

### **[Step 1]** Basic Port Scan with Service Enumeration

**Progress:** `â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘` 12% | **Risk:** ğŸŸ¢ Low

**Procedure:** [[Basic Port Scan with Service Enumeration]]

> ğŸ“ **Objective:** Perform an Nmap port scan on a target and enumerate banners of ports 1-1024, as well as popular services (a full list can be found in /usr/share/nmap/nmap-services).

**Expected Output:**
- Refer to procedure documentation for details

**Success Indicators:** âœ… Objective achieved

---

### **[Step 2]** Enumerate and Analyze an SSL/TLS Certificate

**Progress:** `â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘` 25% | **Risk:** ğŸŸ¢ Low

**Procedure:** [[Enumerate and Analyze an SSL/TLS Certificate]]

> ğŸ“ **Objective:** Organizations include information in their SSL certificates which can disclose details and aid attackers in the enumeration and development of attack vectors. SSL certificates will often list alternate DNS names (suggesting virtual hosts are configured on the target), registration dates, validity,

**Expected Output:**
- Refer to procedure documentation for details

**Success Indicators:** âœ… Objective achieved

---

### **[Step 3]** Directory Brute Force a Web App (GoBuster)

**Progress:** `â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘` 37% | **Risk:** ğŸ”´ High

**Procedure:** [[Directory Brute Force a Web App (GoBuster)]]

> ğŸ“ **Objective:** Enumerate a website's files and folders by performing a dictionary brute force on possible file and folder names.

**Expected Output:**
- Refer to procedure documentation for details

**Success Indicators:** âœ… Objective achieved

---

### **[Step 4]** Directory Brute Force a Web App with Extensions (GoBuster)

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘` 50% | **Risk:** ğŸ”´ High

**Procedure:** [[Directory Brute Force a Web App with Extensions (GoBuster)]]

> ğŸ“ **Objective:** Perform a directory brute force while specifying extensions. Choose file extensions to brute force based on initial recon of  files on the webserver (.php, .asp, .js, etc), directories (cgi-bin suggests .sh scripts), underlying technology disclosed in headers (Python, PHP, Ruby), etc. For example,

**Expected Output:**
- Refer to procedure documentation for details

**Success Indicators:** âœ… Objective achieved

---

### **[Step 5]** Exploit ImageMagick (ImageTragick) for Code Execution

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘` 62% | **Risk:** ğŸ”´ High

**Procedure:** [[Exploit ImageMagick (ImageTragick) for Code Execution]]

> ğŸ“ **Objective:** ImageTragick is a code execution vulnerability found in ImageMagick tools before 6.9.3-10, and version 7.x prior to 7.0.1-1. As many web applications use ImageMagick for displaying and converting files,  uploading an image file containing a crafted payload may allow attackers to  execute arbitrary

**Expected Output:**
- Refer to procedure documentation for details

**Success Indicators:** âœ… Objective achieved

---

### **[Step 6]** Find Linux Files with Elevated Privileges

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘` 75% | **Risk:** ğŸŸ¡ Medium

**Procedure:** [[Find Linux Files with Elevated Privileges]]

> ğŸ“ **Objective:** Linux and *nix systems include features which allow certain programs to run with elevated privileges. This is a requirement for many system services, but occasionally these programs may allow attackers to execute arbitrary commands. Setuid - Programs with this permission set can run commands as the

**Expected Output:**
- Refer to procedure documentation for details

**Success Indicators:** âœ… Objective achieved

---

### **[Step 7]** Exploit Shellshock on a Vulnerable Web App

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘` 87% | **Risk:** ğŸ”´ High

**Procedure:** [[Exploit Shellshock on a Vulnerable Web App]]

> ğŸ“ **Objective:** Shellshock is a family of security bugs in the Bash shell (pre 43-027), which allows attackers to remotely execute arbitrary commands on a vulnerable system. Web servers can be exploited by identifying a vulnerable script in the /cgi-bin directory, then using fields in the header to specify command

**Expected Output:**
- Refer to procedure documentation for details

**Success Indicators:** âœ… Objective achieved

---

### **[Step 8]** Docker Privilege Escalation Using Docker Group

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ` 100% | **Risk:** ğŸŸ¡ Medium

**Procedure:** [[Docker Privilege Escalation Using Docker Group]]

> ğŸ“ **Objective:** Docker host systems with users who are part of the "docker" group are able to escalate privileges to root by mounting the root file system within a container, bypassing permissions on the host system. This is considered a misconfiguration, as non-admin users should never be added to this group.

**Expected Output:**
- Refer to procedure documentation for details

**Success Indicators:** âœ… Objective achieved

---

## ğŸ¯ Attack Chain Summary

### Key Achievements
- âœ… Find Linux Files with Elevated Privileges
- âœ… Exploit Shellshock on a Vulnerable Web App
- âœ… Basic Port Scan with Service Enumeration
- âœ… Enumerate and Analyze an SSL/TLS Certificate
- âœ… Docker Privilege Escalation Using Docker Group
- ... and 3 more procedures

---

## ğŸ“ˆ Technique & Tactic Coverage

---

**Last Updated:** 2023-05-29T16:48:53.162677+00:00 | **Chain Version:** 2.0 Enhanced | **Status:** âš ï¸ Draft
