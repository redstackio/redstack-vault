---
id: 031cc6c3-4ea1-4771-8197-246f76348802
name: Web app exploit ImageMagick + Shellshock w/ reverse shell & docker priv esc
type: attack_chain
description: ' web app, linux, shellshock, image magick, docker, privilege escalation,
  CTF'
verified: false
submitted: false
step_count: 8
created_at: '2019-10-24T21:30:06.468426+00:00'
updated_at: '2023-05-29T16:48:53.162677+00:00'
procedures:
- '[[Exploit ImageMagick (ImageTragick) for Code Execution]]'
- '[[Basic Port Scan with Service Enumeration]]'
- '[[Directory Brute Force a Web App with Extensions (GoBuster)]]'
- '[[Find Linux Files with Elevated Privileges]]'
- '[[Exploit Shellshock on a Vulnerable Web App]]'
- '[[Directory Brute Force a Web App (GoBuster)]]'
- '[[Enumerate and Analyze an SSL/TLS Certificate]]'
- '[[Docker Privilege Escalation Using Docker Group]]'
tags:
- web app
- linux
- shellshock
- image magick
- docker
- privilege escalation
- CTF
---

# Web app exploit ImageMagick + Shellshock w/ reverse shell & docker priv esc

**Description**:  web app, linux, shellshock, image magick, docker, privilege escalation, CTF

## Overview

This attack chain consists of 8 steps.

## Attack Steps

### Step 1: Basic Port Scan with Service Enumeration

**Procedure**: [[Basic Port Scan with Service Enumeration]]

> Perform an Nmap port scan on a target and enumerate banners of ports 1-1024, as well as popular services (a full list can be found in /usr/share/nmap/nmap-services). 

---

### Step 2: Enumerate and Analyze an SSL/TLS Certificate

**Procedure**: [[Enumerate and Analyze an SSL/TLS Certificate]]

> Organizations include information in their SSL certificates which can disclose details and aid attackers in the enumeration and development of attack vectors. SSL certificates will often list alternate DNS names (suggesting virtual hosts are configured on the target), registration dates, validity, 

---

### Step 3: Directory Brute Force a Web App (GoBuster)

**Procedure**: [[Directory Brute Force a Web App (GoBuster)]]

> Enumerate a website's files and folders by performing a dictionary brute force on possible file and folder names. 

---

### Step 4: Directory Brute Force a Web App with Extensions (GoBuster)

**Procedure**: [[Directory Brute Force a Web App with Extensions (GoBuster)]]

> Perform a directory brute force while specifying extensions. Choose file extensions to brute force based on initial recon of  files on the webserver (.php, .asp, .js, etc), directories (cgi-bin suggests .sh scripts), underlying technology disclosed in headers (Python, PHP, Ruby), etc. For example, 

---

### Step 5: Exploit ImageMagick (ImageTragick) for Code Execution

**Procedure**: [[Exploit ImageMagick (ImageTragick) for Code Execution]]

> ImageTragick is a code execution vulnerability found in ImageMagick tools before 6.9.3-10, and version 7.x prior to 7.0.1-1. As many web applications use ImageMagick for displaying and converting files,  uploading an image file containing a crafted payload may allow attackers to  execute arbitrary 

---

### Step 6: Find Linux Files with Elevated Privileges

**Procedure**: [[Find Linux Files with Elevated Privileges]]

> Linux and *nix systems include features which allow certain programs to run with elevated privileges. This is a requirement for many system services, but occasionally these programs may allow attackers to execute arbitrary commands. Setuid - Programs with this permission set can run commands as the

---

### Step 7: Exploit Shellshock on a Vulnerable Web App

**Procedure**: [[Exploit Shellshock on a Vulnerable Web App]]

> Shellshock is a family of security bugs in the Bash shell (pre 43-027), which allows attackers to remotely execute arbitrary commands on a vulnerable system. Web servers can be exploited by identifying a vulnerable script in the /cgi-bin directory, then using fields in the header to specify command

---

### Step 8: Docker Privilege Escalation Using Docker Group

**Procedure**: [[Docker Privilege Escalation Using Docker Group]]

> Docker host systems with users who are part of the "docker" group are able to escalate privileges to root by mounting the root file system within a container, bypassing permissions on the host system. This is considered a misconfiguration, as non-admin users should never be added to this group. 

---

## Chain Summary

- **Total Steps**: 8
- **Key Procedures**: 8 procedures
