---
id: 4b23a312-2bf1-45cb-a56d-1f93bce05dcb
type: code
language: Python
verified: false
created_at: '2023-04-06T03:56:30.990952+00:00'
updated_at: '2023-04-10T20:38:05.082755+00:00'
---

# Code Snippet 4b23a312

**Language**: Python

```python
class RemoteShell(cmd.Cmd):
    def __init__(self, share, rpc, mode, serviceName, shell_type):
        cmd.Cmd.__init__(self)
        self.__share = share
        self.__mode = mode
        self.__output = '\\\\127.0.0.1\\' + self.__share + '\\' + OUTPUT_FILENAME
        self.__batchFile = '%TEMP%\\' + BATCH_FILENAME
        self.__outputBuffer = b''
        self.__command = ''
        self.__shell = '%COMSPEC% /Q /c '
        self.__shell_type = shell_type
        self.__pwsh = 'powershell.exe -NoP -NoL -sta -NonI -W Hidden -Exec Bypass -Enc '
        self.__serviceName = serviceName
```


